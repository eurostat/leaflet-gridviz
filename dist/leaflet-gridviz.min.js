/*! For license information please see leaflet-gridviz.min.js.LICENSE.txt */
(()=>{var t={616:function(t,e,i){var n;t.exports=(n=i(243),function(t){function e(n){if(i[n])return i[n].exports;var s=i[n]={i:n,l:!1,exports:{}};return t[n].call(s.exports,s,s.exports,e),s.l=!0,s.exports}var i={};return e.m=t,e.c=i,e.d=function(t,i,n){e.o(t,i)||Object.defineProperty(t,i,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=0)}([function(t,e,i){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var s=i(1),r=function(t){function e(e){var i=t.call(this,e)||this;return i._map=null,i._canvas=null,i._frame=null,i._delegate=null,i}return n(e,t),Object.defineProperty(e.prototype,"map",{get:function(){return this._map},enumerable:!0,configurable:!0}),e.prototype.getEvents=function(){var t={moveend:this._onLayerDidMove};return this._map.options.zoomAnimation&&s.Browser.any3d&&(t.zoomanim=this._animateZoom),t},e.prototype.onAdd=function(t){this._map=t,this._canvas=s.DomUtil.create("canvas","leaflet-layer");var e=this._map.getSize();this._canvas.width=e.x,this._canvas.height=e.y;var i=this._map.options.zoomAnimation&&s.Browser.any3d;s.DomUtil.addClass(this._canvas,"leaflet-zoom-"+(i?"animated":"hide")),t.getPanes().overlayPane.appendChild(this._canvas);var n=this._delegate||this;return n.onLayerDidMount&&n.onLayerDidMount(),this.needRedraw(),this},e.prototype.onRemove=function(t){var e=this._delegate||this;return e.onLayerWillUnmount&&e.onLayerWillUnmount(),t.getPanes().overlayPane.removeChild(this._canvas),this._canvas=null,this},e.prototype.needRedraw=function(){return this._frame||(this._frame=s.Util.requestAnimFrame(this.drawLayer,this)),this},e.prototype.delegate=function(t){return this._delegate=t,this},e.prototype._onLayerDidResize=function(t){this._canvas.width=t.newSize.x,this._canvas.height=t.newSize.y},e.prototype._onLayerDidMove=function(){var t=this._map.containerPointToLayerPoint([0,0]);s.DomUtil.setPosition(this._canvas,t),this.drawLayer()},e.prototype.LatLonToMercator=function(t){return{x:6378137*t.lng*Math.PI/180,y:6378137*Math.log(Math.tan((90+t.lat)*Math.PI/360))}},e.prototype.drawLayer=function(){var t=this._map.getSize();this._canvas.width=t.x,this._canvas.height=t.y;var e=this._map.getBounds(),i=this._map.getZoom(),n=this.LatLonToMercator(this._map.getCenter()),s=this.LatLonToMercator(this._map.containerPointToLatLng(this._map.getSize())),r=this._delegate||this;r.onDrawLayer&&r.onDrawLayer({bounds:e,canvas:this._canvas,center:n,corner:s,layer:this,size:t,zoom:i}),this._frame=null},e.prototype._animateZoom=function(t){var e=t.target.getZoomScale(t.zoom,t.target.getZoom()),i=this._map._latLngBoundsToNewLayerBounds(this._map.getBounds(),t.zoom,t.center).min;s.DomUtil.setTransform(this._canvas,i,e)},e}(s.Layer);e.CanvasLayer=r},function(t,e){t.exports=n}]))},243:function(t,e){!function(t){"use strict";function e(t){var e,i,n,s;for(i=1,n=arguments.length;i<n;i++)for(e in s=arguments[i])t[e]=s[e];return t}var i=Object.create||function(){function t(){}return function(e){return t.prototype=e,new t}}();function n(t,e){var i=Array.prototype.slice;if(t.bind)return t.bind.apply(t,i.call(arguments,1));var n=i.call(arguments,2);return function(){return t.apply(e,n.length?n.concat(i.call(arguments)):arguments)}}var s=0;function r(t){return"_leaflet_id"in t||(t._leaflet_id=++s),t._leaflet_id}function o(t,e,i){var n,s,r,o;return o=function(){n=!1,s&&(r.apply(i,s),s=!1)},r=function(){n?s=arguments:(t.apply(i,arguments),setTimeout(o,e),n=!0)},r}function a(t,e,i){var n=e[1],s=e[0],r=n-s;return t===n&&i?t:((t-s)%r+r)%r+s}function h(){return!1}function l(t,e){if(!1===e)return t;var i=Math.pow(10,void 0===e?6:e);return Math.round(t*i)/i}function u(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function c(t){return u(t).split(/\s+/)}function d(t,e){for(var n in Object.prototype.hasOwnProperty.call(t,"options")||(t.options=t.options?i(t.options):{}),e)t.options[n]=e[n];return t.options}function f(t,e,i){var n=[];for(var s in t)n.push(encodeURIComponent(i?s.toUpperCase():s)+"="+encodeURIComponent(t[s]));return(e&&-1!==e.indexOf("?")?"&":"?")+n.join("&")}var p=/\{ *([\w_ -]+) *\}/g;function m(t,e){return t.replace(p,(function(t,i){var n=e[i];if(void 0===n)throw new Error("No value provided for variable "+t);return"function"==typeof n&&(n=n(e)),n}))}var _=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function y(t,e){for(var i=0;i<t.length;i++)if(t[i]===e)return i;return-1}var g="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function v(t){return window["webkit"+t]||window["moz"+t]||window["ms"+t]}var b=0;function w(t){var e=+new Date,i=Math.max(0,16-(e-b));return b=e+i,window.setTimeout(t,i)}var x=window.requestAnimationFrame||v("RequestAnimationFrame")||w,M=window.cancelAnimationFrame||v("CancelAnimationFrame")||v("CancelRequestAnimationFrame")||function(t){window.clearTimeout(t)};function S(t,e,i){if(!i||x!==w)return x.call(window,n(t,e));t.call(e)}function I(t){t&&M.call(window,t)}var T={__proto__:null,extend:e,create:i,bind:n,get lastId(){return s},stamp:r,throttle:o,wrapNum:a,falseFn:h,formatNum:l,trim:u,splitWords:c,setOptions:d,getParamString:f,template:m,isArray:_,indexOf:y,emptyImageUrl:g,requestFn:x,cancelFn:M,requestAnimFrame:S,cancelAnimFrame:I};function A(){}A.extend=function(t){var n=function(){d(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},s=n.__super__=this.prototype,r=i(s);for(var o in r.constructor=n,n.prototype=r,this)Object.prototype.hasOwnProperty.call(this,o)&&"prototype"!==o&&"__super__"!==o&&(n[o]=this[o]);return t.statics&&e(n,t.statics),t.includes&&(function(t){if("undefined"!=typeof L&&L&&L.Mixin){t=_(t)?t:[t];for(var e=0;e<t.length;e++)t[e]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",(new Error).stack)}}(t.includes),e.apply(null,[r].concat(t.includes))),e(r,t),delete r.statics,delete r.includes,r.options&&(r.options=s.options?i(s.options):{},e(r.options,t.options)),r._initHooks=[],r.callInitHooks=function(){if(!this._initHooksCalled){s.callInitHooks&&s.callInitHooks.call(this),this._initHooksCalled=!0;for(var t=0,e=r._initHooks.length;t<e;t++)r._initHooks[t].call(this)}},n},A.include=function(t){var i=this.prototype.options;return e(this.prototype,t),t.options&&(this.prototype.options=i,this.mergeOptions(t.options)),this},A.mergeOptions=function(t){return e(this.prototype.options,t),this},A.addInitHook=function(t){var e=Array.prototype.slice.call(arguments,1),i="function"==typeof t?t:function(){this[t].apply(this,e)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(i),this};var P={on:function(t,e,i){if("object"==typeof t)for(var n in t)this._on(n,t[n],e);else for(var s=0,r=(t=c(t)).length;s<r;s++)this._on(t[s],e,i);return this},off:function(t,e,i){if(arguments.length)if("object"==typeof t)for(var n in t)this._off(n,t[n],e);else{t=c(t);for(var s=1===arguments.length,r=0,o=t.length;r<o;r++)s?this._off(t[r]):this._off(t[r],e,i)}else delete this._events;return this},_on:function(t,e,i,n){if("function"==typeof e){if(!1===this._listens(t,e,i)){i===this&&(i=void 0);var s={fn:e,ctx:i};n&&(s.once=!0),this._events=this._events||{},this._events[t]=this._events[t]||[],this._events[t].push(s)}}else console.warn("wrong listener type: "+typeof e)},_off:function(t,e,i){var n,s,r;if(this._events&&(n=this._events[t]))if(1!==arguments.length)if("function"==typeof e){var o=this._listens(t,e,i);if(!1!==o){var a=n[o];this._firingCount&&(a.fn=h,this._events[t]=n=n.slice()),n.splice(o,1)}}else console.warn("wrong listener type: "+typeof e);else{if(this._firingCount)for(s=0,r=n.length;s<r;s++)n[s].fn=h;delete this._events[t]}},fire:function(t,i,n){if(!this.listens(t,n))return this;var s=e({},i,{type:t,target:this,sourceTarget:i&&i.sourceTarget||this});if(this._events){var r=this._events[t];if(r){this._firingCount=this._firingCount+1||1;for(var o=0,a=r.length;o<a;o++){var h=r[o],l=h.fn;h.once&&this.off(t,l,h.ctx),l.call(h.ctx||this,s)}this._firingCount--}}return n&&this._propagateEvent(s),this},listens:function(t,e,i,n){"string"!=typeof t&&console.warn('"string" type argument expected');var s=e;"function"!=typeof e&&(n=!!e,s=void 0,i=void 0);var r=this._events&&this._events[t];if(r&&r.length&&!1!==this._listens(t,s,i))return!0;if(n)for(var o in this._eventParents)if(this._eventParents[o].listens(t,e,i,n))return!0;return!1},_listens:function(t,e,i){if(!this._events)return!1;var n=this._events[t]||[];if(!e)return!!n.length;i===this&&(i=void 0);for(var s=0,r=n.length;s<r;s++)if(n[s].fn===e&&n[s].ctx===i)return s;return!1},once:function(t,e,i){if("object"==typeof t)for(var n in t)this._on(n,t[n],e,!0);else for(var s=0,r=(t=c(t)).length;s<r;s++)this._on(t[s],e,i,!0);return this},addEventParent:function(t){return this._eventParents=this._eventParents||{},this._eventParents[r(t)]=t,this},removeEventParent:function(t){return this._eventParents&&delete this._eventParents[r(t)],this},_propagateEvent:function(t){for(var i in this._eventParents)this._eventParents[i].fire(t.type,e({layer:t.target,propagatedFrom:t.target},t),!0)}};P.addEventListener=P.on,P.removeEventListener=P.clearAllEventListeners=P.off,P.addOneTimeEventListener=P.once,P.fireEvent=P.fire,P.hasEventListeners=P.listens;var C=A.extend(P);function B(t,e,i){this.x=i?Math.round(t):t,this.y=i?Math.round(e):e}var O=Math.trunc||function(t){return t>0?Math.floor(t):Math.ceil(t)};function E(t,e,i){return t instanceof B?t:_(t)?new B(t[0],t[1]):null==t?t:"object"==typeof t&&"x"in t&&"y"in t?new B(t.x,t.y):new B(t,e,i)}function N(t,e){if(t)for(var i=e?[t,e]:t,n=0,s=i.length;n<s;n++)this.extend(i[n])}function z(t,e){return!t||t instanceof N?t:new N(t,e)}function k(t,e){if(t)for(var i=e?[t,e]:t,n=0,s=i.length;n<s;n++)this.extend(i[n])}function D(t,e){return t instanceof k?t:new k(t,e)}function F(t,e,i){if(isNaN(t)||isNaN(e))throw new Error("Invalid LatLng object: ("+t+", "+e+")");this.lat=+t,this.lng=+e,void 0!==i&&(this.alt=+i)}function R(t,e,i){return t instanceof F?t:_(t)&&"object"!=typeof t[0]?3===t.length?new F(t[0],t[1],t[2]):2===t.length?new F(t[0],t[1]):null:null==t?t:"object"==typeof t&&"lat"in t?new F(t.lat,"lng"in t?t.lng:t.lon,t.alt):void 0===e?null:new F(t,e,i)}B.prototype={clone:function(){return new B(this.x,this.y)},add:function(t){return this.clone()._add(E(t))},_add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.clone()._subtract(E(t))},_subtract:function(t){return this.x-=t.x,this.y-=t.y,this},divideBy:function(t){return this.clone()._divideBy(t)},_divideBy:function(t){return this.x/=t,this.y/=t,this},multiplyBy:function(t){return this.clone()._multiplyBy(t)},_multiplyBy:function(t){return this.x*=t,this.y*=t,this},scaleBy:function(t){return new B(this.x*t.x,this.y*t.y)},unscaleBy:function(t){return new B(this.x/t.x,this.y/t.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=O(this.x),this.y=O(this.y),this},distanceTo:function(t){var e=(t=E(t)).x-this.x,i=t.y-this.y;return Math.sqrt(e*e+i*i)},equals:function(t){return(t=E(t)).x===this.x&&t.y===this.y},contains:function(t){return t=E(t),Math.abs(t.x)<=Math.abs(this.x)&&Math.abs(t.y)<=Math.abs(this.y)},toString:function(){return"Point("+l(this.x)+", "+l(this.y)+")"}},N.prototype={extend:function(t){var e,i;if(!t)return this;if(t instanceof B||"number"==typeof t[0]||"x"in t)e=i=E(t);else if(e=(t=z(t)).min,i=t.max,!e||!i)return this;return this.min||this.max?(this.min.x=Math.min(e.x,this.min.x),this.max.x=Math.max(i.x,this.max.x),this.min.y=Math.min(e.y,this.min.y),this.max.y=Math.max(i.y,this.max.y)):(this.min=e.clone(),this.max=i.clone()),this},getCenter:function(t){return E((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,t)},getBottomLeft:function(){return E(this.min.x,this.max.y)},getTopRight:function(){return E(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(t){var e,i;return(t="number"==typeof t[0]||t instanceof B?E(t):z(t))instanceof N?(e=t.min,i=t.max):e=i=t,e.x>=this.min.x&&i.x<=this.max.x&&e.y>=this.min.y&&i.y<=this.max.y},intersects:function(t){t=z(t);var e=this.min,i=this.max,n=t.min,s=t.max,r=s.x>=e.x&&n.x<=i.x,o=s.y>=e.y&&n.y<=i.y;return r&&o},overlaps:function(t){t=z(t);var e=this.min,i=this.max,n=t.min,s=t.max,r=s.x>e.x&&n.x<i.x,o=s.y>e.y&&n.y<i.y;return r&&o},isValid:function(){return!(!this.min||!this.max)},pad:function(t){var e=this.min,i=this.max,n=Math.abs(e.x-i.x)*t,s=Math.abs(e.y-i.y)*t;return z(E(e.x-n,e.y-s),E(i.x+n,i.y+s))},equals:function(t){return!!t&&(t=z(t),this.min.equals(t.getTopLeft())&&this.max.equals(t.getBottomRight()))}},k.prototype={extend:function(t){var e,i,n=this._southWest,s=this._northEast;if(t instanceof F)e=t,i=t;else{if(!(t instanceof k))return t?this.extend(R(t)||D(t)):this;if(e=t._southWest,i=t._northEast,!e||!i)return this}return n||s?(n.lat=Math.min(e.lat,n.lat),n.lng=Math.min(e.lng,n.lng),s.lat=Math.max(i.lat,s.lat),s.lng=Math.max(i.lng,s.lng)):(this._southWest=new F(e.lat,e.lng),this._northEast=new F(i.lat,i.lng)),this},pad:function(t){var e=this._southWest,i=this._northEast,n=Math.abs(e.lat-i.lat)*t,s=Math.abs(e.lng-i.lng)*t;return new k(new F(e.lat-n,e.lng-s),new F(i.lat+n,i.lng+s))},getCenter:function(){return new F((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new F(this.getNorth(),this.getWest())},getSouthEast:function(){return new F(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(t){t="number"==typeof t[0]||t instanceof F||"lat"in t?R(t):D(t);var e,i,n=this._southWest,s=this._northEast;return t instanceof k?(e=t.getSouthWest(),i=t.getNorthEast()):e=i=t,e.lat>=n.lat&&i.lat<=s.lat&&e.lng>=n.lng&&i.lng<=s.lng},intersects:function(t){t=D(t);var e=this._southWest,i=this._northEast,n=t.getSouthWest(),s=t.getNorthEast(),r=s.lat>=e.lat&&n.lat<=i.lat,o=s.lng>=e.lng&&n.lng<=i.lng;return r&&o},overlaps:function(t){t=D(t);var e=this._southWest,i=this._northEast,n=t.getSouthWest(),s=t.getNorthEast(),r=s.lat>e.lat&&n.lat<i.lat,o=s.lng>e.lng&&n.lng<i.lng;return r&&o},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(t,e){return!!t&&(t=D(t),this._southWest.equals(t.getSouthWest(),e)&&this._northEast.equals(t.getNorthEast(),e))},isValid:function(){return!(!this._southWest||!this._northEast)}},F.prototype={equals:function(t,e){return!!t&&(t=R(t),Math.max(Math.abs(this.lat-t.lat),Math.abs(this.lng-t.lng))<=(void 0===e?1e-9:e))},toString:function(t){return"LatLng("+l(this.lat,t)+", "+l(this.lng,t)+")"},distanceTo:function(t){return j.distance(this,R(t))},wrap:function(){return j.wrapLatLng(this)},toBounds:function(t){var e=180*t/40075017,i=e/Math.cos(Math.PI/180*this.lat);return D([this.lat-e,this.lng-i],[this.lat+e,this.lng+i])},clone:function(){return new F(this.lat,this.lng,this.alt)}};var U,Z={latLngToPoint:function(t,e){var i=this.projection.project(t),n=this.scale(e);return this.transformation._transform(i,n)},pointToLatLng:function(t,e){var i=this.scale(e),n=this.transformation.untransform(t,i);return this.projection.unproject(n)},project:function(t){return this.projection.project(t)},unproject:function(t){return this.projection.unproject(t)},scale:function(t){return 256*Math.pow(2,t)},zoom:function(t){return Math.log(t/256)/Math.LN2},getProjectedBounds:function(t){if(this.infinite)return null;var e=this.projection.bounds,i=this.scale(t);return new N(this.transformation.transform(e.min,i),this.transformation.transform(e.max,i))},infinite:!1,wrapLatLng:function(t){var e=this.wrapLng?a(t.lng,this.wrapLng,!0):t.lng;return new F(this.wrapLat?a(t.lat,this.wrapLat,!0):t.lat,e,t.alt)},wrapLatLngBounds:function(t){var e=t.getCenter(),i=this.wrapLatLng(e),n=e.lat-i.lat,s=e.lng-i.lng;if(0===n&&0===s)return t;var r=t.getSouthWest(),o=t.getNorthEast();return new k(new F(r.lat-n,r.lng-s),new F(o.lat-n,o.lng-s))}},j=e({},Z,{wrapLng:[-180,180],R:6371e3,distance:function(t,e){var i=Math.PI/180,n=t.lat*i,s=e.lat*i,r=Math.sin((e.lat-t.lat)*i/2),o=Math.sin((e.lng-t.lng)*i/2),a=r*r+Math.cos(n)*Math.cos(s)*o*o,h=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a));return this.R*h}}),V=6378137,G={R:V,MAX_LATITUDE:85.0511287798,project:function(t){var e=Math.PI/180,i=this.MAX_LATITUDE,n=Math.max(Math.min(i,t.lat),-i),s=Math.sin(n*e);return new B(this.R*t.lng*e,this.R*Math.log((1+s)/(1-s))/2)},unproject:function(t){var e=180/Math.PI;return new F((2*Math.atan(Math.exp(t.y/this.R))-Math.PI/2)*e,t.x*e/this.R)},bounds:(U=V*Math.PI,new N([-U,-U],[U,U]))};function q(t,e,i,n){if(_(t))return this._a=t[0],this._b=t[1],this._c=t[2],void(this._d=t[3]);this._a=t,this._b=e,this._c=i,this._d=n}function W(t,e,i,n){return new q(t,e,i,n)}q.prototype={transform:function(t,e){return this._transform(t.clone(),e)},_transform:function(t,e){return e=e||1,t.x=e*(this._a*t.x+this._b),t.y=e*(this._c*t.y+this._d),t},untransform:function(t,e){return e=e||1,new B((t.x/e-this._b)/this._a,(t.y/e-this._d)/this._c)}};var H=e({},j,{code:"EPSG:3857",projection:G,transformation:function(){var t=.5/(Math.PI*G.R);return W(t,.5,-t,.5)}()}),$=e({},H,{code:"EPSG:900913"});function Y(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function X(t,e){var i,n,s,r,o,a,h="";for(i=0,s=t.length;i<s;i++){for(n=0,r=(o=t[i]).length;n<r;n++)h+=(n?"L":"M")+(a=o[n]).x+" "+a.y;h+=e?Nt.svg?"z":"x":""}return h||"M0 0"}var K,J=document.documentElement.style,Q="ActiveXObject"in window,tt=Q&&!document.addEventListener,et="msLaunchUri"in navigator&&!("documentMode"in document),it=Et("webkit"),nt=Et("android"),st=Et("android 2")||Et("android 3"),rt=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),ot=nt&&Et("Google")&&rt<537&&!("AudioNode"in window),at=!!window.opera,ht=!et&&Et("chrome"),lt=Et("gecko")&&!it&&!at&&!Q,ut=!ht&&Et("safari"),ct=Et("phantom"),dt="OTransition"in J,ft=0===navigator.platform.indexOf("Win"),pt=Q&&"transition"in J,mt="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!st,_t="MozPerspective"in J,yt=!window.L_DISABLE_3D&&(pt||mt||_t)&&!dt&&!ct,gt="undefined"!=typeof orientation||Et("mobile"),vt=gt&&it,bt=gt&&mt,wt=!window.PointerEvent&&window.MSPointerEvent,xt=!(!window.PointerEvent&&!wt),Mt="ontouchstart"in window||!!window.TouchEvent,St=!window.L_NO_TOUCH&&(Mt||xt),It=gt&&at,Tt=gt&&lt,Lt=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,At=function(){var t=!1;try{var e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("testPassiveEventSupport",h,e),window.removeEventListener("testPassiveEventSupport",h,e)}catch(t){}return t}(),Pt=!!document.createElement("canvas").getContext,Ct=!(!document.createElementNS||!Y("svg").createSVGRect),Bt=!!Ct&&((K=document.createElement("div")).innerHTML="<svg/>","http://www.w3.org/2000/svg"===(K.firstChild&&K.firstChild.namespaceURI)),Ot=!Ct&&function(){try{var t=document.createElement("div");t.innerHTML='<v:shape adj="1"/>';var e=t.firstChild;return e.style.behavior="url(#default#VML)",e&&"object"==typeof e.adj}catch(t){return!1}}();function Et(t){return navigator.userAgent.toLowerCase().indexOf(t)>=0}var Nt={ie:Q,ielt9:tt,edge:et,webkit:it,android:nt,android23:st,androidStock:ot,opera:at,chrome:ht,gecko:lt,safari:ut,phantom:ct,opera12:dt,win:ft,ie3d:pt,webkit3d:mt,gecko3d:_t,any3d:yt,mobile:gt,mobileWebkit:vt,mobileWebkit3d:bt,msPointer:wt,pointer:xt,touch:St,touchNative:Mt,mobileOpera:It,mobileGecko:Tt,retina:Lt,passiveEvents:At,canvas:Pt,svg:Ct,vml:Ot,inlineSvg:Bt,mac:0===navigator.platform.indexOf("Mac"),linux:0===navigator.platform.indexOf("Linux")},zt=Nt.msPointer?"MSPointerDown":"pointerdown",kt=Nt.msPointer?"MSPointerMove":"pointermove",Dt=Nt.msPointer?"MSPointerUp":"pointerup",Ft=Nt.msPointer?"MSPointerCancel":"pointercancel",Rt={touchstart:zt,touchmove:kt,touchend:Dt,touchcancel:Ft},Ut={touchstart:function(t,e){e.MSPOINTER_TYPE_TOUCH&&e.pointerType===e.MSPOINTER_TYPE_TOUCH&&Fe(e),Ht(t,e)},touchmove:Ht,touchend:Ht,touchcancel:Ht},Zt={},jt=!1;function Vt(t,e,i){return"touchstart"===e&&(jt||(document.addEventListener(zt,Gt,!0),document.addEventListener(kt,qt,!0),document.addEventListener(Dt,Wt,!0),document.addEventListener(Ft,Wt,!0),jt=!0)),Ut[e]?(i=Ut[e].bind(this,i),t.addEventListener(Rt[e],i,!1),i):(console.warn("wrong event specified:",e),h)}function Gt(t){Zt[t.pointerId]=t}function qt(t){Zt[t.pointerId]&&(Zt[t.pointerId]=t)}function Wt(t){delete Zt[t.pointerId]}function Ht(t,e){if(e.pointerType!==(e.MSPOINTER_TYPE_MOUSE||"mouse")){for(var i in e.touches=[],Zt)e.touches.push(Zt[i]);e.changedTouches=[e],t(e)}}var $t=200;var Yt,Xt,Kt,Jt,Qt,te=_e(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),ee=_e(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),ie="webkitTransition"===ee||"OTransition"===ee?ee+"End":"transitionend";function ne(t){return"string"==typeof t?document.getElementById(t):t}function se(t,e){var i=t.style[e]||t.currentStyle&&t.currentStyle[e];if((!i||"auto"===i)&&document.defaultView){var n=document.defaultView.getComputedStyle(t,null);i=n?n[e]:null}return"auto"===i?null:i}function re(t,e,i){var n=document.createElement(t);return n.className=e||"",i&&i.appendChild(n),n}function oe(t){var e=t.parentNode;e&&e.removeChild(t)}function ae(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function he(t){var e=t.parentNode;e&&e.lastChild!==t&&e.appendChild(t)}function le(t){var e=t.parentNode;e&&e.firstChild!==t&&e.insertBefore(t,e.firstChild)}function ue(t,e){if(void 0!==t.classList)return t.classList.contains(e);var i=pe(t);return i.length>0&&new RegExp("(^|\\s)"+e+"(\\s|$)").test(i)}function ce(t,e){if(void 0!==t.classList)for(var i=c(e),n=0,s=i.length;n<s;n++)t.classList.add(i[n]);else if(!ue(t,e)){var r=pe(t);fe(t,(r?r+" ":"")+e)}}function de(t,e){void 0!==t.classList?t.classList.remove(e):fe(t,u((" "+pe(t)+" ").replace(" "+e+" "," ")))}function fe(t,e){void 0===t.className.baseVal?t.className=e:t.className.baseVal=e}function pe(t){return t.correspondingElement&&(t=t.correspondingElement),void 0===t.className.baseVal?t.className:t.className.baseVal}function me(t,e){"opacity"in t.style?t.style.opacity=e:"filter"in t.style&&function(t,e){var i=!1,n="DXImageTransform.Microsoft.Alpha";try{i=t.filters.item(n)}catch(t){if(1===e)return}e=Math.round(100*e),i?(i.Enabled=100!==e,i.Opacity=e):t.style.filter+=" progid:"+n+"(opacity="+e+")"}(t,e)}function _e(t){for(var e=document.documentElement.style,i=0;i<t.length;i++)if(t[i]in e)return t[i];return!1}function ye(t,e,i){var n=e||new B(0,0);t.style[te]=(Nt.ie3d?"translate("+n.x+"px,"+n.y+"px)":"translate3d("+n.x+"px,"+n.y+"px,0)")+(i?" scale("+i+")":"")}function ge(t,e){t._leaflet_pos=e,Nt.any3d?ye(t,e):(t.style.left=e.x+"px",t.style.top=e.y+"px")}function ve(t){return t._leaflet_pos||new B(0,0)}if("onselectstart"in document)Yt=function(){Ae(window,"selectstart",Fe)},Xt=function(){Ce(window,"selectstart",Fe)};else{var be=_e(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Yt=function(){if(be){var t=document.documentElement.style;Kt=t[be],t[be]="none"}},Xt=function(){be&&(document.documentElement.style[be]=Kt,Kt=void 0)}}function we(){Ae(window,"dragstart",Fe)}function xe(){Ce(window,"dragstart",Fe)}function Me(t){for(;-1===t.tabIndex;)t=t.parentNode;t.style&&(Se(),Jt=t,Qt=t.style.outline,t.style.outline="none",Ae(window,"keydown",Se))}function Se(){Jt&&(Jt.style.outline=Qt,Jt=void 0,Qt=void 0,Ce(window,"keydown",Se))}function Ie(t){do{t=t.parentNode}while(!(t.offsetWidth&&t.offsetHeight||t===document.body));return t}function Te(t){var e=t.getBoundingClientRect();return{x:e.width/t.offsetWidth||1,y:e.height/t.offsetHeight||1,boundingClientRect:e}}var Le={__proto__:null,TRANSFORM:te,TRANSITION:ee,TRANSITION_END:ie,get:ne,getStyle:se,create:re,remove:oe,empty:ae,toFront:he,toBack:le,hasClass:ue,addClass:ce,removeClass:de,setClass:fe,getClass:pe,setOpacity:me,testProp:_e,setTransform:ye,setPosition:ge,getPosition:ve,get disableTextSelection(){return Yt},get enableTextSelection(){return Xt},disableImageDrag:we,enableImageDrag:xe,preventOutline:Me,restoreOutline:Se,getSizedParentNode:Ie,getScale:Te};function Ae(t,e,i,n){if(e&&"object"==typeof e)for(var s in e)Ee(t,s,e[s],i);else for(var r=0,o=(e=c(e)).length;r<o;r++)Ee(t,e[r],i,n);return this}var Pe="_leaflet_events";function Ce(t,e,i,n){if(1===arguments.length)Be(t),delete t[Pe];else if(e&&"object"==typeof e)for(var s in e)Ne(t,s,e[s],i);else if(e=c(e),2===arguments.length)Be(t,(function(t){return-1!==y(e,t)}));else for(var r=0,o=e.length;r<o;r++)Ne(t,e[r],i,n);return this}function Be(t,e){for(var i in t[Pe]){var n=i.split(/\d/)[0];e&&!e(n)||Ne(t,n,null,null,i)}}var Oe={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Ee(t,e,i,n){var s=e+r(i)+(n?"_"+r(n):"");if(t[Pe]&&t[Pe][s])return this;var o=function(e){return i.call(n||t,e||window.event)},a=o;!Nt.touchNative&&Nt.pointer&&0===e.indexOf("touch")?o=Vt(t,e,o):Nt.touch&&"dblclick"===e?o=function(t,e){t.addEventListener("dblclick",e);var i,n=0;function s(t){if(1===t.detail){if("mouse"!==t.pointerType&&(!t.sourceCapabilities||t.sourceCapabilities.firesTouchEvents)){var s=Ue(t);if(!s.some((function(t){return t instanceof HTMLLabelElement&&t.attributes.for}))||s.some((function(t){return t instanceof HTMLInputElement||t instanceof HTMLSelectElement}))){var r=Date.now();r-n<=$t?2==++i&&e(function(t){var e,i,n={};for(i in t)e=t[i],n[i]=e&&e.bind?e.bind(t):e;return t=n,n.type="dblclick",n.detail=2,n.isTrusted=!1,n._simulated=!0,n}(t)):i=1,n=r}}}else i=t.detail}return t.addEventListener("click",s),{dblclick:e,simDblclick:s}}(t,o):"addEventListener"in t?"touchstart"===e||"touchmove"===e||"wheel"===e||"mousewheel"===e?t.addEventListener(Oe[e]||e,o,!!Nt.passiveEvents&&{passive:!1}):"mouseenter"===e||"mouseleave"===e?(o=function(e){e=e||window.event,Ge(t,e)&&a(e)},t.addEventListener(Oe[e],o,!1)):t.addEventListener(e,a,!1):t.attachEvent("on"+e,o),t[Pe]=t[Pe]||{},t[Pe][s]=o}function Ne(t,e,i,n,s){s=s||e+r(i)+(n?"_"+r(n):"");var o=t[Pe]&&t[Pe][s];if(!o)return this;!Nt.touchNative&&Nt.pointer&&0===e.indexOf("touch")?function(t,e,i){Rt[e]?t.removeEventListener(Rt[e],i,!1):console.warn("wrong event specified:",e)}(t,e,o):Nt.touch&&"dblclick"===e?function(t,e){t.removeEventListener("dblclick",e.dblclick),t.removeEventListener("click",e.simDblclick)}(t,o):"removeEventListener"in t?t.removeEventListener(Oe[e]||e,o,!1):t.detachEvent("on"+e,o),t[Pe][s]=null}function ze(t){return t.stopPropagation?t.stopPropagation():t.originalEvent?t.originalEvent._stopped=!0:t.cancelBubble=!0,this}function ke(t){return Ee(t,"wheel",ze),this}function De(t){return Ae(t,"mousedown touchstart dblclick contextmenu",ze),t._leaflet_disable_click=!0,this}function Fe(t){return t.preventDefault?t.preventDefault():t.returnValue=!1,this}function Re(t){return Fe(t),ze(t),this}function Ue(t){if(t.composedPath)return t.composedPath();for(var e=[],i=t.target;i;)e.push(i),i=i.parentNode;return e}function Ze(t,e){if(!e)return new B(t.clientX,t.clientY);var i=Te(e),n=i.boundingClientRect;return new B((t.clientX-n.left)/i.x-e.clientLeft,(t.clientY-n.top)/i.y-e.clientTop)}var je=Nt.linux&&Nt.chrome?window.devicePixelRatio:Nt.mac?3*window.devicePixelRatio:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Ve(t){return Nt.edge?t.wheelDeltaY/2:t.deltaY&&0===t.deltaMode?-t.deltaY/je:t.deltaY&&1===t.deltaMode?20*-t.deltaY:t.deltaY&&2===t.deltaMode?60*-t.deltaY:t.deltaX||t.deltaZ?0:t.wheelDelta?(t.wheelDeltaY||t.wheelDelta)/2:t.detail&&Math.abs(t.detail)<32765?20*-t.detail:t.detail?t.detail/-32765*60:0}function Ge(t,e){var i=e.relatedTarget;if(!i)return!0;try{for(;i&&i!==t;)i=i.parentNode}catch(t){return!1}return i!==t}var qe={__proto__:null,on:Ae,off:Ce,stopPropagation:ze,disableScrollPropagation:ke,disableClickPropagation:De,preventDefault:Fe,stop:Re,getPropagationPath:Ue,getMousePosition:Ze,getWheelDelta:Ve,isExternalTarget:Ge,addListener:Ae,removeListener:Ce},We=C.extend({run:function(t,e,i,n){this.stop(),this._el=t,this._inProgress=!0,this._duration=i||.25,this._easeOutPower=1/Math.max(n||.5,.2),this._startPos=ve(t),this._offset=e.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=S(this._animate,this),this._step()},_step:function(t){var e=+new Date-this._startTime,i=1e3*this._duration;e<i?this._runFrame(this._easeOut(e/i),t):(this._runFrame(1),this._complete())},_runFrame:function(t,e){var i=this._startPos.add(this._offset.multiplyBy(t));e&&i._round(),ge(this._el,i),this.fire("step")},_complete:function(){I(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(t){return 1-Math.pow(1-t,this._easeOutPower)}}),He=C.extend({options:{crs:H,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(t,e){e=d(this,e),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(t),this._initLayout(),this._onResize=n(this._onResize,this),this._initEvents(),e.maxBounds&&this.setMaxBounds(e.maxBounds),void 0!==e.zoom&&(this._zoom=this._limitZoom(e.zoom)),e.center&&void 0!==e.zoom&&this.setView(R(e.center),e.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=ee&&Nt.any3d&&!Nt.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Ae(this._proxy,ie,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(t,i,n){return i=void 0===i?this._zoom:this._limitZoom(i),t=this._limitCenter(R(t),i,this.options.maxBounds),n=n||{},this._stop(),this._loaded&&!n.reset&&!0!==n&&(void 0!==n.animate&&(n.zoom=e({animate:n.animate},n.zoom),n.pan=e({animate:n.animate,duration:n.duration},n.pan)),this._zoom!==i?this._tryAnimatedZoom&&this._tryAnimatedZoom(t,i,n.zoom):this._tryAnimatedPan(t,n.pan))?(clearTimeout(this._sizeTimer),this):(this._resetView(t,i,n.pan&&n.pan.noMoveStart),this)},setZoom:function(t,e){return this._loaded?this.setView(this.getCenter(),t,{zoom:e}):(this._zoom=t,this)},zoomIn:function(t,e){return t=t||(Nt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+t,e)},zoomOut:function(t,e){return t=t||(Nt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-t,e)},setZoomAround:function(t,e,i){var n=this.getZoomScale(e),s=this.getSize().divideBy(2),r=(t instanceof B?t:this.latLngToContainerPoint(t)).subtract(s).multiplyBy(1-1/n),o=this.containerPointToLatLng(s.add(r));return this.setView(o,e,{zoom:i})},_getBoundsCenterZoom:function(t,e){e=e||{},t=t.getBounds?t.getBounds():D(t);var i=E(e.paddingTopLeft||e.padding||[0,0]),n=E(e.paddingBottomRight||e.padding||[0,0]),s=this.getBoundsZoom(t,!1,i.add(n));if((s="number"==typeof e.maxZoom?Math.min(e.maxZoom,s):s)===1/0)return{center:t.getCenter(),zoom:s};var r=n.subtract(i).divideBy(2),o=this.project(t.getSouthWest(),s),a=this.project(t.getNorthEast(),s);return{center:this.unproject(o.add(a).divideBy(2).add(r),s),zoom:s}},fitBounds:function(t,e){if(!(t=D(t)).isValid())throw new Error("Bounds are not valid.");var i=this._getBoundsCenterZoom(t,e);return this.setView(i.center,i.zoom,e)},fitWorld:function(t){return this.fitBounds([[-90,-180],[90,180]],t)},panTo:function(t,e){return this.setView(t,this._zoom,{pan:e})},panBy:function(t,e){if(e=e||{},!(t=E(t).round()).x&&!t.y)return this.fire("moveend");if(!0!==e.animate&&!this.getSize().contains(t))return this._resetView(this.unproject(this.project(this.getCenter()).add(t)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new We,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),e.noMoveStart||this.fire("movestart"),!1!==e.animate){ce(this._mapPane,"leaflet-pan-anim");var i=this._getMapPanePos().subtract(t).round();this._panAnim.run(this._mapPane,i,e.duration||.25,e.easeLinearity)}else this._rawPanBy(t),this.fire("move").fire("moveend");return this},flyTo:function(t,e,i){if(!1===(i=i||{}).animate||!Nt.any3d)return this.setView(t,e,i);this._stop();var n=this.project(this.getCenter()),s=this.project(t),r=this.getSize(),o=this._zoom;t=R(t),e=void 0===e?o:e;var a=Math.max(r.x,r.y),h=a*this.getZoomScale(o,e),l=s.distanceTo(n)||1,u=1.42,c=u*u;function d(t){var e=(h*h-a*a+(t?-1:1)*c*c*l*l)/(2*(t?h:a)*c*l),i=Math.sqrt(e*e+1)-e;return i<1e-9?-18:Math.log(i)}function f(t){return(Math.exp(t)-Math.exp(-t))/2}function p(t){return(Math.exp(t)+Math.exp(-t))/2}var m=d(0);function _(t){return a*(p(m)*(f(e=m+u*t)/p(e))-f(m))/c;var e}var y=Date.now(),g=(d(1)-m)/u,v=i.duration?1e3*i.duration:1e3*g*.8;return this._moveStart(!0,i.noMoveStart),function i(){var r=(Date.now()-y)/v,h=function(t){return 1-Math.pow(1-t,1.5)}(r)*g;r<=1?(this._flyToFrame=S(i,this),this._move(this.unproject(n.add(s.subtract(n).multiplyBy(_(h)/l)),o),this.getScaleZoom(a/function(t){return a*(p(m)/p(m+u*t))}(h),o),{flyTo:!0})):this._move(t,e)._moveEnd(!0)}.call(this),this},flyToBounds:function(t,e){var i=this._getBoundsCenterZoom(t,e);return this.flyTo(i.center,i.zoom,e)},setMaxBounds:function(t){return t=D(t),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),t.isValid()?(this.options.maxBounds=t,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(t){var e=this.options.minZoom;return this.options.minZoom=t,this._loaded&&e!==t&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(t):this},setMaxZoom:function(t){var e=this.options.maxZoom;return this.options.maxZoom=t,this._loaded&&e!==t&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(t):this},panInsideBounds:function(t,e){this._enforcingBounds=!0;var i=this.getCenter(),n=this._limitCenter(i,this._zoom,D(t));return i.equals(n)||this.panTo(n,e),this._enforcingBounds=!1,this},panInside:function(t,e){var i=E((e=e||{}).paddingTopLeft||e.padding||[0,0]),n=E(e.paddingBottomRight||e.padding||[0,0]),s=this.project(this.getCenter()),r=this.project(t),o=this.getPixelBounds(),a=z([o.min.add(i),o.max.subtract(n)]),h=a.getSize();if(!a.contains(r)){this._enforcingBounds=!0;var l=r.subtract(a.getCenter()),u=a.extend(r).getSize().subtract(h);s.x+=l.x<0?-u.x:u.x,s.y+=l.y<0?-u.y:u.y,this.panTo(this.unproject(s),e),this._enforcingBounds=!1}return this},invalidateSize:function(t){if(!this._loaded)return this;t=e({animate:!1,pan:!0},!0===t?{animate:!0}:t);var i=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var s=this.getSize(),r=i.divideBy(2).round(),o=s.divideBy(2).round(),a=r.subtract(o);return a.x||a.y?(t.animate&&t.pan?this.panBy(a):(t.pan&&this._rawPanBy(a),this.fire("move"),t.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(n(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:i,newSize:s})):this},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(t){if(t=this._locateOptions=e({timeout:1e4,watch:!1},t),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var i=n(this._handleGeolocationResponse,this),s=n(this._handleGeolocationError,this);return t.watch?this._locationWatchId=navigator.geolocation.watchPosition(i,s,t):navigator.geolocation.getCurrentPosition(i,s,t),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(t){if(this._container._leaflet_id){var e=t.code,i=t.message||(1===e?"permission denied":2===e?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:e,message:"Geolocation error: "+i+"."})}},_handleGeolocationResponse:function(t){if(this._container._leaflet_id){var e=new F(t.coords.latitude,t.coords.longitude),i=e.toBounds(2*t.coords.accuracy),n=this._locateOptions;if(n.setView){var s=this.getBoundsZoom(i);this.setView(e,n.maxZoom?Math.min(s,n.maxZoom):s)}var r={latlng:e,bounds:i,timestamp:t.timestamp};for(var o in t.coords)"number"==typeof t.coords[o]&&(r[o]=t.coords[o]);this.fire("locationfound",r)}},addHandler:function(t,e){if(!e)return this;var i=this[t]=new e(this);return this._handlers.push(i),this.options[t]&&i.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch(t){this._container._leaflet_id=void 0,this._containerId=void 0}var t;for(t in void 0!==this._locationWatchId&&this.stopLocate(),this._stop(),oe(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(I(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload"),this._layers)this._layers[t].remove();for(t in this._panes)oe(this._panes[t]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(t,e){var i=re("div","leaflet-pane"+(t?" leaflet-"+t.replace("Pane","")+"-pane":""),e||this._mapPane);return t&&(this._panes[t]=i),i},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var t=this.getPixelBounds();return new k(this.unproject(t.getBottomLeft()),this.unproject(t.getTopRight()))},getMinZoom:function(){return void 0===this.options.minZoom?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return void 0===this.options.maxZoom?void 0===this._layersMaxZoom?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(t,e,i){t=D(t),i=E(i||[0,0]);var n=this.getZoom()||0,s=this.getMinZoom(),r=this.getMaxZoom(),o=t.getNorthWest(),a=t.getSouthEast(),h=this.getSize().subtract(i),l=z(this.project(a,n),this.project(o,n)).getSize(),u=Nt.any3d?this.options.zoomSnap:1,c=h.x/l.x,d=h.y/l.y,f=e?Math.max(c,d):Math.min(c,d);return n=this.getScaleZoom(f,n),u&&(n=Math.round(n/(u/100))*(u/100),n=e?Math.ceil(n/u)*u:Math.floor(n/u)*u),Math.max(s,Math.min(r,n))},getSize:function(){return this._size&&!this._sizeChanged||(this._size=new B(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(t,e){var i=this._getTopLeftPoint(t,e);return new N(i,i.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(t){return this.options.crs.getProjectedBounds(void 0===t?this.getZoom():t)},getPane:function(t){return"string"==typeof t?this._panes[t]:t},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(t,e){var i=this.options.crs;return e=void 0===e?this._zoom:e,i.scale(t)/i.scale(e)},getScaleZoom:function(t,e){var i=this.options.crs;e=void 0===e?this._zoom:e;var n=i.zoom(t*i.scale(e));return isNaN(n)?1/0:n},project:function(t,e){return e=void 0===e?this._zoom:e,this.options.crs.latLngToPoint(R(t),e)},unproject:function(t,e){return e=void 0===e?this._zoom:e,this.options.crs.pointToLatLng(E(t),e)},layerPointToLatLng:function(t){var e=E(t).add(this.getPixelOrigin());return this.unproject(e)},latLngToLayerPoint:function(t){return this.project(R(t))._round()._subtract(this.getPixelOrigin())},wrapLatLng:function(t){return this.options.crs.wrapLatLng(R(t))},wrapLatLngBounds:function(t){return this.options.crs.wrapLatLngBounds(D(t))},distance:function(t,e){return this.options.crs.distance(R(t),R(e))},containerPointToLayerPoint:function(t){return E(t).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(t){return E(t).add(this._getMapPanePos())},containerPointToLatLng:function(t){var e=this.containerPointToLayerPoint(E(t));return this.layerPointToLatLng(e)},latLngToContainerPoint:function(t){return this.layerPointToContainerPoint(this.latLngToLayerPoint(R(t)))},mouseEventToContainerPoint:function(t){return Ze(t,this._container)},mouseEventToLayerPoint:function(t){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(t))},mouseEventToLatLng:function(t){return this.layerPointToLatLng(this.mouseEventToLayerPoint(t))},_initContainer:function(t){var e=this._container=ne(t);if(!e)throw new Error("Map container not found.");if(e._leaflet_id)throw new Error("Map container is already initialized.");Ae(e,"scroll",this._onScroll,this),this._containerId=r(e)},_initLayout:function(){var t=this._container;this._fadeAnimated=this.options.fadeAnimation&&Nt.any3d,ce(t,"leaflet-container"+(Nt.touch?" leaflet-touch":"")+(Nt.retina?" leaflet-retina":"")+(Nt.ielt9?" leaflet-oldie":"")+(Nt.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var e=se(t,"position");"absolute"!==e&&"relative"!==e&&"fixed"!==e&&"sticky"!==e&&(t.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var t=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),ge(this._mapPane,new B(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(ce(t.markerPane,"leaflet-zoom-hide"),ce(t.shadowPane,"leaflet-zoom-hide"))},_resetView:function(t,e,i){ge(this._mapPane,new B(0,0));var n=!this._loaded;this._loaded=!0,e=this._limitZoom(e),this.fire("viewprereset");var s=this._zoom!==e;this._moveStart(s,i)._move(t,e)._moveEnd(s),this.fire("viewreset"),n&&this.fire("load")},_moveStart:function(t,e){return t&&this.fire("zoomstart"),e||this.fire("movestart"),this},_move:function(t,e,i,n){void 0===e&&(e=this._zoom);var s=this._zoom!==e;return this._zoom=e,this._lastCenter=t,this._pixelOrigin=this._getNewPixelOrigin(t),n?i&&i.pinch&&this.fire("zoom",i):((s||i&&i.pinch)&&this.fire("zoom",i),this.fire("move",i)),this},_moveEnd:function(t){return t&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return I(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(t){ge(this._mapPane,this._getMapPanePos().subtract(t))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(t){this._targets={},this._targets[r(this._container)]=this;var e=t?Ce:Ae;e(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&e(window,"resize",this._onResize,this),Nt.any3d&&this.options.transform3DLimit&&(t?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){I(this._resizeRequest),this._resizeRequest=S((function(){this.invalidateSize({debounceMoveend:!0})}),this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var t=this._getMapPanePos();Math.max(Math.abs(t.x),Math.abs(t.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(t,e){for(var i,n=[],s="mouseout"===e||"mouseover"===e,o=t.target||t.srcElement,a=!1;o;){if((i=this._targets[r(o)])&&("click"===e||"preclick"===e)&&this._draggableMoved(i)){a=!0;break}if(i&&i.listens(e,!0)){if(s&&!Ge(o,t))break;if(n.push(i),s)break}if(o===this._container)break;o=o.parentNode}return n.length||a||s||!this.listens(e,!0)||(n=[this]),n},_isClickDisabled:function(t){for(;t&&t!==this._container;){if(t._leaflet_disable_click)return!0;t=t.parentNode}},_handleDOMEvent:function(t){var e=t.target||t.srcElement;if(!(!this._loaded||e._leaflet_disable_events||"click"===t.type&&this._isClickDisabled(e))){var i=t.type;"mousedown"===i&&Me(e),this._fireDOMEvent(t,i)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(t,i,n){if("click"===t.type){var s=e({},t);s.type="preclick",this._fireDOMEvent(s,s.type,n)}var r=this._findEventTargets(t,i);if(n){for(var o=[],a=0;a<n.length;a++)n[a].listens(i,!0)&&o.push(n[a]);r=o.concat(r)}if(r.length){"contextmenu"===i&&Fe(t);var h=r[0],l={originalEvent:t};if("keypress"!==t.type&&"keydown"!==t.type&&"keyup"!==t.type){var u=h.getLatLng&&(!h._radius||h._radius<=10);l.containerPoint=u?this.latLngToContainerPoint(h.getLatLng()):this.mouseEventToContainerPoint(t),l.layerPoint=this.containerPointToLayerPoint(l.containerPoint),l.latlng=u?h.getLatLng():this.layerPointToLatLng(l.layerPoint)}for(a=0;a<r.length;a++)if(r[a].fire(i,l,!0),l.originalEvent._stopped||!1===r[a].options.bubblingMouseEvents&&-1!==y(this._mouseEvents,i))return}},_draggableMoved:function(t){return(t=t.dragging&&t.dragging.enabled()?t:this).dragging&&t.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var t=0,e=this._handlers.length;t<e;t++)this._handlers[t].disable()},whenReady:function(t,e){return this._loaded?t.call(e||this,{target:this}):this.on("load",t,e),this},_getMapPanePos:function(){return ve(this._mapPane)||new B(0,0)},_moved:function(){var t=this._getMapPanePos();return t&&!t.equals([0,0])},_getTopLeftPoint:function(t,e){return(t&&void 0!==e?this._getNewPixelOrigin(t,e):this.getPixelOrigin()).subtract(this._getMapPanePos())},_getNewPixelOrigin:function(t,e){var i=this.getSize()._divideBy(2);return this.project(t,e)._subtract(i)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(t,e,i){var n=this._getNewPixelOrigin(i,e);return this.project(t,e)._subtract(n)},_latLngBoundsToNewLayerBounds:function(t,e,i){var n=this._getNewPixelOrigin(i,e);return z([this.project(t.getSouthWest(),e)._subtract(n),this.project(t.getNorthWest(),e)._subtract(n),this.project(t.getSouthEast(),e)._subtract(n),this.project(t.getNorthEast(),e)._subtract(n)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(t){return this.latLngToLayerPoint(t).subtract(this._getCenterLayerPoint())},_limitCenter:function(t,e,i){if(!i)return t;var n=this.project(t,e),s=this.getSize().divideBy(2),r=new N(n.subtract(s),n.add(s)),o=this._getBoundsOffset(r,i,e);return Math.abs(o.x)<=1&&Math.abs(o.y)<=1?t:this.unproject(n.add(o),e)},_limitOffset:function(t,e){if(!e)return t;var i=this.getPixelBounds(),n=new N(i.min.add(t),i.max.add(t));return t.add(this._getBoundsOffset(n,e))},_getBoundsOffset:function(t,e,i){var n=z(this.project(e.getNorthEast(),i),this.project(e.getSouthWest(),i)),s=n.min.subtract(t.min),r=n.max.subtract(t.max);return new B(this._rebound(s.x,-r.x),this._rebound(s.y,-r.y))},_rebound:function(t,e){return t+e>0?Math.round(t-e)/2:Math.max(0,Math.ceil(t))-Math.max(0,Math.floor(e))},_limitZoom:function(t){var e=this.getMinZoom(),i=this.getMaxZoom(),n=Nt.any3d?this.options.zoomSnap:1;return n&&(t=Math.round(t/n)*n),Math.max(e,Math.min(i,t))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){de(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(t,e){var i=this._getCenterOffset(t)._trunc();return!(!0!==(e&&e.animate)&&!this.getSize().contains(i)||(this.panBy(i,e),0))},_createAnimProxy:function(){var t=this._proxy=re("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(t),this.on("zoomanim",(function(t){var e=te,i=this._proxy.style[e];ye(this._proxy,this.project(t.center,t.zoom),this.getZoomScale(t.zoom,1)),i===this._proxy.style[e]&&this._animatingZoom&&this._onZoomTransitionEnd()}),this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){oe(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var t=this.getCenter(),e=this.getZoom();ye(this._proxy,this.project(t,e),this.getZoomScale(e,1))},_catchTransitionEnd:function(t){this._animatingZoom&&t.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(t,e,i){if(this._animatingZoom)return!0;if(i=i||{},!this._zoomAnimated||!1===i.animate||this._nothingToAnimate()||Math.abs(e-this._zoom)>this.options.zoomAnimationThreshold)return!1;var n=this.getZoomScale(e),s=this._getCenterOffset(t)._divideBy(1-1/n);return!(!0!==i.animate&&!this.getSize().contains(s)||(S((function(){this._moveStart(!0,!1)._animateZoom(t,e,!0)}),this),0))},_animateZoom:function(t,e,i,s){this._mapPane&&(i&&(this._animatingZoom=!0,this._animateToCenter=t,this._animateToZoom=e,ce(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:t,zoom:e,noUpdate:s}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(n(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&de(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});var $e=A.extend({options:{position:"topright"},initialize:function(t){d(this,t)},getPosition:function(){return this.options.position},setPosition:function(t){var e=this._map;return e&&e.removeControl(this),this.options.position=t,e&&e.addControl(this),this},getContainer:function(){return this._container},addTo:function(t){this.remove(),this._map=t;var e=this._container=this.onAdd(t),i=this.getPosition(),n=t._controlCorners[i];return ce(e,"leaflet-control"),-1!==i.indexOf("bottom")?n.insertBefore(e,n.firstChild):n.appendChild(e),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(oe(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(t){this._map&&t&&t.screenX>0&&t.screenY>0&&this._map.getContainer().focus()}}),Ye=function(t){return new $e(t)};He.include({addControl:function(t){return t.addTo(this),this},removeControl:function(t){return t.remove(),this},_initControlPos:function(){var t=this._controlCorners={},e="leaflet-",i=this._controlContainer=re("div",e+"control-container",this._container);function n(n,s){var r=e+n+" "+e+s;t[n+s]=re("div",r,i)}n("top","left"),n("top","right"),n("bottom","left"),n("bottom","right")},_clearControlPos:function(){for(var t in this._controlCorners)oe(this._controlCorners[t]);oe(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Xe=$e.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(t,e,i,n){return i<n?-1:n<i?1:0}},initialize:function(t,e,i){for(var n in d(this,i),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,t)this._addLayer(t[n],n);for(n in e)this._addLayer(e[n],n,!0)},onAdd:function(t){this._initLayout(),this._update(),this._map=t,t.on("zoomend",this._checkDisabledLayers,this);for(var e=0;e<this._layers.length;e++)this._layers[e].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(t){return $e.prototype.addTo.call(this,t),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var t=0;t<this._layers.length;t++)this._layers[t].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(t,e){return this._addLayer(t,e),this._map?this._update():this},addOverlay:function(t,e){return this._addLayer(t,e,!0),this._map?this._update():this},removeLayer:function(t){t.off("add remove",this._onLayerChange,this);var e=this._getLayer(r(t));return e&&this._layers.splice(this._layers.indexOf(e),1),this._map?this._update():this},expand:function(){ce(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var t=this._map.getSize().y-(this._container.offsetTop+50);return t<this._section.clientHeight?(ce(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=t+"px"):de(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return de(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var t="leaflet-control-layers",e=this._container=re("div",t),i=this.options.collapsed;e.setAttribute("aria-haspopup",!0),De(e),ke(e);var n=this._section=re("section",t+"-list");i&&(this._map.on("click",this.collapse,this),Ae(e,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var s=this._layersLink=re("a",t+"-toggle",e);s.href="#",s.title="Layers",s.setAttribute("role","button"),Ae(s,{keydown:function(t){13===t.keyCode&&this._expandSafely()},click:function(t){Fe(t),this._expandSafely()}},this),i||this.expand(),this._baseLayersList=re("div",t+"-base",n),this._separator=re("div",t+"-separator",n),this._overlaysList=re("div",t+"-overlays",n),e.appendChild(n)},_getLayer:function(t){for(var e=0;e<this._layers.length;e++)if(this._layers[e]&&r(this._layers[e].layer)===t)return this._layers[e]},_addLayer:function(t,e,i){this._map&&t.on("add remove",this._onLayerChange,this),this._layers.push({layer:t,name:e,overlay:i}),this.options.sortLayers&&this._layers.sort(n((function(t,e){return this.options.sortFunction(t.layer,e.layer,t.name,e.name)}),this)),this.options.autoZIndex&&t.setZIndex&&(this._lastZIndex++,t.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;ae(this._baseLayersList),ae(this._overlaysList),this._layerControlInputs=[];var t,e,i,n,s=0;for(i=0;i<this._layers.length;i++)n=this._layers[i],this._addItem(n),e=e||n.overlay,t=t||!n.overlay,s+=n.overlay?0:1;return this.options.hideSingleBase&&(t=t&&s>1,this._baseLayersList.style.display=t?"":"none"),this._separator.style.display=e&&t?"":"none",this},_onLayerChange:function(t){this._handlingClick||this._update();var e=this._getLayer(r(t.target)),i=e.overlay?"add"===t.type?"overlayadd":"overlayremove":"add"===t.type?"baselayerchange":null;i&&this._map.fire(i,e)},_createRadioElement:function(t,e){var i='<input type="radio" class="leaflet-control-layers-selector" name="'+t+'"'+(e?' checked="checked"':"")+"/>",n=document.createElement("div");return n.innerHTML=i,n.firstChild},_addItem:function(t){var e,i=document.createElement("label"),n=this._map.hasLayer(t.layer);t.overlay?((e=document.createElement("input")).type="checkbox",e.className="leaflet-control-layers-selector",e.defaultChecked=n):e=this._createRadioElement("leaflet-base-layers_"+r(this),n),this._layerControlInputs.push(e),e.layerId=r(t.layer),Ae(e,"click",this._onInputClick,this);var s=document.createElement("span");s.innerHTML=" "+t.name;var o=document.createElement("span");return i.appendChild(o),o.appendChild(e),o.appendChild(s),(t.overlay?this._overlaysList:this._baseLayersList).appendChild(i),this._checkDisabledLayers(),i},_onInputClick:function(){var t,e,i=this._layerControlInputs,n=[],s=[];this._handlingClick=!0;for(var r=i.length-1;r>=0;r--)t=i[r],e=this._getLayer(t.layerId).layer,t.checked?n.push(e):t.checked||s.push(e);for(r=0;r<s.length;r++)this._map.hasLayer(s[r])&&this._map.removeLayer(s[r]);for(r=0;r<n.length;r++)this._map.hasLayer(n[r])||this._map.addLayer(n[r]);this._handlingClick=!1,this._refocusOnMap()},_checkDisabledLayers:function(){for(var t,e,i=this._layerControlInputs,n=this._map.getZoom(),s=i.length-1;s>=0;s--)t=i[s],e=this._getLayer(t.layerId).layer,t.disabled=void 0!==e.options.minZoom&&n<e.options.minZoom||void 0!==e.options.maxZoom&&n>e.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var t=this._section;Ae(t,"click",Fe),this.expand(),setTimeout((function(){Ce(t,"click",Fe)}))}}),Ke=$e.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(t){var e="leaflet-control-zoom",i=re("div",e+" leaflet-bar"),n=this.options;return this._zoomInButton=this._createButton(n.zoomInText,n.zoomInTitle,e+"-in",i,this._zoomIn),this._zoomOutButton=this._createButton(n.zoomOutText,n.zoomOutTitle,e+"-out",i,this._zoomOut),this._updateDisabled(),t.on("zoomend zoomlevelschange",this._updateDisabled,this),i},onRemove:function(t){t.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(t){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(t.shiftKey?3:1))},_zoomOut:function(t){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(t.shiftKey?3:1))},_createButton:function(t,e,i,n,s){var r=re("a",i,n);return r.innerHTML=t,r.href="#",r.title=e,r.setAttribute("role","button"),r.setAttribute("aria-label",e),De(r),Ae(r,"click",Re),Ae(r,"click",s,this),Ae(r,"click",this._refocusOnMap,this),r},_updateDisabled:function(){var t=this._map,e="leaflet-disabled";de(this._zoomInButton,e),de(this._zoomOutButton,e),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||t._zoom===t.getMinZoom())&&(ce(this._zoomOutButton,e),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||t._zoom===t.getMaxZoom())&&(ce(this._zoomInButton,e),this._zoomInButton.setAttribute("aria-disabled","true"))}});He.mergeOptions({zoomControl:!0}),He.addInitHook((function(){this.options.zoomControl&&(this.zoomControl=new Ke,this.addControl(this.zoomControl))}));var Je=$e.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(t){var e="leaflet-control-scale",i=re("div",e),n=this.options;return this._addScales(n,e+"-line",i),t.on(n.updateWhenIdle?"moveend":"move",this._update,this),t.whenReady(this._update,this),i},onRemove:function(t){t.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(t,e,i){t.metric&&(this._mScale=re("div",e,i)),t.imperial&&(this._iScale=re("div",e,i))},_update:function(){var t=this._map,e=t.getSize().y/2,i=t.distance(t.containerPointToLatLng([0,e]),t.containerPointToLatLng([this.options.maxWidth,e]));this._updateScales(i)},_updateScales:function(t){this.options.metric&&t&&this._updateMetric(t),this.options.imperial&&t&&this._updateImperial(t)},_updateMetric:function(t){var e=this._getRoundNum(t),i=e<1e3?e+" m":e/1e3+" km";this._updateScale(this._mScale,i,e/t)},_updateImperial:function(t){var e,i,n,s=3.2808399*t;s>5280?(e=s/5280,i=this._getRoundNum(e),this._updateScale(this._iScale,i+" mi",i/e)):(n=this._getRoundNum(s),this._updateScale(this._iScale,n+" ft",n/s))},_updateScale:function(t,e,i){t.style.width=Math.round(this.options.maxWidth*i)+"px",t.innerHTML=e},_getRoundNum:function(t){var e=Math.pow(10,(Math.floor(t)+"").length-1),i=t/e;return e*(i>=10?10:i>=5?5:i>=3?3:i>=2?2:1)}}),Qe=$e.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Nt.inlineSvg?'<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg> ':"")+"Leaflet</a>"},initialize:function(t){d(this,t),this._attributions={}},onAdd:function(t){for(var e in t.attributionControl=this,this._container=re("div","leaflet-control-attribution"),De(this._container),t._layers)t._layers[e].getAttribution&&this.addAttribution(t._layers[e].getAttribution());return this._update(),t.on("layeradd",this._addAttribution,this),this._container},onRemove:function(t){t.off("layeradd",this._addAttribution,this)},_addAttribution:function(t){t.layer.getAttribution&&(this.addAttribution(t.layer.getAttribution()),t.layer.once("remove",(function(){this.removeAttribution(t.layer.getAttribution())}),this))},setPrefix:function(t){return this.options.prefix=t,this._update(),this},addAttribution:function(t){return t?(this._attributions[t]||(this._attributions[t]=0),this._attributions[t]++,this._update(),this):this},removeAttribution:function(t){return t?(this._attributions[t]&&(this._attributions[t]--,this._update()),this):this},_update:function(){if(this._map){var t=[];for(var e in this._attributions)this._attributions[e]&&t.push(e);var i=[];this.options.prefix&&i.push(this.options.prefix),t.length&&i.push(t.join(", ")),this._container.innerHTML=i.join(' <span aria-hidden="true">|</span> ')}}});He.mergeOptions({attributionControl:!0}),He.addInitHook((function(){this.options.attributionControl&&(new Qe).addTo(this)}));$e.Layers=Xe,$e.Zoom=Ke,$e.Scale=Je,$e.Attribution=Qe,Ye.layers=function(t,e,i){return new Xe(t,e,i)},Ye.zoom=function(t){return new Ke(t)},Ye.scale=function(t){return new Je(t)},Ye.attribution=function(t){return new Qe(t)};var ti=A.extend({initialize:function(t){this._map=t},enable:function(){return this._enabled||(this._enabled=!0,this.addHooks()),this},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});ti.addTo=function(t,e){return t.addHandler(e,this),this};var ei,ii={Events:P},ni=Nt.touch?"touchstart mousedown":"mousedown",si=C.extend({options:{clickTolerance:3},initialize:function(t,e,i,n){d(this,n),this._element=t,this._dragStartTarget=e||t,this._preventOutline=i},enable:function(){this._enabled||(Ae(this._dragStartTarget,ni,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(si._dragging===this&&this.finishDrag(!0),Ce(this._dragStartTarget,ni,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(t){if(this._enabled&&(this._moved=!1,!ue(this._element,"leaflet-zoom-anim")))if(t.touches&&1!==t.touches.length)si._dragging===this&&this.finishDrag();else if(!(si._dragging||t.shiftKey||1!==t.which&&1!==t.button&&!t.touches||(si._dragging=this,this._preventOutline&&Me(this._element),we(),Yt(),this._moving))){this.fire("down");var e=t.touches?t.touches[0]:t,i=Ie(this._element);this._startPoint=new B(e.clientX,e.clientY),this._startPos=ve(this._element),this._parentScale=Te(i);var n="mousedown"===t.type;Ae(document,n?"mousemove":"touchmove",this._onMove,this),Ae(document,n?"mouseup":"touchend touchcancel",this._onUp,this)}},_onMove:function(t){if(this._enabled)if(t.touches&&t.touches.length>1)this._moved=!0;else{var e=t.touches&&1===t.touches.length?t.touches[0]:t,i=new B(e.clientX,e.clientY)._subtract(this._startPoint);(i.x||i.y)&&(Math.abs(i.x)+Math.abs(i.y)<this.options.clickTolerance||(i.x/=this._parentScale.x,i.y/=this._parentScale.y,Fe(t),this._moved||(this.fire("dragstart"),this._moved=!0,ce(document.body,"leaflet-dragging"),this._lastTarget=t.target||t.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),ce(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(i),this._moving=!0,this._lastEvent=t,this._updatePosition()))}},_updatePosition:function(){var t={originalEvent:this._lastEvent};this.fire("predrag",t),ge(this._element,this._newPos),this.fire("drag",t)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(t){de(document.body,"leaflet-dragging"),this._lastTarget&&(de(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Ce(document,"mousemove touchmove",this._onMove,this),Ce(document,"mouseup touchend touchcancel",this._onUp,this),xe(),Xt(),this._moved&&this._moving&&this.fire("dragend",{noInertia:t,distance:this._newPos.distanceTo(this._startPos)}),this._moving=!1,si._dragging=!1}});function ri(t,e){if(!e||!t.length)return t.slice();var i=e*e;return function(t,e){var i=t.length,n=new(typeof Uint8Array!=void 0+""?Uint8Array:Array)(i);n[0]=n[i-1]=1,ai(t,n,e,0,i-1);var s,r=[];for(s=0;s<i;s++)n[s]&&r.push(t[s]);return r}(t=function(t,e){for(var i=[t[0]],n=1,s=0,r=t.length;n<r;n++)ci(t[n],t[s])>e&&(i.push(t[n]),s=n);return s<r-1&&i.push(t[r-1]),i}(t,i),i)}function oi(t,e,i){return Math.sqrt(di(t,e,i,!0))}function ai(t,e,i,n,s){var r,o,a,h=0;for(o=n+1;o<=s-1;o++)(a=di(t[o],t[n],t[s],!0))>h&&(r=o,h=a);h>i&&(e[r]=1,ai(t,e,i,n,r),ai(t,e,i,r,s))}function hi(t,e,i,n,s){var r,o,a,h=n?ei:ui(t,i),l=ui(e,i);for(ei=l;;){if(!(h|l))return[t,e];if(h&l)return!1;a=ui(o=li(t,e,r=h||l,i,s),i),r===h?(t=o,h=a):(e=o,l=a)}}function li(t,e,i,n,s){var r,o,a=e.x-t.x,h=e.y-t.y,l=n.min,u=n.max;return 8&i?(r=t.x+a*(u.y-t.y)/h,o=u.y):4&i?(r=t.x+a*(l.y-t.y)/h,o=l.y):2&i?(r=u.x,o=t.y+h*(u.x-t.x)/a):1&i&&(r=l.x,o=t.y+h*(l.x-t.x)/a),new B(r,o,s)}function ui(t,e){var i=0;return t.x<e.min.x?i|=1:t.x>e.max.x&&(i|=2),t.y<e.min.y?i|=4:t.y>e.max.y&&(i|=8),i}function ci(t,e){var i=e.x-t.x,n=e.y-t.y;return i*i+n*n}function di(t,e,i,n){var s,r=e.x,o=e.y,a=i.x-r,h=i.y-o,l=a*a+h*h;return l>0&&((s=((t.x-r)*a+(t.y-o)*h)/l)>1?(r=i.x,o=i.y):s>0&&(r+=a*s,o+=h*s)),a=t.x-r,h=t.y-o,n?a*a+h*h:new B(r,o)}function fi(t){return!_(t[0])||"object"!=typeof t[0][0]&&void 0!==t[0][0]}function pi(t){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),fi(t)}function mi(t,e){var i,n,s,r,o,a,h,l;if(!t||0===t.length)throw new Error("latlngs not passed");fi(t)||(console.warn("latlngs are not flat! Only the first ring will be used"),t=t[0]);var u=[];for(var c in t)u.push(e.project(R(t[c])));var d=u.length;for(i=0,n=0;i<d-1;i++)n+=u[i].distanceTo(u[i+1])/2;if(0===n)l=u[0];else for(i=0,r=0;i<d-1;i++)if(o=u[i],a=u[i+1],(r+=s=o.distanceTo(a))>n){h=(r-n)/s,l=[a.x-h*(a.x-o.x),a.y-h*(a.y-o.y)];break}return e.unproject(E(l))}var _i={__proto__:null,simplify:ri,pointToSegmentDistance:oi,closestPointOnSegment:function(t,e,i){return di(t,e,i)},clipSegment:hi,_getEdgeIntersection:li,_getBitCode:ui,_sqClosestPointOnSegment:di,isFlat:fi,_flat:pi,polylineCenter:mi};function yi(t,e,i){var n,s,r,o,a,h,l,u,c,d=[1,4,2,8];for(s=0,l=t.length;s<l;s++)t[s]._code=ui(t[s],e);for(o=0;o<4;o++){for(u=d[o],n=[],s=0,r=(l=t.length)-1;s<l;r=s++)a=t[s],h=t[r],a._code&u?h._code&u||((c=li(h,a,u,e,i))._code=ui(c,e),n.push(c)):(h._code&u&&((c=li(h,a,u,e,i))._code=ui(c,e),n.push(c)),n.push(a));t=n}return t}function gi(t,e){var i,n,s,r,o,a,h,l,u;if(!t||0===t.length)throw new Error("latlngs not passed");fi(t)||(console.warn("latlngs are not flat! Only the first ring will be used"),t=t[0]);var c=[];for(var d in t)c.push(e.project(R(t[d])));var f=c.length;for(a=h=l=0,i=0,n=f-1;i<f;n=i++)s=c[i],r=c[n],o=s.y*r.x-r.y*s.x,h+=(s.x+r.x)*o,l+=(s.y+r.y)*o,a+=3*o;return u=0===a?c[0]:[h/a,l/a],e.unproject(E(u))}var vi={__proto__:null,clipPolygon:yi,polygonCenter:gi},bi={project:function(t){return new B(t.lng,t.lat)},unproject:function(t){return new F(t.y,t.x)},bounds:new N([-180,-90],[180,90])},wi={R:6378137,R_MINOR:6356752.314245179,bounds:new N([-20037508.34279,-15496570.73972],[20037508.34279,18764656.23138]),project:function(t){var e=Math.PI/180,i=this.R,n=t.lat*e,s=this.R_MINOR/i,r=Math.sqrt(1-s*s),o=r*Math.sin(n),a=Math.tan(Math.PI/4-n/2)/Math.pow((1-o)/(1+o),r/2);return n=-i*Math.log(Math.max(a,1e-10)),new B(t.lng*e*i,n)},unproject:function(t){for(var e,i=180/Math.PI,n=this.R,s=this.R_MINOR/n,r=Math.sqrt(1-s*s),o=Math.exp(-t.y/n),a=Math.PI/2-2*Math.atan(o),h=0,l=.1;h<15&&Math.abs(l)>1e-7;h++)e=r*Math.sin(a),e=Math.pow((1-e)/(1+e),r/2),a+=l=Math.PI/2-2*Math.atan(o*e)-a;return new F(a*i,t.x*i/n)}},xi={__proto__:null,LonLat:bi,Mercator:wi,SphericalMercator:G},Mi=e({},j,{code:"EPSG:3395",projection:wi,transformation:function(){var t=.5/(Math.PI*wi.R);return W(t,.5,-t,.5)}()}),Si=e({},j,{code:"EPSG:4326",projection:bi,transformation:W(1/180,1,-1/180,.5)}),Ii=e({},Z,{projection:bi,transformation:W(1,0,-1,0),scale:function(t){return Math.pow(2,t)},zoom:function(t){return Math.log(t)/Math.LN2},distance:function(t,e){var i=e.lng-t.lng,n=e.lat-t.lat;return Math.sqrt(i*i+n*n)},infinite:!0});Z.Earth=j,Z.EPSG3395=Mi,Z.EPSG3857=H,Z.EPSG900913=$,Z.EPSG4326=Si,Z.Simple=Ii;var Ti=C.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(t){return t.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(t){return t&&t.removeLayer(this),this},getPane:function(t){return this._map.getPane(t?this.options[t]||t:this.options.pane)},addInteractiveTarget:function(t){return this._map._targets[r(t)]=this,this},removeInteractiveTarget:function(t){return delete this._map._targets[r(t)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(t){var e=t.target;if(e.hasLayer(this)){if(this._map=e,this._zoomAnimated=e._zoomAnimated,this.getEvents){var i=this.getEvents();e.on(i,this),this.once("remove",(function(){e.off(i,this)}),this)}this.onAdd(e),this.fire("add"),e.fire("layeradd",{layer:this})}}});He.include({addLayer:function(t){if(!t._layerAdd)throw new Error("The provided object is not a Layer.");var e=r(t);return this._layers[e]||(this._layers[e]=t,t._mapToAdd=this,t.beforeAdd&&t.beforeAdd(this),this.whenReady(t._layerAdd,t)),this},removeLayer:function(t){var e=r(t);return this._layers[e]?(this._loaded&&t.onRemove(this),delete this._layers[e],this._loaded&&(this.fire("layerremove",{layer:t}),t.fire("remove")),t._map=t._mapToAdd=null,this):this},hasLayer:function(t){return r(t)in this._layers},eachLayer:function(t,e){for(var i in this._layers)t.call(e,this._layers[i]);return this},_addLayers:function(t){for(var e=0,i=(t=t?_(t)?t:[t]:[]).length;e<i;e++)this.addLayer(t[e])},_addZoomLimit:function(t){isNaN(t.options.maxZoom)&&isNaN(t.options.minZoom)||(this._zoomBoundLayers[r(t)]=t,this._updateZoomLevels())},_removeZoomLimit:function(t){var e=r(t);this._zoomBoundLayers[e]&&(delete this._zoomBoundLayers[e],this._updateZoomLevels())},_updateZoomLevels:function(){var t=1/0,e=-1/0,i=this._getZoomSpan();for(var n in this._zoomBoundLayers){var s=this._zoomBoundLayers[n].options;t=void 0===s.minZoom?t:Math.min(t,s.minZoom),e=void 0===s.maxZoom?e:Math.max(e,s.maxZoom)}this._layersMaxZoom=e===-1/0?void 0:e,this._layersMinZoom=t===1/0?void 0:t,i!==this._getZoomSpan()&&this.fire("zoomlevelschange"),void 0===this.options.maxZoom&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),void 0===this.options.minZoom&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Li=Ti.extend({initialize:function(t,e){var i,n;if(d(this,e),this._layers={},t)for(i=0,n=t.length;i<n;i++)this.addLayer(t[i])},addLayer:function(t){var e=this.getLayerId(t);return this._layers[e]=t,this._map&&this._map.addLayer(t),this},removeLayer:function(t){var e=t in this._layers?t:this.getLayerId(t);return this._map&&this._layers[e]&&this._map.removeLayer(this._layers[e]),delete this._layers[e],this},hasLayer:function(t){return("number"==typeof t?t:this.getLayerId(t))in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(t){var e,i,n=Array.prototype.slice.call(arguments,1);for(e in this._layers)(i=this._layers[e])[t]&&i[t].apply(i,n);return this},onAdd:function(t){this.eachLayer(t.addLayer,t)},onRemove:function(t){this.eachLayer(t.removeLayer,t)},eachLayer:function(t,e){for(var i in this._layers)t.call(e,this._layers[i]);return this},getLayer:function(t){return this._layers[t]},getLayers:function(){var t=[];return this.eachLayer(t.push,t),t},setZIndex:function(t){return this.invoke("setZIndex",t)},getLayerId:function(t){return r(t)}}),Ai=Li.extend({addLayer:function(t){return this.hasLayer(t)?this:(t.addEventParent(this),Li.prototype.addLayer.call(this,t),this.fire("layeradd",{layer:t}))},removeLayer:function(t){return this.hasLayer(t)?(t in this._layers&&(t=this._layers[t]),t.removeEventParent(this),Li.prototype.removeLayer.call(this,t),this.fire("layerremove",{layer:t})):this},setStyle:function(t){return this.invoke("setStyle",t)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var t=new k;for(var e in this._layers){var i=this._layers[e];t.extend(i.getBounds?i.getBounds():i.getLatLng())}return t}}),Pi=A.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(t){d(this,t)},createIcon:function(t){return this._createIcon("icon",t)},createShadow:function(t){return this._createIcon("shadow",t)},_createIcon:function(t,e){var i=this._getIconUrl(t);if(!i){if("icon"===t)throw new Error("iconUrl not set in Icon options (see the docs).");return null}var n=this._createImg(i,e&&"IMG"===e.tagName?e:null);return this._setIconStyles(n,t),(this.options.crossOrigin||""===this.options.crossOrigin)&&(n.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),n},_setIconStyles:function(t,e){var i=this.options,n=i[e+"Size"];"number"==typeof n&&(n=[n,n]);var s=E(n),r=E("shadow"===e&&i.shadowAnchor||i.iconAnchor||s&&s.divideBy(2,!0));t.className="leaflet-marker-"+e+" "+(i.className||""),r&&(t.style.marginLeft=-r.x+"px",t.style.marginTop=-r.y+"px"),s&&(t.style.width=s.x+"px",t.style.height=s.y+"px")},_createImg:function(t,e){return(e=e||document.createElement("img")).src=t,e},_getIconUrl:function(t){return Nt.retina&&this.options[t+"RetinaUrl"]||this.options[t+"Url"]}});var Ci=Pi.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(t){return"string"!=typeof Ci.imagePath&&(Ci.imagePath=this._detectIconPath()),(this.options.imagePath||Ci.imagePath)+Pi.prototype._getIconUrl.call(this,t)},_stripUrl:function(t){var e=function(t,e,i){var n=e.exec(t);return n&&n[i]};return(t=e(t,/^url\((['"])?(.+)\1\)$/,2))&&e(t,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var t=re("div","leaflet-default-icon-path",document.body),e=se(t,"background-image")||se(t,"backgroundImage");if(document.body.removeChild(t),e=this._stripUrl(e))return e;var i=document.querySelector('link[href$="leaflet.css"]');return i?i.href.substring(0,i.href.length-11-1):""}}),Bi=ti.extend({initialize:function(t){this._marker=t},addHooks:function(){var t=this._marker._icon;this._draggable||(this._draggable=new si(t,t,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),ce(t,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&de(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(t){var e=this._marker,i=e._map,n=this._marker.options.autoPanSpeed,s=this._marker.options.autoPanPadding,r=ve(e._icon),o=i.getPixelBounds(),a=i.getPixelOrigin(),h=z(o.min._subtract(a).add(s),o.max._subtract(a).subtract(s));if(!h.contains(r)){var l=E((Math.max(h.max.x,r.x)-h.max.x)/(o.max.x-h.max.x)-(Math.min(h.min.x,r.x)-h.min.x)/(o.min.x-h.min.x),(Math.max(h.max.y,r.y)-h.max.y)/(o.max.y-h.max.y)-(Math.min(h.min.y,r.y)-h.min.y)/(o.min.y-h.min.y)).multiplyBy(n);i.panBy(l,{animate:!1}),this._draggable._newPos._add(l),this._draggable._startPos._add(l),ge(e._icon,this._draggable._newPos),this._onDrag(t),this._panRequest=S(this._adjustPan.bind(this,t))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(t){this._marker.options.autoPan&&(I(this._panRequest),this._panRequest=S(this._adjustPan.bind(this,t)))},_onDrag:function(t){var e=this._marker,i=e._shadow,n=ve(e._icon),s=e._map.layerPointToLatLng(n);i&&ge(i,n),e._latlng=s,t.latlng=s,t.oldLatLng=this._oldLatLng,e.fire("move",t).fire("drag",t)},_onDragEnd:function(t){I(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",t)}}),Oi=Ti.extend({options:{icon:new Ci,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(t,e){d(this,e),this._latlng=R(t)},onAdd:function(t){this._zoomAnimated=this._zoomAnimated&&t.options.markerZoomAnimation,this._zoomAnimated&&t.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(t){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&t.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(t){var e=this._latlng;return this._latlng=R(t),this.update(),this.fire("move",{oldLatLng:e,latlng:this._latlng})},setZIndexOffset:function(t){return this.options.zIndexOffset=t,this.update()},getIcon:function(){return this.options.icon},setIcon:function(t){return this.options.icon=t,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var t=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(t)}return this},_initIcon:function(){var t=this.options,e="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),i=t.icon.createIcon(this._icon),n=!1;i!==this._icon&&(this._icon&&this._removeIcon(),n=!0,t.title&&(i.title=t.title),"IMG"===i.tagName&&(i.alt=t.alt||"")),ce(i,e),t.keyboard&&(i.tabIndex="0",i.setAttribute("role","button")),this._icon=i,t.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Ae(i,"focus",this._panOnFocus,this);var s=t.icon.createShadow(this._shadow),r=!1;s!==this._shadow&&(this._removeShadow(),r=!0),s&&(ce(s,e),s.alt=""),this._shadow=s,t.opacity<1&&this._updateOpacity(),n&&this.getPane().appendChild(this._icon),this._initInteraction(),s&&r&&this.getPane(t.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Ce(this._icon,"focus",this._panOnFocus,this),oe(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&oe(this._shadow),this._shadow=null},_setPos:function(t){this._icon&&ge(this._icon,t),this._shadow&&ge(this._shadow,t),this._zIndex=t.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(t){this._icon&&(this._icon.style.zIndex=this._zIndex+t)},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center).round();this._setPos(e)},_initInteraction:function(){if(this.options.interactive&&(ce(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Bi)){var t=this.options.draggable;this.dragging&&(t=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Bi(this),t&&this.dragging.enable()}},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var t=this.options.opacity;this._icon&&me(this._icon,t),this._shadow&&me(this._shadow,t)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var t=this._map;if(t){var e=this.options.icon.options,i=e.iconSize?E(e.iconSize):E(0,0),n=e.iconAnchor?E(e.iconAnchor):E(0,0);t.panInside(this._latlng,{paddingTopLeft:n,paddingBottomRight:i.subtract(n)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});var Ei=Ti.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(t){this._renderer=t.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(t){return d(this,t),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&t&&Object.prototype.hasOwnProperty.call(t,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Ni=Ei.extend({options:{fill:!0,radius:10},initialize:function(t,e){d(this,e),this._latlng=R(t),this._radius=this.options.radius},setLatLng:function(t){var e=this._latlng;return this._latlng=R(t),this.redraw(),this.fire("move",{oldLatLng:e,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(t){return this.options.radius=this._radius=t,this.redraw()},getRadius:function(){return this._radius},setStyle:function(t){var e=t&&t.radius||this._radius;return Ei.prototype.setStyle.call(this,t),this.setRadius(e),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var t=this._radius,e=this._radiusY||t,i=this._clickTolerance(),n=[t+i,e+i];this._pxBounds=new N(this._point.subtract(n),this._point.add(n))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(t){return t.distanceTo(this._point)<=this._radius+this._clickTolerance()}});var zi=Ni.extend({initialize:function(t,i,n){if("number"==typeof i&&(i=e({},n,{radius:i})),d(this,i),this._latlng=R(t),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(t){return this._mRadius=t,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var t=[this._radius,this._radiusY||this._radius];return new k(this._map.layerPointToLatLng(this._point.subtract(t)),this._map.layerPointToLatLng(this._point.add(t)))},setStyle:Ei.prototype.setStyle,_project:function(){var t=this._latlng.lng,e=this._latlng.lat,i=this._map,n=i.options.crs;if(n.distance===j.distance){var s=Math.PI/180,r=this._mRadius/j.R/s,o=i.project([e+r,t]),a=i.project([e-r,t]),h=o.add(a).divideBy(2),l=i.unproject(h).lat,u=Math.acos((Math.cos(r*s)-Math.sin(e*s)*Math.sin(l*s))/(Math.cos(e*s)*Math.cos(l*s)))/s;(isNaN(u)||0===u)&&(u=r/Math.cos(Math.PI/180*e)),this._point=h.subtract(i.getPixelOrigin()),this._radius=isNaN(u)?0:h.x-i.project([l,t-u]).x,this._radiusY=h.y-o.y}else{var c=n.unproject(n.project(this._latlng).subtract([this._mRadius,0]));this._point=i.latLngToLayerPoint(this._latlng),this._radius=this._point.x-i.latLngToLayerPoint(c).x}this._updateBounds()}});var ki=Ei.extend({options:{smoothFactor:1,noClip:!1},initialize:function(t,e){d(this,e),this._setLatLngs(t)},getLatLngs:function(){return this._latlngs},setLatLngs:function(t){return this._setLatLngs(t),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(t){for(var e,i,n=1/0,s=null,r=di,o=0,a=this._parts.length;o<a;o++)for(var h=this._parts[o],l=1,u=h.length;l<u;l++){var c=r(t,e=h[l-1],i=h[l],!0);c<n&&(n=c,s=r(t,e,i))}return s&&(s.distance=Math.sqrt(n)),s},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return mi(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(t,e){return e=e||this._defaultShape(),t=R(t),e.push(t),this._bounds.extend(t),this.redraw()},_setLatLngs:function(t){this._bounds=new k,this._latlngs=this._convertLatLngs(t)},_defaultShape:function(){return fi(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(t){for(var e=[],i=fi(t),n=0,s=t.length;n<s;n++)i?(e[n]=R(t[n]),this._bounds.extend(e[n])):e[n]=this._convertLatLngs(t[n]);return e},_project:function(){var t=new N;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,t),this._bounds.isValid()&&t.isValid()&&(this._rawPxBounds=t,this._updateBounds())},_updateBounds:function(){var t=this._clickTolerance(),e=new B(t,t);this._rawPxBounds&&(this._pxBounds=new N([this._rawPxBounds.min.subtract(e),this._rawPxBounds.max.add(e)]))},_projectLatlngs:function(t,e,i){var n,s,r=t[0]instanceof F,o=t.length;if(r){for(s=[],n=0;n<o;n++)s[n]=this._map.latLngToLayerPoint(t[n]),i.extend(s[n]);e.push(s)}else for(n=0;n<o;n++)this._projectLatlngs(t[n],e,i)},_clipPoints:function(){var t=this._renderer._bounds;if(this._parts=[],this._pxBounds&&this._pxBounds.intersects(t))if(this.options.noClip)this._parts=this._rings;else{var e,i,n,s,r,o,a,h=this._parts;for(e=0,n=0,s=this._rings.length;e<s;e++)for(i=0,r=(a=this._rings[e]).length;i<r-1;i++)(o=hi(a[i],a[i+1],t,i,!0))&&(h[n]=h[n]||[],h[n].push(o[0]),o[1]===a[i+1]&&i!==r-2||(h[n].push(o[1]),n++))}},_simplifyPoints:function(){for(var t=this._parts,e=this.options.smoothFactor,i=0,n=t.length;i<n;i++)t[i]=ri(t[i],e)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(t,e){var i,n,s,r,o,a,h=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(i=0,r=this._parts.length;i<r;i++)for(n=0,s=(o=(a=this._parts[i]).length)-1;n<o;s=n++)if((e||0!==n)&&oi(t,a[s],a[n])<=h)return!0;return!1}});ki._flat=pi;var Di=ki.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return gi(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(t){var e=ki.prototype._convertLatLngs.call(this,t),i=e.length;return i>=2&&e[0]instanceof F&&e[0].equals(e[i-1])&&e.pop(),e},_setLatLngs:function(t){ki.prototype._setLatLngs.call(this,t),fi(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return fi(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var t=this._renderer._bounds,e=this.options.weight,i=new B(e,e);if(t=new N(t.min.subtract(i),t.max.add(i)),this._parts=[],this._pxBounds&&this._pxBounds.intersects(t))if(this.options.noClip)this._parts=this._rings;else for(var n,s=0,r=this._rings.length;s<r;s++)(n=yi(this._rings[s],t,!0)).length&&this._parts.push(n)},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(t){var e,i,n,s,r,o,a,h,l=!1;if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(s=0,a=this._parts.length;s<a;s++)for(r=0,o=(h=(e=this._parts[s]).length)-1;r<h;o=r++)i=e[r],n=e[o],i.y>t.y!=n.y>t.y&&t.x<(n.x-i.x)*(t.y-i.y)/(n.y-i.y)+i.x&&(l=!l);return l||ki.prototype._containsPoint.call(this,t,!0)}});var Fi=Ai.extend({initialize:function(t,e){d(this,e),this._layers={},t&&this.addData(t)},addData:function(t){var e,i,n,s=_(t)?t:t.features;if(s){for(e=0,i=s.length;e<i;e++)((n=s[e]).geometries||n.geometry||n.features||n.coordinates)&&this.addData(n);return this}var r=this.options;if(r.filter&&!r.filter(t))return this;var o=Ri(t,r);return o?(o.feature=Wi(t),o.defaultOptions=o.options,this.resetStyle(o),r.onEachFeature&&r.onEachFeature(t,o),this.addLayer(o)):this},resetStyle:function(t){return void 0===t?this.eachLayer(this.resetStyle,this):(t.options=e({},t.defaultOptions),this._setLayerStyle(t,this.options.style),this)},setStyle:function(t){return this.eachLayer((function(e){this._setLayerStyle(e,t)}),this)},_setLayerStyle:function(t,e){t.setStyle&&("function"==typeof e&&(e=e(t.feature)),t.setStyle(e))}});function Ri(t,e){var i,n,s,r,o="Feature"===t.type?t.geometry:t,a=o?o.coordinates:null,h=[],l=e&&e.pointToLayer,u=e&&e.coordsToLatLng||Zi;if(!a&&!o)return null;switch(o.type){case"Point":return Ui(l,t,i=u(a),e);case"MultiPoint":for(s=0,r=a.length;s<r;s++)i=u(a[s]),h.push(Ui(l,t,i,e));return new Ai(h);case"LineString":case"MultiLineString":return n=ji(a,"LineString"===o.type?0:1,u),new ki(n,e);case"Polygon":case"MultiPolygon":return n=ji(a,"Polygon"===o.type?1:2,u),new Di(n,e);case"GeometryCollection":for(s=0,r=o.geometries.length;s<r;s++){var c=Ri({geometry:o.geometries[s],type:"Feature",properties:t.properties},e);c&&h.push(c)}return new Ai(h);case"FeatureCollection":for(s=0,r=o.features.length;s<r;s++){var d=Ri(o.features[s],e);d&&h.push(d)}return new Ai(h);default:throw new Error("Invalid GeoJSON object.")}}function Ui(t,e,i,n){return t?t(e,i):new Oi(i,n&&n.markersInheritOptions&&n)}function Zi(t){return new F(t[1],t[0],t[2])}function ji(t,e,i){for(var n,s=[],r=0,o=t.length;r<o;r++)n=e?ji(t[r],e-1,i):(i||Zi)(t[r]),s.push(n);return s}function Vi(t,e){return void 0!==(t=R(t)).alt?[l(t.lng,e),l(t.lat,e),l(t.alt,e)]:[l(t.lng,e),l(t.lat,e)]}function Gi(t,e,i,n){for(var s=[],r=0,o=t.length;r<o;r++)s.push(e?Gi(t[r],fi(t[r])?0:e-1,i,n):Vi(t[r],n));return!e&&i&&s.push(s[0].slice()),s}function qi(t,i){return t.feature?e({},t.feature,{geometry:i}):Wi(i)}function Wi(t){return"Feature"===t.type||"FeatureCollection"===t.type?t:{type:"Feature",properties:{},geometry:t}}var Hi={toGeoJSON:function(t){return qi(this,{type:"Point",coordinates:Vi(this.getLatLng(),t)})}};function $i(t,e){return new Fi(t,e)}Oi.include(Hi),zi.include(Hi),Ni.include(Hi),ki.include({toGeoJSON:function(t){var e=!fi(this._latlngs);return qi(this,{type:(e?"Multi":"")+"LineString",coordinates:Gi(this._latlngs,e?1:0,!1,t)})}}),Di.include({toGeoJSON:function(t){var e=!fi(this._latlngs),i=e&&!fi(this._latlngs[0]),n=Gi(this._latlngs,i?2:e?1:0,!0,t);return e||(n=[n]),qi(this,{type:(i?"Multi":"")+"Polygon",coordinates:n})}}),Li.include({toMultiPoint:function(t){var e=[];return this.eachLayer((function(i){e.push(i.toGeoJSON(t).geometry.coordinates)})),qi(this,{type:"MultiPoint",coordinates:e})},toGeoJSON:function(t){var e=this.feature&&this.feature.geometry&&this.feature.geometry.type;if("MultiPoint"===e)return this.toMultiPoint(t);var i="GeometryCollection"===e,n=[];return this.eachLayer((function(e){if(e.toGeoJSON){var s=e.toGeoJSON(t);if(i)n.push(s.geometry);else{var r=Wi(s);"FeatureCollection"===r.type?n.push.apply(n,r.features):n.push(r)}}})),i?qi(this,{geometries:n,type:"GeometryCollection"}):{type:"FeatureCollection",features:n}}});var Yi=$i,Xi=Ti.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(t,e,i){this._url=t,this._bounds=D(e),d(this,i)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(ce(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){oe(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(t){return this.options.opacity=t,this._image&&this._updateOpacity(),this},setStyle:function(t){return t.opacity&&this.setOpacity(t.opacity),this},bringToFront:function(){return this._map&&he(this._image),this},bringToBack:function(){return this._map&&le(this._image),this},setUrl:function(t){return this._url=t,this._image&&(this._image.src=t),this},setBounds:function(t){return this._bounds=D(t),this._map&&this._reset(),this},getEvents:function(){var t={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var t="IMG"===this._url.tagName,e=this._image=t?this._url:re("img");ce(e,"leaflet-image-layer"),this._zoomAnimated&&ce(e,"leaflet-zoom-animated"),this.options.className&&ce(e,this.options.className),e.onselectstart=h,e.onmousemove=h,e.onload=n(this.fire,this,"load"),e.onerror=n(this._overlayOnError,this,"error"),(this.options.crossOrigin||""===this.options.crossOrigin)&&(e.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),t?this._url=e.src:(e.src=this._url,e.alt=this.options.alt)},_animateZoom:function(t){var e=this._map.getZoomScale(t.zoom),i=this._map._latLngBoundsToNewLayerBounds(this._bounds,t.zoom,t.center).min;ye(this._image,i,e)},_reset:function(){var t=this._image,e=new N(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),i=e.getSize();ge(t,e.min),t.style.width=i.x+"px",t.style.height=i.y+"px"},_updateOpacity:function(){me(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&void 0!==this.options.zIndex&&null!==this.options.zIndex&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var t=this.options.errorOverlayUrl;t&&this._url!==t&&(this._url=t,this._image.src=t)},getCenter:function(){return this._bounds.getCenter()}}),Ki=Xi.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var t="VIDEO"===this._url.tagName,e=this._image=t?this._url:re("video");if(ce(e,"leaflet-image-layer"),this._zoomAnimated&&ce(e,"leaflet-zoom-animated"),this.options.className&&ce(e,this.options.className),e.onselectstart=h,e.onmousemove=h,e.onloadeddata=n(this.fire,this,"load"),t){for(var i=e.getElementsByTagName("source"),s=[],r=0;r<i.length;r++)s.push(i[r].src);this._url=i.length>0?s:[e.src]}else{_(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(e.style,"objectFit")&&(e.style.objectFit="fill"),e.autoplay=!!this.options.autoplay,e.loop=!!this.options.loop,e.muted=!!this.options.muted,e.playsInline=!!this.options.playsInline;for(var o=0;o<this._url.length;o++){var a=re("source");a.src=this._url[o],e.appendChild(a)}}}});var Ji=Xi.extend({_initImage:function(){var t=this._image=this._url;ce(t,"leaflet-image-layer"),this._zoomAnimated&&ce(t,"leaflet-zoom-animated"),this.options.className&&ce(t,this.options.className),t.onselectstart=h,t.onmousemove=h}});var Qi=Ti.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(t,e){t&&(t instanceof F||_(t))?(this._latlng=R(t),d(this,e)):(d(this,t),this._source=e),this.options.content&&(this._content=this.options.content)},openOn:function(t){return(t=arguments.length?t:this._source._map).hasLayer(this)||t.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(t){return this._map?this.close():(arguments.length?this._source=t:t=this._source,this._prepareOpen(),this.openOn(t._map)),this},onAdd:function(t){this._zoomAnimated=t._zoomAnimated,this._container||this._initLayout(),t._fadeAnimated&&me(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),t._fadeAnimated&&me(this._container,1),this.bringToFront(),this.options.interactive&&(ce(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(t){t._fadeAnimated?(me(this._container,0),this._removeTimeout=setTimeout(n(oe,void 0,this._container),200)):oe(this._container),this.options.interactive&&(de(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=R(t),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(t){return this._content=t,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var t={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&he(this._container),this},bringToBack:function(){return this._map&&le(this._container),this},_prepareOpen:function(t){var e=this._source;if(!e._map)return!1;if(e instanceof Ai){e=null;var i=this._source._layers;for(var n in i)if(i[n]._map){e=i[n];break}if(!e)return!1;this._source=e}if(!t)if(e.getCenter)t=e.getCenter();else if(e.getLatLng)t=e.getLatLng();else{if(!e.getBounds)throw new Error("Unable to get source layer LatLng.");t=e.getBounds().getCenter()}return this.setLatLng(t),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var t=this._contentNode,e="function"==typeof this._content?this._content(this._source||this):this._content;if("string"==typeof e)t.innerHTML=e;else{for(;t.hasChildNodes();)t.removeChild(t.firstChild);t.appendChild(e)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var t=this._map.latLngToLayerPoint(this._latlng),e=E(this.options.offset),i=this._getAnchor();this._zoomAnimated?ge(this._container,t.add(i)):e=e.add(t).add(i);var n=this._containerBottom=-e.y,s=this._containerLeft=-Math.round(this._containerWidth/2)+e.x;this._container.style.bottom=n+"px",this._container.style.left=s+"px"}},_getAnchor:function(){return[0,0]}});He.include({_initOverlay:function(t,e,i,n){var s=e;return s instanceof t||(s=new t(n).setContent(e)),i&&s.setLatLng(i),s}}),Ti.include({_initOverlay:function(t,e,i,n){var s=i;return s instanceof t?(d(s,n),s._source=this):(s=e&&!n?e:new t(n,this)).setContent(i),s}});var tn=Qi.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(t){return!(t=arguments.length?t:this._source._map).hasLayer(this)&&t._popup&&t._popup.options.autoClose&&t.removeLayer(t._popup),t._popup=this,Qi.prototype.openOn.call(this,t)},onAdd:function(t){Qi.prototype.onAdd.call(this,t),t.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Ei||this._source.on("preclick",ze))},onRemove:function(t){Qi.prototype.onRemove.call(this,t),t.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Ei||this._source.off("preclick",ze))},getEvents:function(){var t=Qi.prototype.getEvents.call(this);return(void 0!==this.options.closeOnClick?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(t.preclick=this.close),this.options.keepInView&&(t.moveend=this._adjustPan),t},_initLayout:function(){var t="leaflet-popup",e=this._container=re("div",t+" "+(this.options.className||"")+" leaflet-zoom-animated"),i=this._wrapper=re("div",t+"-content-wrapper",e);if(this._contentNode=re("div",t+"-content",i),De(e),ke(this._contentNode),Ae(e,"contextmenu",ze),this._tipContainer=re("div",t+"-tip-container",e),this._tip=re("div",t+"-tip",this._tipContainer),this.options.closeButton){var n=this._closeButton=re("a",t+"-close-button",e);n.setAttribute("role","button"),n.setAttribute("aria-label","Close popup"),n.href="#close",n.innerHTML='<span aria-hidden="true">&#215;</span>',Ae(n,"click",(function(t){Fe(t),this.close()}),this)}},_updateLayout:function(){var t=this._contentNode,e=t.style;e.width="",e.whiteSpace="nowrap";var i=t.offsetWidth;i=Math.min(i,this.options.maxWidth),i=Math.max(i,this.options.minWidth),e.width=i+1+"px",e.whiteSpace="",e.height="";var n=t.offsetHeight,s=this.options.maxHeight,r="leaflet-popup-scrolled";s&&n>s?(e.height=s+"px",ce(t,r)):de(t,r),this._containerWidth=this._container.offsetWidth},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center),i=this._getAnchor();ge(this._container,e.add(i))},_adjustPan:function(){if(this.options.autoPan)if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning)this._autopanning=!1;else{var t=this._map,e=parseInt(se(this._container,"marginBottom"),10)||0,i=this._container.offsetHeight+e,n=this._containerWidth,s=new B(this._containerLeft,-i-this._containerBottom);s._add(ve(this._container));var r=t.layerPointToContainerPoint(s),o=E(this.options.autoPanPadding),a=E(this.options.autoPanPaddingTopLeft||o),h=E(this.options.autoPanPaddingBottomRight||o),l=t.getSize(),u=0,c=0;r.x+n+h.x>l.x&&(u=r.x+n-l.x+h.x),r.x-u-a.x<0&&(u=r.x-a.x),r.y+i+h.y>l.y&&(c=r.y+i-l.y+h.y),r.y-c-a.y<0&&(c=r.y-a.y),(u||c)&&(this.options.keepInView&&(this._autopanning=!0),t.fire("autopanstart").panBy([u,c]))}},_getAnchor:function(){return E(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}});He.mergeOptions({closePopupOnClick:!0}),He.include({openPopup:function(t,e,i){return this._initOverlay(tn,t,e,i).openOn(this),this},closePopup:function(t){return(t=arguments.length?t:this._popup)&&t.close(),this}}),Ti.include({bindPopup:function(t,e){return this._popup=this._initOverlay(tn,this._popup,t,e),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(t){return this._popup&&(this instanceof Ai||(this._popup._source=this),this._popup._prepareOpen(t||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return!!this._popup&&this._popup.isOpen()},setPopupContent:function(t){return this._popup&&this._popup.setContent(t),this},getPopup:function(){return this._popup},_openPopup:function(t){if(this._popup&&this._map){Re(t);var e=t.layer||t.target;this._popup._source!==e||e instanceof Ei?(this._popup._source=e,this.openPopup(t.latlng)):this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(t.latlng)}},_movePopup:function(t){this._popup.setLatLng(t.latlng)},_onKeyPress:function(t){13===t.originalEvent.keyCode&&this._openPopup(t)}});var en=Qi.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(t){Qi.prototype.onAdd.call(this,t),this.setOpacity(this.options.opacity),t.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(t){Qi.prototype.onRemove.call(this,t),t.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var t=Qi.prototype.getEvents.call(this);return this.options.permanent||(t.preclick=this.close),t},_initLayout:function(){var t="leaflet-tooltip "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=re("div",t),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+r(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(t){var e,i,n=this._map,s=this._container,r=n.latLngToContainerPoint(n.getCenter()),o=n.layerPointToContainerPoint(t),a=this.options.direction,h=s.offsetWidth,l=s.offsetHeight,u=E(this.options.offset),c=this._getAnchor();"top"===a?(e=h/2,i=l):"bottom"===a?(e=h/2,i=0):"center"===a?(e=h/2,i=l/2):"right"===a?(e=0,i=l/2):"left"===a?(e=h,i=l/2):o.x<r.x?(a="right",e=0,i=l/2):(a="left",e=h+2*(u.x+c.x),i=l/2),t=t.subtract(E(e,i,!0)).add(u).add(c),de(s,"leaflet-tooltip-right"),de(s,"leaflet-tooltip-left"),de(s,"leaflet-tooltip-top"),de(s,"leaflet-tooltip-bottom"),ce(s,"leaflet-tooltip-"+a),ge(s,t)},_updatePosition:function(){var t=this._map.latLngToLayerPoint(this._latlng);this._setPosition(t)},setOpacity:function(t){this.options.opacity=t,this._container&&me(this._container,t)},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center);this._setPosition(e)},_getAnchor:function(){return E(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}});He.include({openTooltip:function(t,e,i){return this._initOverlay(en,t,e,i).openOn(this),this},closeTooltip:function(t){return t.close(),this}}),Ti.include({bindTooltip:function(t,e){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(en,this._tooltip,t,e),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(t){if(t||!this._tooltipHandlersAdded){var e=t?"off":"on",i={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?i.add=this._openTooltip:(i.mouseover=this._openTooltip,i.mouseout=this.closeTooltip,i.click=this._openTooltip,this._map?this._addFocusListeners():i.add=this._addFocusListeners),this._tooltip.options.sticky&&(i.mousemove=this._moveTooltip),this[e](i),this._tooltipHandlersAdded=!t}},openTooltip:function(t){return this._tooltip&&(this instanceof Ai||(this._tooltip._source=this),this._tooltip._prepareOpen(t)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(t){return this._tooltip&&this._tooltip.setContent(t),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(t){var e=t.getElement();e&&(Ae(e,"focus",(function(){this._tooltip._source=t,this.openTooltip()}),this),Ae(e,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(t){var e=t.getElement();e&&e.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(t){!this._tooltip||!this._map||this._map.dragging&&this._map.dragging.moving()||(this._tooltip._source=t.layer||t.target,this.openTooltip(this._tooltip.options.sticky?t.latlng:void 0))},_moveTooltip:function(t){var e,i,n=t.latlng;this._tooltip.options.sticky&&t.originalEvent&&(e=this._map.mouseEventToContainerPoint(t.originalEvent),i=this._map.containerPointToLayerPoint(e),n=this._map.layerPointToLatLng(i)),this._tooltip.setLatLng(n)}});var nn=Pi.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(t){var e=t&&"DIV"===t.tagName?t:document.createElement("div"),i=this.options;if(i.html instanceof Element?(ae(e),e.appendChild(i.html)):e.innerHTML=!1!==i.html?i.html:"",i.bgPos){var n=E(i.bgPos);e.style.backgroundPosition=-n.x+"px "+-n.y+"px"}return this._setIconStyles(e,"icon"),e},createShadow:function(){return null}});Pi.Default=Ci;var sn=Ti.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Nt.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(t){d(this,t)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(t){t._addZoomLimit(this)},onRemove:function(t){this._removeAllTiles(),oe(this._container),t._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(he(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(le(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(t){return this.options.opacity=t,this._updateOpacity(),this},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var t=this._clampZoom(this._map.getZoom());t!==this._tileZoom&&(this._tileZoom=t,this._updateLevels()),this._update()}return this},getEvents:function(){var t={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=o(this._onMoveEnd,this.options.updateInterval,this)),t.move=this._onMove),this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},createTile:function(){return document.createElement("div")},getTileSize:function(){var t=this.options.tileSize;return t instanceof B?t:new B(t,t)},_updateZIndex:function(){this._container&&void 0!==this.options.zIndex&&null!==this.options.zIndex&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(t){for(var e,i=this.getPane().children,n=-t(-1/0,1/0),s=0,r=i.length;s<r;s++)e=i[s].style.zIndex,i[s]!==this._container&&e&&(n=t(n,+e));isFinite(n)&&(this.options.zIndex=n+t(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Nt.ielt9){me(this._container,this.options.opacity);var t=+new Date,e=!1,i=!1;for(var n in this._tiles){var s=this._tiles[n];if(s.current&&s.loaded){var r=Math.min(1,(t-s.loaded)/200);me(s.el,r),r<1?e=!0:(s.active?i=!0:this._onOpaqueTile(s),s.active=!0)}}i&&!this._noPrune&&this._pruneTiles(),e&&(I(this._fadeFrame),this._fadeFrame=S(this._updateOpacity,this))}},_onOpaqueTile:h,_initContainer:function(){this._container||(this._container=re("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var t=this._tileZoom,e=this.options.maxZoom;if(void 0!==t){for(var i in this._levels)i=Number(i),this._levels[i].el.children.length||i===t?(this._levels[i].el.style.zIndex=e-Math.abs(t-i),this._onUpdateLevel(i)):(oe(this._levels[i].el),this._removeTilesAtZoom(i),this._onRemoveLevel(i),delete this._levels[i]);var n=this._levels[t],s=this._map;return n||((n=this._levels[t]={}).el=re("div","leaflet-tile-container leaflet-zoom-animated",this._container),n.el.style.zIndex=e,n.origin=s.project(s.unproject(s.getPixelOrigin()),t).round(),n.zoom=t,this._setZoomTransform(n,s.getCenter(),s.getZoom()),n.el.offsetWidth,this._onCreateLevel(n)),this._level=n,n}},_onUpdateLevel:h,_onRemoveLevel:h,_onCreateLevel:h,_pruneTiles:function(){if(this._map){var t,e,i=this._map.getZoom();if(i>this.options.maxZoom||i<this.options.minZoom)this._removeAllTiles();else{for(t in this._tiles)(e=this._tiles[t]).retain=e.current;for(t in this._tiles)if((e=this._tiles[t]).current&&!e.active){var n=e.coords;this._retainParent(n.x,n.y,n.z,n.z-5)||this._retainChildren(n.x,n.y,n.z,n.z+2)}for(t in this._tiles)this._tiles[t].retain||this._removeTile(t)}}},_removeTilesAtZoom:function(t){for(var e in this._tiles)this._tiles[e].coords.z===t&&this._removeTile(e)},_removeAllTiles:function(){for(var t in this._tiles)this._removeTile(t)},_invalidateAll:function(){for(var t in this._levels)oe(this._levels[t].el),this._onRemoveLevel(Number(t)),delete this._levels[t];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(t,e,i,n){var s=Math.floor(t/2),r=Math.floor(e/2),o=i-1,a=new B(+s,+r);a.z=+o;var h=this._tileCoordsToKey(a),l=this._tiles[h];return l&&l.active?(l.retain=!0,!0):(l&&l.loaded&&(l.retain=!0),o>n&&this._retainParent(s,r,o,n))},_retainChildren:function(t,e,i,n){for(var s=2*t;s<2*t+2;s++)for(var r=2*e;r<2*e+2;r++){var o=new B(s,r);o.z=i+1;var a=this._tileCoordsToKey(o),h=this._tiles[a];h&&h.active?h.retain=!0:(h&&h.loaded&&(h.retain=!0),i+1<n&&this._retainChildren(s,r,i+1,n))}},_resetView:function(t){var e=t&&(t.pinch||t.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),e,e)},_animateZoom:function(t){this._setView(t.center,t.zoom,!0,t.noUpdate)},_clampZoom:function(t){var e=this.options;return void 0!==e.minNativeZoom&&t<e.minNativeZoom?e.minNativeZoom:void 0!==e.maxNativeZoom&&e.maxNativeZoom<t?e.maxNativeZoom:t},_setView:function(t,e,i,n){var s=Math.round(e);s=void 0!==this.options.maxZoom&&s>this.options.maxZoom||void 0!==this.options.minZoom&&s<this.options.minZoom?void 0:this._clampZoom(s);var r=this.options.updateWhenZooming&&s!==this._tileZoom;n&&!r||(this._tileZoom=s,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),void 0!==s&&this._update(t),i||this._pruneTiles(),this._noPrune=!!i),this._setZoomTransforms(t,e)},_setZoomTransforms:function(t,e){for(var i in this._levels)this._setZoomTransform(this._levels[i],t,e)},_setZoomTransform:function(t,e,i){var n=this._map.getZoomScale(i,t.zoom),s=t.origin.multiplyBy(n).subtract(this._map._getNewPixelOrigin(e,i)).round();Nt.any3d?ye(t.el,s,n):ge(t.el,s)},_resetGrid:function(){var t=this._map,e=t.options.crs,i=this._tileSize=this.getTileSize(),n=this._tileZoom,s=this._map.getPixelWorldBounds(this._tileZoom);s&&(this._globalTileRange=this._pxBoundsToTileRange(s)),this._wrapX=e.wrapLng&&!this.options.noWrap&&[Math.floor(t.project([0,e.wrapLng[0]],n).x/i.x),Math.ceil(t.project([0,e.wrapLng[1]],n).x/i.y)],this._wrapY=e.wrapLat&&!this.options.noWrap&&[Math.floor(t.project([e.wrapLat[0],0],n).y/i.x),Math.ceil(t.project([e.wrapLat[1],0],n).y/i.y)]},_onMoveEnd:function(){this._map&&!this._map._animatingZoom&&this._update()},_getTiledPixelBounds:function(t){var e=this._map,i=e._animatingZoom?Math.max(e._animateToZoom,e.getZoom()):e.getZoom(),n=e.getZoomScale(i,this._tileZoom),s=e.project(t,this._tileZoom).floor(),r=e.getSize().divideBy(2*n);return new N(s.subtract(r),s.add(r))},_update:function(t){var e=this._map;if(e){var i=this._clampZoom(e.getZoom());if(void 0===t&&(t=e.getCenter()),void 0!==this._tileZoom){var n=this._getTiledPixelBounds(t),s=this._pxBoundsToTileRange(n),r=s.getCenter(),o=[],a=this.options.keepBuffer,h=new N(s.getBottomLeft().subtract([a,-a]),s.getTopRight().add([a,-a]));if(!(isFinite(s.min.x)&&isFinite(s.min.y)&&isFinite(s.max.x)&&isFinite(s.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var l in this._tiles){var u=this._tiles[l].coords;u.z===this._tileZoom&&h.contains(new B(u.x,u.y))||(this._tiles[l].current=!1)}if(Math.abs(i-this._tileZoom)>1)this._setView(t,i);else{for(var c=s.min.y;c<=s.max.y;c++)for(var d=s.min.x;d<=s.max.x;d++){var f=new B(d,c);if(f.z=this._tileZoom,this._isValidTile(f)){var p=this._tiles[this._tileCoordsToKey(f)];p?p.current=!0:o.push(f)}}if(o.sort((function(t,e){return t.distanceTo(r)-e.distanceTo(r)})),0!==o.length){this._loading||(this._loading=!0,this.fire("loading"));var m=document.createDocumentFragment();for(d=0;d<o.length;d++)this._addTile(o[d],m);this._level.el.appendChild(m)}}}}},_isValidTile:function(t){var e=this._map.options.crs;if(!e.infinite){var i=this._globalTileRange;if(!e.wrapLng&&(t.x<i.min.x||t.x>i.max.x)||!e.wrapLat&&(t.y<i.min.y||t.y>i.max.y))return!1}if(!this.options.bounds)return!0;var n=this._tileCoordsToBounds(t);return D(this.options.bounds).overlaps(n)},_keyToBounds:function(t){return this._tileCoordsToBounds(this._keyToTileCoords(t))},_tileCoordsToNwSe:function(t){var e=this._map,i=this.getTileSize(),n=t.scaleBy(i),s=n.add(i);return[e.unproject(n,t.z),e.unproject(s,t.z)]},_tileCoordsToBounds:function(t){var e=this._tileCoordsToNwSe(t),i=new k(e[0],e[1]);return this.options.noWrap||(i=this._map.wrapLatLngBounds(i)),i},_tileCoordsToKey:function(t){return t.x+":"+t.y+":"+t.z},_keyToTileCoords:function(t){var e=t.split(":"),i=new B(+e[0],+e[1]);return i.z=+e[2],i},_removeTile:function(t){var e=this._tiles[t];e&&(oe(e.el),delete this._tiles[t],this.fire("tileunload",{tile:e.el,coords:this._keyToTileCoords(t)}))},_initTile:function(t){ce(t,"leaflet-tile");var e=this.getTileSize();t.style.width=e.x+"px",t.style.height=e.y+"px",t.onselectstart=h,t.onmousemove=h,Nt.ielt9&&this.options.opacity<1&&me(t,this.options.opacity)},_addTile:function(t,e){var i=this._getTilePos(t),s=this._tileCoordsToKey(t),r=this.createTile(this._wrapCoords(t),n(this._tileReady,this,t));this._initTile(r),this.createTile.length<2&&S(n(this._tileReady,this,t,null,r)),ge(r,i),this._tiles[s]={el:r,coords:t,current:!0},e.appendChild(r),this.fire("tileloadstart",{tile:r,coords:t})},_tileReady:function(t,e,i){e&&this.fire("tileerror",{error:e,tile:i,coords:t});var s=this._tileCoordsToKey(t);(i=this._tiles[s])&&(i.loaded=+new Date,this._map._fadeAnimated?(me(i.el,0),I(this._fadeFrame),this._fadeFrame=S(this._updateOpacity,this)):(i.active=!0,this._pruneTiles()),e||(ce(i.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:i.el,coords:t})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Nt.ielt9||!this._map._fadeAnimated?S(this._pruneTiles,this):setTimeout(n(this._pruneTiles,this),250)))},_getTilePos:function(t){return t.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(t){var e=new B(this._wrapX?a(t.x,this._wrapX):t.x,this._wrapY?a(t.y,this._wrapY):t.y);return e.z=t.z,e},_pxBoundsToTileRange:function(t){var e=this.getTileSize();return new N(t.min.unscaleBy(e).floor(),t.max.unscaleBy(e).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var t in this._tiles)if(!this._tiles[t].loaded)return!1;return!0}});var rn=sn.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(t,e){this._url=t,(e=d(this,e)).detectRetina&&Nt.retina&&e.maxZoom>0?(e.tileSize=Math.floor(e.tileSize/2),e.zoomReverse?(e.zoomOffset--,e.minZoom=Math.min(e.maxZoom,e.minZoom+1)):(e.zoomOffset++,e.maxZoom=Math.max(e.minZoom,e.maxZoom-1)),e.minZoom=Math.max(0,e.minZoom)):e.zoomReverse?e.minZoom=Math.min(e.maxZoom,e.minZoom):e.maxZoom=Math.max(e.minZoom,e.maxZoom),"string"==typeof e.subdomains&&(e.subdomains=e.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(t,e){return this._url===t&&void 0===e&&(e=!0),this._url=t,e||this.redraw(),this},createTile:function(t,e){var i=document.createElement("img");return Ae(i,"load",n(this._tileOnLoad,this,e,i)),Ae(i,"error",n(this._tileOnError,this,e,i)),(this.options.crossOrigin||""===this.options.crossOrigin)&&(i.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),"string"==typeof this.options.referrerPolicy&&(i.referrerPolicy=this.options.referrerPolicy),i.alt="",i.src=this.getTileUrl(t),i},getTileUrl:function(t){var i={r:Nt.retina?"@2x":"",s:this._getSubdomain(t),x:t.x,y:t.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var n=this._globalTileRange.max.y-t.y;this.options.tms&&(i.y=n),i["-y"]=n}return m(this._url,e(i,this.options))},_tileOnLoad:function(t,e){Nt.ielt9?setTimeout(n(t,this,null,e),0):t(null,e)},_tileOnError:function(t,e,i){var n=this.options.errorTileUrl;n&&e.getAttribute("src")!==n&&(e.src=n),t(i,e)},_onTileRemove:function(t){t.tile.onload=null},_getZoomForUrl:function(){var t=this._tileZoom,e=this.options.maxZoom;return this.options.zoomReverse&&(t=e-t),t+this.options.zoomOffset},_getSubdomain:function(t){var e=Math.abs(t.x+t.y)%this.options.subdomains.length;return this.options.subdomains[e]},_abortLoading:function(){var t,e;for(t in this._tiles)if(this._tiles[t].coords.z!==this._tileZoom&&((e=this._tiles[t].el).onload=h,e.onerror=h,!e.complete)){e.src=g;var i=this._tiles[t].coords;oe(e),delete this._tiles[t],this.fire("tileabort",{tile:e,coords:i})}},_removeTile:function(t){var e=this._tiles[t];if(e)return e.el.setAttribute("src",g),sn.prototype._removeTile.call(this,t)},_tileReady:function(t,e,i){if(this._map&&(!i||i.getAttribute("src")!==g))return sn.prototype._tileReady.call(this,t,e,i)}});function on(t,e){return new rn(t,e)}var an=rn.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(t,i){this._url=t;var n=e({},this.defaultWmsParams);for(var s in i)s in this.options||(n[s]=i[s]);var r=(i=d(this,i)).detectRetina&&Nt.retina?2:1,o=this.getTileSize();n.width=o.x*r,n.height=o.y*r,this.wmsParams=n},onAdd:function(t){this._crs=this.options.crs||t.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var e=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[e]=this._crs.code,rn.prototype.onAdd.call(this,t)},getTileUrl:function(t){var e=this._tileCoordsToNwSe(t),i=this._crs,n=z(i.project(e[0]),i.project(e[1])),s=n.min,r=n.max,o=(this._wmsVersion>=1.3&&this._crs===Si?[s.y,s.x,r.y,r.x]:[s.x,s.y,r.x,r.y]).join(","),a=rn.prototype.getTileUrl.call(this,t);return a+f(this.wmsParams,a,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+o},setParams:function(t,i){return e(this.wmsParams,t),i||this.redraw(),this}});rn.WMS=an,on.wms=function(t,e){return new an(t,e)};var hn=Ti.extend({options:{padding:.1},initialize:function(t){d(this,t),r(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),this._zoomAnimated&&ce(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var t={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(t.zoomanim=this._onAnimZoom),t},_onAnimZoom:function(t){this._updateTransform(t.center,t.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(t,e){var i=this._map.getZoomScale(e,this._zoom),n=this._map.getSize().multiplyBy(.5+this.options.padding),s=this._map.project(this._center,e),r=n.multiplyBy(-i).add(s).subtract(this._map._getNewPixelOrigin(t,e));Nt.any3d?ye(this._container,r,i):ge(this._container,r)},_reset:function(){for(var t in this._update(),this._updateTransform(this._center,this._zoom),this._layers)this._layers[t]._reset()},_onZoomEnd:function(){for(var t in this._layers)this._layers[t]._project()},_updatePaths:function(){for(var t in this._layers)this._layers[t]._update()},_update:function(){var t=this.options.padding,e=this._map.getSize(),i=this._map.containerPointToLayerPoint(e.multiplyBy(-t)).round();this._bounds=new N(i,i.add(e.multiplyBy(1+2*t)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),ln=hn.extend({options:{tolerance:0},getEvents:function(){var t=hn.prototype.getEvents.call(this);return t.viewprereset=this._onViewPreReset,t},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){hn.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var t=this._container=document.createElement("canvas");Ae(t,"mousemove",this._onMouseMove,this),Ae(t,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Ae(t,"mouseout",this._handleMouseOut,this),t._leaflet_disable_events=!0,this._ctx=t.getContext("2d")},_destroyContainer:function(){I(this._redrawRequest),delete this._ctx,oe(this._container),Ce(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){for(var t in this._redrawBounds=null,this._layers)this._layers[t]._update();this._redraw()}},_update:function(){if(!this._map._animatingZoom||!this._bounds){hn.prototype._update.call(this);var t=this._bounds,e=this._container,i=t.getSize(),n=Nt.retina?2:1;ge(e,t.min),e.width=n*i.x,e.height=n*i.y,e.style.width=i.x+"px",e.style.height=i.y+"px",Nt.retina&&this._ctx.scale(2,2),this._ctx.translate(-t.min.x,-t.min.y),this.fire("update")}},_reset:function(){hn.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(t){this._updateDashArray(t),this._layers[r(t)]=t;var e=t._order={layer:t,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=e),this._drawLast=e,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(t){this._requestRedraw(t)},_removePath:function(t){var e=t._order,i=e.next,n=e.prev;i?i.prev=n:this._drawLast=n,n?n.next=i:this._drawFirst=i,delete t._order,delete this._layers[r(t)],this._requestRedraw(t)},_updatePath:function(t){this._extendRedrawBounds(t),t._project(),t._update(),this._requestRedraw(t)},_updateStyle:function(t){this._updateDashArray(t),this._requestRedraw(t)},_updateDashArray:function(t){if("string"==typeof t.options.dashArray){var e,i,n=t.options.dashArray.split(/[, ]+/),s=[];for(i=0;i<n.length;i++){if(e=Number(n[i]),isNaN(e))return;s.push(e)}t.options._dashArray=s}else t.options._dashArray=t.options.dashArray},_requestRedraw:function(t){this._map&&(this._extendRedrawBounds(t),this._redrawRequest=this._redrawRequest||S(this._redraw,this))},_extendRedrawBounds:function(t){if(t._pxBounds){var e=(t.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new N,this._redrawBounds.extend(t._pxBounds.min.subtract([e,e])),this._redrawBounds.extend(t._pxBounds.max.add([e,e]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var t=this._redrawBounds;if(t){var e=t.getSize();this._ctx.clearRect(t.min.x,t.min.y,e.x,e.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var t,e=this._redrawBounds;if(this._ctx.save(),e){var i=e.getSize();this._ctx.beginPath(),this._ctx.rect(e.min.x,e.min.y,i.x,i.y),this._ctx.clip()}this._drawing=!0;for(var n=this._drawFirst;n;n=n.next)t=n.layer,(!e||t._pxBounds&&t._pxBounds.intersects(e))&&t._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(t,e){if(this._drawing){var i,n,s,r,o=t._parts,a=o.length,h=this._ctx;if(a){for(h.beginPath(),i=0;i<a;i++){for(n=0,s=o[i].length;n<s;n++)r=o[i][n],h[n?"lineTo":"moveTo"](r.x,r.y);e&&h.closePath()}this._fillStroke(h,t)}}},_updateCircle:function(t){if(this._drawing&&!t._empty()){var e=t._point,i=this._ctx,n=Math.max(Math.round(t._radius),1),s=(Math.max(Math.round(t._radiusY),1)||n)/n;1!==s&&(i.save(),i.scale(1,s)),i.beginPath(),i.arc(e.x,e.y/s,n,0,2*Math.PI,!1),1!==s&&i.restore(),this._fillStroke(i,t)}},_fillStroke:function(t,e){var i=e.options;i.fill&&(t.globalAlpha=i.fillOpacity,t.fillStyle=i.fillColor||i.color,t.fill(i.fillRule||"evenodd")),i.stroke&&0!==i.weight&&(t.setLineDash&&t.setLineDash(e.options&&e.options._dashArray||[]),t.globalAlpha=i.opacity,t.lineWidth=i.weight,t.strokeStyle=i.color,t.lineCap=i.lineCap,t.lineJoin=i.lineJoin,t.stroke())},_onClick:function(t){for(var e,i,n=this._map.mouseEventToLayerPoint(t),s=this._drawFirst;s;s=s.next)(e=s.layer).options.interactive&&e._containsPoint(n)&&("click"!==t.type&&"preclick"!==t.type||!this._map._draggableMoved(e))&&(i=e);this._fireEvent(!!i&&[i],t)},_onMouseMove:function(t){if(this._map&&!this._map.dragging.moving()&&!this._map._animatingZoom){var e=this._map.mouseEventToLayerPoint(t);this._handleMouseHover(t,e)}},_handleMouseOut:function(t){var e=this._hoveredLayer;e&&(de(this._container,"leaflet-interactive"),this._fireEvent([e],t,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(t,e){if(!this._mouseHoverThrottled){for(var i,s,r=this._drawFirst;r;r=r.next)(i=r.layer).options.interactive&&i._containsPoint(e)&&(s=i);s!==this._hoveredLayer&&(this._handleMouseOut(t),s&&(ce(this._container,"leaflet-interactive"),this._fireEvent([s],t,"mouseover"),this._hoveredLayer=s)),this._fireEvent(!!this._hoveredLayer&&[this._hoveredLayer],t),this._mouseHoverThrottled=!0,setTimeout(n((function(){this._mouseHoverThrottled=!1}),this),32)}},_fireEvent:function(t,e,i){this._map._fireDOMEvent(e,i||e.type,t)},_bringToFront:function(t){var e=t._order;if(e){var i=e.next,n=e.prev;i&&(i.prev=n,n?n.next=i:i&&(this._drawFirst=i),e.prev=this._drawLast,this._drawLast.next=e,e.next=null,this._drawLast=e,this._requestRedraw(t))}},_bringToBack:function(t){var e=t._order;if(e){var i=e.next,n=e.prev;n&&(n.next=i,i?i.prev=n:n&&(this._drawLast=n),e.prev=null,e.next=this._drawFirst,this._drawFirst.prev=e,this._drawFirst=e,this._requestRedraw(t))}}});function un(t){return Nt.canvas?new ln(t):null}var cn=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(t){return document.createElement("<lvml:"+t+' class="lvml">')}}catch(t){}return function(t){return document.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),dn={_initContainer:function(){this._container=re("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(hn.prototype._update.call(this),this.fire("update"))},_initPath:function(t){var e=t._container=cn("shape");ce(e,"leaflet-vml-shape "+(this.options.className||"")),e.coordsize="1 1",t._path=cn("path"),e.appendChild(t._path),this._updateStyle(t),this._layers[r(t)]=t},_addPath:function(t){var e=t._container;this._container.appendChild(e),t.options.interactive&&t.addInteractiveTarget(e)},_removePath:function(t){var e=t._container;oe(e),t.removeInteractiveTarget(e),delete this._layers[r(t)]},_updateStyle:function(t){var e=t._stroke,i=t._fill,n=t.options,s=t._container;s.stroked=!!n.stroke,s.filled=!!n.fill,n.stroke?(e||(e=t._stroke=cn("stroke")),s.appendChild(e),e.weight=n.weight+"px",e.color=n.color,e.opacity=n.opacity,n.dashArray?e.dashStyle=_(n.dashArray)?n.dashArray.join(" "):n.dashArray.replace(/( *, *)/g," "):e.dashStyle="",e.endcap=n.lineCap.replace("butt","flat"),e.joinstyle=n.lineJoin):e&&(s.removeChild(e),t._stroke=null),n.fill?(i||(i=t._fill=cn("fill")),s.appendChild(i),i.color=n.fillColor||n.color,i.opacity=n.fillOpacity):i&&(s.removeChild(i),t._fill=null)},_updateCircle:function(t){var e=t._point.round(),i=Math.round(t._radius),n=Math.round(t._radiusY||i);this._setPath(t,t._empty()?"M0 0":"AL "+e.x+","+e.y+" "+i+","+n+" 0,23592600")},_setPath:function(t,e){t._path.v=e},_bringToFront:function(t){he(t._container)},_bringToBack:function(t){le(t._container)}},fn=Nt.vml?cn:Y,pn=hn.extend({_initContainer:function(){this._container=fn("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=fn("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){oe(this._container),Ce(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!this._map._animatingZoom||!this._bounds){hn.prototype._update.call(this);var t=this._bounds,e=t.getSize(),i=this._container;this._svgSize&&this._svgSize.equals(e)||(this._svgSize=e,i.setAttribute("width",e.x),i.setAttribute("height",e.y)),ge(i,t.min),i.setAttribute("viewBox",[t.min.x,t.min.y,e.x,e.y].join(" ")),this.fire("update")}},_initPath:function(t){var e=t._path=fn("path");t.options.className&&ce(e,t.options.className),t.options.interactive&&ce(e,"leaflet-interactive"),this._updateStyle(t),this._layers[r(t)]=t},_addPath:function(t){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(t._path),t.addInteractiveTarget(t._path)},_removePath:function(t){oe(t._path),t.removeInteractiveTarget(t._path),delete this._layers[r(t)]},_updatePath:function(t){t._project(),t._update()},_updateStyle:function(t){var e=t._path,i=t.options;e&&(i.stroke?(e.setAttribute("stroke",i.color),e.setAttribute("stroke-opacity",i.opacity),e.setAttribute("stroke-width",i.weight),e.setAttribute("stroke-linecap",i.lineCap),e.setAttribute("stroke-linejoin",i.lineJoin),i.dashArray?e.setAttribute("stroke-dasharray",i.dashArray):e.removeAttribute("stroke-dasharray"),i.dashOffset?e.setAttribute("stroke-dashoffset",i.dashOffset):e.removeAttribute("stroke-dashoffset")):e.setAttribute("stroke","none"),i.fill?(e.setAttribute("fill",i.fillColor||i.color),e.setAttribute("fill-opacity",i.fillOpacity),e.setAttribute("fill-rule",i.fillRule||"evenodd")):e.setAttribute("fill","none"))},_updatePoly:function(t,e){this._setPath(t,X(t._parts,e))},_updateCircle:function(t){var e=t._point,i=Math.max(Math.round(t._radius),1),n="a"+i+","+(Math.max(Math.round(t._radiusY),1)||i)+" 0 1,0 ",s=t._empty()?"M0 0":"M"+(e.x-i)+","+e.y+n+2*i+",0 "+n+2*-i+",0 ";this._setPath(t,s)},_setPath:function(t,e){t._path.setAttribute("d",e)},_bringToFront:function(t){he(t._path)},_bringToBack:function(t){le(t._path)}});function mn(t){return Nt.svg||Nt.vml?new pn(t):null}Nt.vml&&pn.include(dn),He.include({getRenderer:function(t){var e=t.options.renderer||this._getPaneRenderer(t.options.pane)||this.options.renderer||this._renderer;return e||(e=this._renderer=this._createRenderer()),this.hasLayer(e)||this.addLayer(e),e},_getPaneRenderer:function(t){if("overlayPane"===t||void 0===t)return!1;var e=this._paneRenderers[t];return void 0===e&&(e=this._createRenderer({pane:t}),this._paneRenderers[t]=e),e},_createRenderer:function(t){return this.options.preferCanvas&&un(t)||mn(t)}});var _n=Di.extend({initialize:function(t,e){Di.prototype.initialize.call(this,this._boundsToLatLngs(t),e)},setBounds:function(t){return this.setLatLngs(this._boundsToLatLngs(t))},_boundsToLatLngs:function(t){return[(t=D(t)).getSouthWest(),t.getNorthWest(),t.getNorthEast(),t.getSouthEast()]}});pn.create=fn,pn.pointsToPath=X,Fi.geometryToLayer=Ri,Fi.coordsToLatLng=Zi,Fi.coordsToLatLngs=ji,Fi.latLngToCoords=Vi,Fi.latLngsToCoords=Gi,Fi.getFeature=qi,Fi.asFeature=Wi,He.mergeOptions({boxZoom:!0});var yn=ti.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane,this._resetStateTimeout=0,t.on("unload",this._destroy,this)},addHooks:function(){Ae(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Ce(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){oe(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){0!==this._resetStateTimeout&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(t){if(!t.shiftKey||1!==t.which&&1!==t.button)return!1;this._clearDeferredResetState(),this._resetState(),Yt(),we(),this._startPoint=this._map.mouseEventToContainerPoint(t),Ae(document,{contextmenu:Re,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(t){this._moved||(this._moved=!0,this._box=re("div","leaflet-zoom-box",this._container),ce(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(t);var e=new N(this._point,this._startPoint),i=e.getSize();ge(this._box,e.min),this._box.style.width=i.x+"px",this._box.style.height=i.y+"px"},_finish:function(){this._moved&&(oe(this._box),de(this._container,"leaflet-crosshair")),Xt(),xe(),Ce(document,{contextmenu:Re,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(t){if((1===t.which||1===t.button)&&(this._finish(),this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(n(this._resetState,this),0);var e=new k(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(e).fire("boxzoomend",{boxZoomBounds:e})}},_onKeyDown:function(t){27===t.keyCode&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});He.addInitHook("addHandler","boxZoom",yn),He.mergeOptions({doubleClickZoom:!0});var gn=ti.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(t){var e=this._map,i=e.getZoom(),n=e.options.zoomDelta,s=t.originalEvent.shiftKey?i-n:i+n;"center"===e.options.doubleClickZoom?e.setZoom(s):e.setZoomAround(t.containerPoint,s)}});He.addInitHook("addHandler","doubleClickZoom",gn),He.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var vn=ti.extend({addHooks:function(){if(!this._draggable){var t=this._map;this._draggable=new si(t._mapPane,t._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),t.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),t.on("zoomend",this._onZoomEnd,this),t.whenReady(this._onZoomEnd,this))}ce(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){de(this._map._container,"leaflet-grab"),de(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var t=this._map;if(t._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var e=D(this._map.options.maxBounds);this._offsetLimit=z(this._map.latLngToContainerPoint(e.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(e.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;t.fire("movestart").fire("dragstart"),t.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(t){if(this._map.options.inertia){var e=this._lastTime=+new Date,i=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(i),this._times.push(e),this._prunePositions(e)}this._map.fire("move",t).fire("drag",t)},_prunePositions:function(t){for(;this._positions.length>1&&t-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var t=this._map.getSize().divideBy(2),e=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=e.subtract(t).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(t,e){return t-(t-e)*this._viscosity},_onPreDragLimit:function(){if(this._viscosity&&this._offsetLimit){var t=this._draggable._newPos.subtract(this._draggable._startPos),e=this._offsetLimit;t.x<e.min.x&&(t.x=this._viscousLimit(t.x,e.min.x)),t.y<e.min.y&&(t.y=this._viscousLimit(t.y,e.min.y)),t.x>e.max.x&&(t.x=this._viscousLimit(t.x,e.max.x)),t.y>e.max.y&&(t.y=this._viscousLimit(t.y,e.max.y)),this._draggable._newPos=this._draggable._startPos.add(t)}},_onPreDragWrap:function(){var t=this._worldWidth,e=Math.round(t/2),i=this._initialWorldOffset,n=this._draggable._newPos.x,s=(n-e+i)%t+e-i,r=(n+e+i)%t-e-i,o=Math.abs(s+i)<Math.abs(r+i)?s:r;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=o},_onDragEnd:function(t){var e=this._map,i=e.options,n=!i.inertia||t.noInertia||this._times.length<2;if(e.fire("dragend",t),n)e.fire("moveend");else{this._prunePositions(+new Date);var s=this._lastPos.subtract(this._positions[0]),r=(this._lastTime-this._times[0])/1e3,o=i.easeLinearity,a=s.multiplyBy(o/r),h=a.distanceTo([0,0]),l=Math.min(i.inertiaMaxSpeed,h),u=a.multiplyBy(l/h),c=l/(i.inertiaDeceleration*o),d=u.multiplyBy(-c/2).round();d.x||d.y?(d=e._limitOffset(d,e.options.maxBounds),S((function(){e.panBy(d,{duration:c,easeLinearity:o,noMoveStart:!0,animate:!0})}))):e.fire("moveend")}}});He.addInitHook("addHandler","dragging",vn),He.mergeOptions({keyboard:!0,keyboardPanDelta:80});var bn=ti.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(t){this._map=t,this._setPanDelta(t.options.keyboardPanDelta),this._setZoomDelta(t.options.zoomDelta)},addHooks:function(){var t=this._map._container;t.tabIndex<=0&&(t.tabIndex="0"),Ae(t,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Ce(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var t=document.body,e=document.documentElement,i=t.scrollTop||e.scrollTop,n=t.scrollLeft||e.scrollLeft;this._map._container.focus(),window.scrollTo(n,i)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(t){var e,i,n=this._panKeys={},s=this.keyCodes;for(e=0,i=s.left.length;e<i;e++)n[s.left[e]]=[-1*t,0];for(e=0,i=s.right.length;e<i;e++)n[s.right[e]]=[t,0];for(e=0,i=s.down.length;e<i;e++)n[s.down[e]]=[0,t];for(e=0,i=s.up.length;e<i;e++)n[s.up[e]]=[0,-1*t]},_setZoomDelta:function(t){var e,i,n=this._zoomKeys={},s=this.keyCodes;for(e=0,i=s.zoomIn.length;e<i;e++)n[s.zoomIn[e]]=t;for(e=0,i=s.zoomOut.length;e<i;e++)n[s.zoomOut[e]]=-t},_addHooks:function(){Ae(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Ce(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(t){if(!(t.altKey||t.ctrlKey||t.metaKey)){var e,i=t.keyCode,n=this._map;if(i in this._panKeys){if(!n._panAnim||!n._panAnim._inProgress)if(e=this._panKeys[i],t.shiftKey&&(e=E(e).multiplyBy(3)),n.options.maxBounds&&(e=n._limitOffset(E(e),n.options.maxBounds)),n.options.worldCopyJump){var s=n.wrapLatLng(n.unproject(n.project(n.getCenter()).add(e)));n.panTo(s)}else n.panBy(e)}else if(i in this._zoomKeys)n.setZoom(n.getZoom()+(t.shiftKey?3:1)*this._zoomKeys[i]);else{if(27!==i||!n._popup||!n._popup.options.closeOnEscapeKey)return;n.closePopup()}Re(t)}}});He.addInitHook("addHandler","keyboard",bn),He.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var wn=ti.extend({addHooks:function(){Ae(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Ce(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(t){var e=Ve(t),i=this._map.options.wheelDebounceTime;this._delta+=e,this._lastMousePos=this._map.mouseEventToContainerPoint(t),this._startTime||(this._startTime=+new Date);var s=Math.max(i-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(n(this._performZoom,this),s),Re(t)},_performZoom:function(){var t=this._map,e=t.getZoom(),i=this._map.options.zoomSnap||0;t._stop();var n=this._delta/(4*this._map.options.wheelPxPerZoomLevel),s=4*Math.log(2/(1+Math.exp(-Math.abs(n))))/Math.LN2,r=i?Math.ceil(s/i)*i:s,o=t._limitZoom(e+(this._delta>0?r:-r))-e;this._delta=0,this._startTime=null,o&&("center"===t.options.scrollWheelZoom?t.setZoom(e+o):t.setZoomAround(this._lastMousePos,e+o))}});He.addInitHook("addHandler","scrollWheelZoom",wn);He.mergeOptions({tapHold:Nt.touchNative&&Nt.safari&&Nt.mobile,tapTolerance:15});var xn=ti.extend({addHooks:function(){Ae(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Ce(this._map._container,"touchstart",this._onDown,this)},_onDown:function(t){if(clearTimeout(this._holdTimeout),1===t.touches.length){var e=t.touches[0];this._startPos=this._newPos=new B(e.clientX,e.clientY),this._holdTimeout=setTimeout(n((function(){this._cancel(),this._isTapValid()&&(Ae(document,"touchend",Fe),Ae(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",e))}),this),600),Ae(document,"touchend touchcancel contextmenu",this._cancel,this),Ae(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function t(){Ce(document,"touchend",Fe),Ce(document,"touchend touchcancel",t)},_cancel:function(){clearTimeout(this._holdTimeout),Ce(document,"touchend touchcancel contextmenu",this._cancel,this),Ce(document,"touchmove",this._onMove,this)},_onMove:function(t){var e=t.touches[0];this._newPos=new B(e.clientX,e.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(t,e){var i=new MouseEvent(t,{bubbles:!0,cancelable:!0,view:window,screenX:e.screenX,screenY:e.screenY,clientX:e.clientX,clientY:e.clientY});i._simulated=!0,e.target.dispatchEvent(i)}});He.addInitHook("addHandler","tapHold",xn),He.mergeOptions({touchZoom:Nt.touch,bounceAtZoomLimits:!0});var Mn=ti.extend({addHooks:function(){ce(this._map._container,"leaflet-touch-zoom"),Ae(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){de(this._map._container,"leaflet-touch-zoom"),Ce(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(t){var e=this._map;if(t.touches&&2===t.touches.length&&!e._animatingZoom&&!this._zooming){var i=e.mouseEventToContainerPoint(t.touches[0]),n=e.mouseEventToContainerPoint(t.touches[1]);this._centerPoint=e.getSize()._divideBy(2),this._startLatLng=e.containerPointToLatLng(this._centerPoint),"center"!==e.options.touchZoom&&(this._pinchStartLatLng=e.containerPointToLatLng(i.add(n)._divideBy(2))),this._startDist=i.distanceTo(n),this._startZoom=e.getZoom(),this._moved=!1,this._zooming=!0,e._stop(),Ae(document,"touchmove",this._onTouchMove,this),Ae(document,"touchend touchcancel",this._onTouchEnd,this),Fe(t)}},_onTouchMove:function(t){if(t.touches&&2===t.touches.length&&this._zooming){var e=this._map,i=e.mouseEventToContainerPoint(t.touches[0]),s=e.mouseEventToContainerPoint(t.touches[1]),r=i.distanceTo(s)/this._startDist;if(this._zoom=e.getScaleZoom(r,this._startZoom),!e.options.bounceAtZoomLimits&&(this._zoom<e.getMinZoom()&&r<1||this._zoom>e.getMaxZoom()&&r>1)&&(this._zoom=e._limitZoom(this._zoom)),"center"===e.options.touchZoom){if(this._center=this._startLatLng,1===r)return}else{var o=i._add(s)._divideBy(2)._subtract(this._centerPoint);if(1===r&&0===o.x&&0===o.y)return;this._center=e.unproject(e.project(this._pinchStartLatLng,this._zoom).subtract(o),this._zoom)}this._moved||(e._moveStart(!0,!1),this._moved=!0),I(this._animRequest);var a=n(e._move,e,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=S(a,this,!0),Fe(t)}},_onTouchEnd:function(){this._moved&&this._zooming?(this._zooming=!1,I(this._animRequest),Ce(document,"touchmove",this._onTouchMove,this),Ce(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))):this._zooming=!1}});He.addInitHook("addHandler","touchZoom",Mn),He.BoxZoom=yn,He.DoubleClickZoom=gn,He.Drag=vn,He.Keyboard=bn,He.ScrollWheelZoom=wn,He.TapHold=xn,He.TouchZoom=Mn,t.Bounds=N,t.Browser=Nt,t.CRS=Z,t.Canvas=ln,t.Circle=zi,t.CircleMarker=Ni,t.Class=A,t.Control=$e,t.DivIcon=nn,t.DivOverlay=Qi,t.DomEvent=qe,t.DomUtil=Le,t.Draggable=si,t.Evented=C,t.FeatureGroup=Ai,t.GeoJSON=Fi,t.GridLayer=sn,t.Handler=ti,t.Icon=Pi,t.ImageOverlay=Xi,t.LatLng=F,t.LatLngBounds=k,t.Layer=Ti,t.LayerGroup=Li,t.LineUtil=_i,t.Map=He,t.Marker=Oi,t.Mixin=ii,t.Path=Ei,t.Point=B,t.PolyUtil=vi,t.Polygon=Di,t.Polyline=ki,t.Popup=tn,t.PosAnimation=We,t.Projection=xi,t.Rectangle=_n,t.Renderer=hn,t.SVG=pn,t.SVGOverlay=Ji,t.TileLayer=rn,t.Tooltip=en,t.Transformation=q,t.Util=T,t.VideoOverlay=Ki,t.bind=n,t.bounds=z,t.canvas=un,t.circle=function(t,e,i){return new zi(t,e,i)},t.circleMarker=function(t,e){return new Ni(t,e)},t.control=Ye,t.divIcon=function(t){return new nn(t)},t.extend=e,t.featureGroup=function(t,e){return new Ai(t,e)},t.geoJSON=$i,t.geoJson=Yi,t.gridLayer=function(t){return new sn(t)},t.icon=function(t){return new Pi(t)},t.imageOverlay=function(t,e,i){return new Xi(t,e,i)},t.latLng=R,t.latLngBounds=D,t.layerGroup=function(t,e){return new Li(t,e)},t.map=function(t,e){return new He(t,e)},t.marker=function(t,e){return new Oi(t,e)},t.point=E,t.polygon=function(t,e){return new Di(t,e)},t.polyline=function(t,e){return new ki(t,e)},t.popup=function(t,e){return new tn(t,e)},t.rectangle=function(t,e){return new _n(t,e)},t.setOptions=d,t.stamp=r,t.svg=mn,t.svgOverlay=function(t,e,i){return new Ji(t,e,i)},t.tileLayer=on,t.tooltip=function(t,e){return new en(t,e)},t.transformation=W,t.version="1.9.3",t.videoOverlay=function(t,e,i){return new Ki(t,e,i)};var Sn=window.L;t.noConflict=function(){return window.L=Sn,this},window.L=t}(e)}},e={};function i(n){var s=e[n];if(void 0!==s)return s.exports;var r=e[n]={exports:{}};return t[n].call(r.exports,r,r.exports,i),r.exports}(()=>{"use strict";function t(){}function e(e){return null==e?t:function(){return this.querySelector(e)}}function n(){return[]}function s(t){return null==t?n:function(){return this.querySelectorAll(t)}}function r(t){return function(){return this.matches(t)}}function o(t){return function(e){return e.matches(t)}}var a=Array.prototype.find;function h(){return this.firstElementChild}var l=Array.prototype.filter;function u(){return Array.from(this.children)}function c(t){return new Array(t.length)}function d(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function f(t,e,i,n,s,r){for(var o,a=0,h=e.length,l=r.length;a<l;++a)(o=e[a])?(o.__data__=r[a],n[a]=o):i[a]=new d(t,r[a]);for(;a<h;++a)(o=e[a])&&(s[a]=o)}function p(t,e,i,n,s,r,o){var a,h,l,u=new Map,c=e.length,f=r.length,p=new Array(c);for(a=0;a<c;++a)(h=e[a])&&(p[a]=l=o.call(h,h.__data__,a,e)+"",u.has(l)?s[a]=h:u.set(l,h));for(a=0;a<f;++a)l=o.call(t,r[a],a,r)+"",(h=u.get(l))?(n[a]=h,h.__data__=r[a],u.delete(l)):i[a]=new d(t,r[a]);for(a=0;a<c;++a)(h=e[a])&&u.get(p[a])===h&&(s[a]=h)}function m(t){return t.__data__}function _(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function y(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}d.prototype={constructor:d,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var g="http://www.w3.org/1999/xhtml";const v={svg:"http://www.w3.org/2000/svg",xhtml:g,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function b(t){var e=t+="",i=e.indexOf(":");return i>=0&&"xmlns"!==(e=t.slice(0,i))&&(t=t.slice(i+1)),v.hasOwnProperty(e)?{space:v[e],local:t}:t}function w(t){return function(){this.removeAttribute(t)}}function x(t){return function(){this.removeAttributeNS(t.space,t.local)}}function M(t,e){return function(){this.setAttribute(t,e)}}function S(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function I(t,e){return function(){var i=e.apply(this,arguments);null==i?this.removeAttribute(t):this.setAttribute(t,i)}}function T(t,e){return function(){var i=e.apply(this,arguments);null==i?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,i)}}function A(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function P(t){return function(){this.style.removeProperty(t)}}function C(t,e,i){return function(){this.style.setProperty(t,e,i)}}function B(t,e,i){return function(){var n=e.apply(this,arguments);null==n?this.style.removeProperty(t):this.style.setProperty(t,n,i)}}function O(t,e){return t.style.getPropertyValue(e)||A(t).getComputedStyle(t,null).getPropertyValue(e)}function E(t){return function(){delete this[t]}}function N(t,e){return function(){this[t]=e}}function z(t,e){return function(){var i=e.apply(this,arguments);null==i?delete this[t]:this[t]=i}}function k(t){return t.trim().split(/^|\s+/)}function D(t){return t.classList||new F(t)}function F(t){this._node=t,this._names=k(t.getAttribute("class")||"")}function R(t,e){for(var i=D(t),n=-1,s=e.length;++n<s;)i.add(e[n])}function U(t,e){for(var i=D(t),n=-1,s=e.length;++n<s;)i.remove(e[n])}function Z(t){return function(){R(this,t)}}function j(t){return function(){U(this,t)}}function V(t,e){return function(){(e.apply(this,arguments)?R:U)(this,t)}}function G(){this.textContent=""}function q(t){return function(){this.textContent=t}}function W(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function H(){this.innerHTML=""}function $(t){return function(){this.innerHTML=t}}function Y(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function X(){this.nextSibling&&this.parentNode.appendChild(this)}function K(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function J(t){return function(){var e=this.ownerDocument,i=this.namespaceURI;return i===g&&e.documentElement.namespaceURI===g?e.createElement(t):e.createElementNS(i,t)}}function Q(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function tt(t){var e=b(t);return(e.local?Q:J)(e)}function et(){return null}function it(){var t=this.parentNode;t&&t.removeChild(this)}function nt(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function st(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function rt(t){return function(){var e=this.__on;if(e){for(var i,n=0,s=-1,r=e.length;n<r;++n)i=e[n],t.type&&i.type!==t.type||i.name!==t.name?e[++s]=i:this.removeEventListener(i.type,i.listener,i.options);++s?e.length=s:delete this.__on}}}function ot(t,e,i){return function(){var n,s=this.__on,r=function(t){return function(e){t.call(this,e,this.__data__)}}(e);if(s)for(var o=0,a=s.length;o<a;++o)if((n=s[o]).type===t.type&&n.name===t.name)return this.removeEventListener(n.type,n.listener,n.options),this.addEventListener(n.type,n.listener=r,n.options=i),void(n.value=e);this.addEventListener(t.type,r,i),n={type:t.type,name:t.name,value:e,listener:r,options:i},s?s.push(n):this.__on=[n]}}function at(t,e,i){var n=A(t),s=n.CustomEvent;"function"==typeof s?s=new s(e,i):(s=n.document.createEvent("Event"),i?(s.initEvent(e,i.bubbles,i.cancelable),s.detail=i.detail):s.initEvent(e,!1,!1)),t.dispatchEvent(s)}function ht(t,e){return function(){return at(this,t,e)}}function lt(t,e){return function(){return at(this,t,e.apply(this,arguments))}}F.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var ut=[null];function ct(t,e){this._groups=t,this._parents=e}function dt(){return new ct([[document.documentElement]],ut)}ct.prototype=dt.prototype={constructor:ct,select:function(t){"function"!=typeof t&&(t=e(t));for(var i=this._groups,n=i.length,s=new Array(n),r=0;r<n;++r)for(var o,a,h=i[r],l=h.length,u=s[r]=new Array(l),c=0;c<l;++c)(o=h[c])&&(a=t.call(o,o.__data__,c,h))&&("__data__"in o&&(a.__data__=o.__data__),u[c]=a);return new ct(s,this._parents)},selectAll:function(t){t="function"==typeof t?function(t){return function(){return null==(e=t.apply(this,arguments))?[]:Array.isArray(e)?e:Array.from(e);var e}}(t):s(t);for(var e=this._groups,i=e.length,n=[],r=[],o=0;o<i;++o)for(var a,h=e[o],l=h.length,u=0;u<l;++u)(a=h[u])&&(n.push(t.call(a,a.__data__,u,h)),r.push(a));return new ct(n,r)},selectChild:function(t){return this.select(null==t?h:function(t){return function(){return a.call(this.children,t)}}("function"==typeof t?t:o(t)))},selectChildren:function(t){return this.selectAll(null==t?u:function(t){return function(){return l.call(this.children,t)}}("function"==typeof t?t:o(t)))},filter:function(t){"function"!=typeof t&&(t=r(t));for(var e=this._groups,i=e.length,n=new Array(i),s=0;s<i;++s)for(var o,a=e[s],h=a.length,l=n[s]=[],u=0;u<h;++u)(o=a[u])&&t.call(o,o.__data__,u,a)&&l.push(o);return new ct(n,this._parents)},data:function(t,e){if(!arguments.length)return Array.from(this,m);var i,n=e?p:f,s=this._parents,r=this._groups;"function"!=typeof t&&(i=t,t=function(){return i});for(var o=r.length,a=new Array(o),h=new Array(o),l=new Array(o),u=0;u<o;++u){var c=s[u],d=r[u],y=d.length,g=_(t.call(c,c&&c.__data__,u,s)),v=g.length,b=h[u]=new Array(v),w=a[u]=new Array(v);n(c,d,b,w,l[u]=new Array(y),g,e);for(var x,M,S=0,I=0;S<v;++S)if(x=b[S]){for(S>=I&&(I=S+1);!(M=w[I])&&++I<v;);x._next=M||null}}return(a=new ct(a,s))._enter=h,a._exit=l,a},enter:function(){return new ct(this._enter||this._groups.map(c),this._parents)},exit:function(){return new ct(this._exit||this._groups.map(c),this._parents)},join:function(t,e,i){var n=this.enter(),s=this,r=this.exit();return"function"==typeof t?(n=t(n))&&(n=n.selection()):n=n.append(t+""),null!=e&&(s=e(s))&&(s=s.selection()),null==i?r.remove():i(r),n&&s?n.merge(s).order():s},merge:function(t){for(var e=t.selection?t.selection():t,i=this._groups,n=e._groups,s=i.length,r=n.length,o=Math.min(s,r),a=new Array(s),h=0;h<o;++h)for(var l,u=i[h],c=n[h],d=u.length,f=a[h]=new Array(d),p=0;p<d;++p)(l=u[p]||c[p])&&(f[p]=l);for(;h<s;++h)a[h]=i[h];return new ct(a,this._parents)},selection:function(){return this},order:function(){for(var t=this._groups,e=-1,i=t.length;++e<i;)for(var n,s=t[e],r=s.length-1,o=s[r];--r>=0;)(n=s[r])&&(o&&4^n.compareDocumentPosition(o)&&o.parentNode.insertBefore(n,o),o=n);return this},sort:function(t){function e(e,i){return e&&i?t(e.__data__,i.__data__):!e-!i}t||(t=y);for(var i=this._groups,n=i.length,s=new Array(n),r=0;r<n;++r){for(var o,a=i[r],h=a.length,l=s[r]=new Array(h),u=0;u<h;++u)(o=a[u])&&(l[u]=o);l.sort(e)}return new ct(s,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var t=this._groups,e=0,i=t.length;e<i;++e)for(var n=t[e],s=0,r=n.length;s<r;++s){var o=n[s];if(o)return o}return null},size:function(){let t=0;for(const e of this)++t;return t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,i=0,n=e.length;i<n;++i)for(var s,r=e[i],o=0,a=r.length;o<a;++o)(s=r[o])&&t.call(s,s.__data__,o,r);return this},attr:function(t,e){var i=b(t);if(arguments.length<2){var n=this.node();return i.local?n.getAttributeNS(i.space,i.local):n.getAttribute(i)}return this.each((null==e?i.local?x:w:"function"==typeof e?i.local?T:I:i.local?S:M)(i,e))},style:function(t,e,i){return arguments.length>1?this.each((null==e?P:"function"==typeof e?B:C)(t,e,null==i?"":i)):O(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?E:"function"==typeof e?z:N)(t,e)):this.node()[t]},classed:function(t,e){var i=k(t+"");if(arguments.length<2){for(var n=D(this.node()),s=-1,r=i.length;++s<r;)if(!n.contains(i[s]))return!1;return!0}return this.each(("function"==typeof e?V:e?Z:j)(i,e))},text:function(t){return arguments.length?this.each(null==t?G:("function"==typeof t?W:q)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?H:("function"==typeof t?Y:$)(t)):this.node().innerHTML},raise:function(){return this.each(X)},lower:function(){return this.each(K)},append:function(t){var e="function"==typeof t?t:tt(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))},insert:function(t,i){var n="function"==typeof t?t:tt(t),s=null==i?et:"function"==typeof i?i:e(i);return this.select((function(){return this.insertBefore(n.apply(this,arguments),s.apply(this,arguments)||null)}))},remove:function(){return this.each(it)},clone:function(t){return this.select(t?st:nt)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,i){var n,s,r=function(t){return t.trim().split(/^|\s+/).map((function(t){var e="",i=t.indexOf(".");return i>=0&&(e=t.slice(i+1),t=t.slice(0,i)),{type:t,name:e}}))}(t+""),o=r.length;if(!(arguments.length<2)){for(a=e?ot:rt,n=0;n<o;++n)this.each(a(r[n],e,i));return this}var a=this.node().__on;if(a)for(var h,l=0,u=a.length;l<u;++l)for(n=0,h=a[l];n<o;++n)if((s=r[n]).type===h.type&&s.name===h.name)return h.value},dispatch:function(t,e){return this.each(("function"==typeof e?lt:ht)(t,e))},[Symbol.iterator]:function*(){for(var t=this._groups,e=0,i=t.length;e<i;++e)for(var n,s=t[e],r=0,o=s.length;r<o;++r)(n=s[r])&&(yield n)}};const ft=dt;function pt(t){return"string"==typeof t?new ct([[document.querySelector(t)]],[document.documentElement]):new ct([[t]],ut)}var mt={value:()=>{}};function _t(){for(var t,e=0,i=arguments.length,n={};e<i;++e){if(!(t=arguments[e]+"")||t in n||/[\s.]/.test(t))throw new Error("illegal type: "+t);n[t]=[]}return new yt(n)}function yt(t){this._=t}function gt(t,e){for(var i,n=0,s=t.length;n<s;++n)if((i=t[n]).name===e)return i.value}function vt(t,e,i){for(var n=0,s=t.length;n<s;++n)if(t[n].name===e){t[n]=mt,t=t.slice(0,n).concat(t.slice(n+1));break}return null!=i&&t.push({name:e,value:i}),t}yt.prototype=_t.prototype={constructor:yt,on:function(t,e){var i,n,s=this._,r=(n=s,(t+"").trim().split(/^|\s+/).map((function(t){var e="",i=t.indexOf(".");if(i>=0&&(e=t.slice(i+1),t=t.slice(0,i)),t&&!n.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:e}}))),o=-1,a=r.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++o<a;)if(i=(t=r[o]).type)s[i]=vt(s[i],t.name,e);else if(null==e)for(i in s)s[i]=vt(s[i],t.name,null);return this}for(;++o<a;)if((i=(t=r[o]).type)&&(i=gt(s[i],t.name)))return i},copy:function(){var t={},e=this._;for(var i in e)t[i]=e[i].slice();return new yt(t)},call:function(t,e){if((i=arguments.length-2)>0)for(var i,n,s=new Array(i),r=0;r<i;++r)s[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(r=0,i=(n=this._[t]).length;r<i;++r)n[r].value.apply(e,s)},apply:function(t,e,i){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var n=this._[t],s=0,r=n.length;s<r;++s)n[s].value.apply(e,i)}};const bt=_t,wt={capture:!0,passive:!1};function xt(t){t.preventDefault(),t.stopImmediatePropagation()}function Mt(t){return((t=Math.exp(t))+1/t)/2}const St=function t(e,i,n){function s(t,s){var r,o,a=t[0],h=t[1],l=t[2],u=s[0],c=s[1],d=s[2],f=u-a,p=c-h,m=f*f+p*p;if(m<1e-12)o=Math.log(d/l)/e,r=function(t){return[a+t*f,h+t*p,l*Math.exp(e*t*o)]};else{var _=Math.sqrt(m),y=(d*d-l*l+n*m)/(2*l*i*_),g=(d*d-l*l-n*m)/(2*d*i*_),v=Math.log(Math.sqrt(y*y+1)-y),b=Math.log(Math.sqrt(g*g+1)-g);o=(b-v)/e,r=function(t){var n,s=t*o,r=Mt(v),u=l/(i*_)*(r*(n=e*s+v,((n=Math.exp(2*n))-1)/(n+1))-function(t){return((t=Math.exp(t))-1/t)/2}(v));return[a+u*f,h+u*p,l*r/Mt(e*s+v)]}}return r.duration=1e3*o*e/Math.SQRT2,r}return s.rho=function(e){var i=Math.max(.001,+e),n=i*i;return t(i,n,n*n)},s}(Math.SQRT2,2,4);function It(t,e){if(t=function(t){let e;for(;e=t.sourceEvent;)t=e;return t}(t),void 0===e&&(e=t.currentTarget),e){var i=e.ownerSVGElement||e;if(i.createSVGPoint){var n=i.createSVGPoint();return n.x=t.clientX,n.y=t.clientY,[(n=n.matrixTransform(e.getScreenCTM().inverse())).x,n.y]}if(e.getBoundingClientRect){var s=e.getBoundingClientRect();return[t.clientX-s.left-e.clientLeft,t.clientY-s.top-e.clientTop]}}return[t.pageX,t.pageY]}var Tt,Lt,At=0,Pt=0,Ct=0,Bt=1e3,Ot=0,Et=0,Nt=0,zt="object"==typeof performance&&performance.now?performance:Date,kt="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Dt(){return Et||(kt(Ft),Et=zt.now()+Nt)}function Ft(){Et=0}function Rt(){this._call=this._time=this._next=null}function Ut(t,e,i){var n=new Rt;return n.restart(t,e,i),n}function Zt(){Et=(Ot=zt.now())+Nt,At=Pt=0;try{!function(){Dt(),++At;for(var t,e=Tt;e;)(t=Et-e._time)>=0&&e._call.call(void 0,t),e=e._next;--At}()}finally{At=0,function(){for(var t,e,i=Tt,n=1/0;i;)i._call?(n>i._time&&(n=i._time),t=i,i=i._next):(e=i._next,i._next=null,i=t?t._next=e:Tt=e);Lt=t,Vt(n)}(),Et=0}}function jt(){var t=zt.now(),e=t-Ot;e>Bt&&(Nt-=e,Ot=t)}function Vt(t){At||(Pt&&(Pt=clearTimeout(Pt)),t-Et>24?(t<1/0&&(Pt=setTimeout(Zt,t-zt.now()-Nt)),Ct&&(Ct=clearInterval(Ct))):(Ct||(Ot=zt.now(),Ct=setInterval(jt,Bt)),At=1,kt(Zt)))}function Gt(t,e,i){var n=new Rt;return e=null==e?0:+e,n.restart((i=>{n.stop(),t(i+e)}),e,i),n}Rt.prototype=Ut.prototype={constructor:Rt,restart:function(t,e,i){if("function"!=typeof t)throw new TypeError("callback is not a function");i=(null==i?Dt():+i)+(null==e?0:+e),this._next||Lt===this||(Lt?Lt._next=this:Tt=this,Lt=this),this._call=t,this._time=i,Vt()},stop:function(){this._call&&(this._call=null,this._time=1/0,Vt())}};var qt=bt("start","end","cancel","interrupt"),Wt=[],Ht=0,$t=2,Yt=3,Xt=5,Kt=6;function Jt(t,e,i,n,s,r){var o=t.__transition;if(o){if(i in o)return}else t.__transition={};!function(t,e,i){var n,s=t.__transition;function r(h){var l,u,c,d;if(1!==i.state)return a();for(l in s)if((d=s[l]).name===i.name){if(d.state===Yt)return Gt(r);4===d.state?(d.state=Kt,d.timer.stop(),d.on.call("interrupt",t,t.__data__,d.index,d.group),delete s[l]):+l<e&&(d.state=Kt,d.timer.stop(),d.on.call("cancel",t,t.__data__,d.index,d.group),delete s[l])}if(Gt((function(){i.state===Yt&&(i.state=4,i.timer.restart(o,i.delay,i.time),o(h))})),i.state=$t,i.on.call("start",t,t.__data__,i.index,i.group),i.state===$t){for(i.state=Yt,n=new Array(c=i.tween.length),l=0,u=-1;l<c;++l)(d=i.tween[l].value.call(t,t.__data__,i.index,i.group))&&(n[++u]=d);n.length=u+1}}function o(e){for(var s=e<i.duration?i.ease.call(null,e/i.duration):(i.timer.restart(a),i.state=Xt,1),r=-1,o=n.length;++r<o;)n[r].call(t,s);i.state===Xt&&(i.on.call("end",t,t.__data__,i.index,i.group),a())}function a(){for(var n in i.state=Kt,i.timer.stop(),delete s[e],s)return;delete t.__transition}s[e]=i,i.timer=Ut((function(t){i.state=1,i.timer.restart(r,i.delay,i.time),i.delay<=t&&r(t-i.delay)}),0,i.time)}(t,i,{name:e,index:n,group:s,on:qt,tween:Wt,time:r.time,delay:r.delay,duration:r.duration,ease:r.ease,timer:null,state:Ht})}function Qt(t,e){var i=ee(t,e);if(i.state>Ht)throw new Error("too late; already scheduled");return i}function te(t,e){var i=ee(t,e);if(i.state>Yt)throw new Error("too late; already running");return i}function ee(t,e){var i=t.__transition;if(!i||!(i=i[e]))throw new Error("transition not found");return i}function ie(t,e){var i,n,s,r=t.__transition,o=!0;if(r){for(s in e=null==e?null:e+"",r)(i=r[s]).name===e?(n=i.state>$t&&i.state<Xt,i.state=Kt,i.timer.stop(),i.on.call(n?"interrupt":"cancel",t,t.__data__,i.index,i.group),delete r[s]):o=!1;o&&delete t.__transition}}function ne(t,e){return t=+t,e=+e,function(i){return t*(1-i)+e*i}}var se,re=180/Math.PI,oe={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function ae(t,e,i,n,s,r){var o,a,h;return(o=Math.sqrt(t*t+e*e))&&(t/=o,e/=o),(h=t*i+e*n)&&(i-=t*h,n-=e*h),(a=Math.sqrt(i*i+n*n))&&(i/=a,n/=a,h/=a),t*n<e*i&&(t=-t,e=-e,h=-h,o=-o),{translateX:s,translateY:r,rotate:Math.atan2(e,t)*re,skewX:Math.atan(h)*re,scaleX:o,scaleY:a}}function he(t,e,i,n){function s(t){return t.length?t.pop()+" ":""}return function(r,o){var a=[],h=[];return r=t(r),o=t(o),function(t,n,s,r,o,a){if(t!==s||n!==r){var h=o.push("translate(",null,e,null,i);a.push({i:h-4,x:ne(t,s)},{i:h-2,x:ne(n,r)})}else(s||r)&&o.push("translate("+s+e+r+i)}(r.translateX,r.translateY,o.translateX,o.translateY,a,h),function(t,e,i,r){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),r.push({i:i.push(s(i)+"rotate(",null,n)-2,x:ne(t,e)})):e&&i.push(s(i)+"rotate("+e+n)}(r.rotate,o.rotate,a,h),function(t,e,i,r){t!==e?r.push({i:i.push(s(i)+"skewX(",null,n)-2,x:ne(t,e)}):e&&i.push(s(i)+"skewX("+e+n)}(r.skewX,o.skewX,a,h),function(t,e,i,n,r,o){if(t!==i||e!==n){var a=r.push(s(r)+"scale(",null,",",null,")");o.push({i:a-4,x:ne(t,i)},{i:a-2,x:ne(e,n)})}else 1===i&&1===n||r.push(s(r)+"scale("+i+","+n+")")}(r.scaleX,r.scaleY,o.scaleX,o.scaleY,a,h),r=o=null,function(t){for(var e,i=-1,n=h.length;++i<n;)a[(e=h[i]).i]=e.x(t);return a.join("")}}}var le=he((function(t){const e=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?oe:ae(e.a,e.b,e.c,e.d,e.e,e.f)}),"px, ","px)","deg)"),ue=he((function(t){return null==t?oe:(se||(se=document.createElementNS("http://www.w3.org/2000/svg","g")),se.setAttribute("transform",t),(t=se.transform.baseVal.consolidate())?ae((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):oe)}),", ",")",")");function ce(t,e){var i,n;return function(){var s=te(this,t),r=s.tween;if(r!==i)for(var o=0,a=(n=i=r).length;o<a;++o)if(n[o].name===e){(n=n.slice()).splice(o,1);break}s.tween=n}}function de(t,e,i){var n,s;if("function"!=typeof i)throw new Error;return function(){var r=te(this,t),o=r.tween;if(o!==n){s=(n=o).slice();for(var a={name:e,value:i},h=0,l=s.length;h<l;++h)if(s[h].name===e){s[h]=a;break}h===l&&s.push(a)}r.tween=s}}function fe(t,e,i){var n=t._id;return t.each((function(){var t=te(this,n);(t.value||(t.value={}))[e]=i.apply(this,arguments)})),function(t){return ee(t,n).value[e]}}function pe(t,e,i){t.prototype=e.prototype=i,i.constructor=t}function me(t,e){var i=Object.create(t.prototype);for(var n in e)i[n]=e[n];return i}function _e(){}var ye=.7,ge=1/ye,ve="\\s*([+-]?\\d+)\\s*",be="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",we="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",xe=/^#([0-9a-f]{3,8})$/,Me=new RegExp(`^rgb\\(${ve},${ve},${ve}\\)$`),Se=new RegExp(`^rgb\\(${we},${we},${we}\\)$`),Ie=new RegExp(`^rgba\\(${ve},${ve},${ve},${be}\\)$`),Te=new RegExp(`^rgba\\(${we},${we},${we},${be}\\)$`),Le=new RegExp(`^hsl\\(${be},${we},${we}\\)$`),Ae=new RegExp(`^hsla\\(${be},${we},${we},${be}\\)$`),Pe={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Ce(){return this.rgb().formatHex()}function Be(){return this.rgb().formatRgb()}function Oe(t){var e,i;return t=(t+"").trim().toLowerCase(),(e=xe.exec(t))?(i=e[1].length,e=parseInt(e[1],16),6===i?Ee(e):3===i?new ke(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===i?Ne(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===i?Ne(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=Me.exec(t))?new ke(e[1],e[2],e[3],1):(e=Se.exec(t))?new ke(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=Ie.exec(t))?Ne(e[1],e[2],e[3],e[4]):(e=Te.exec(t))?Ne(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=Le.exec(t))?je(e[1],e[2]/100,e[3]/100,1):(e=Ae.exec(t))?je(e[1],e[2]/100,e[3]/100,e[4]):Pe.hasOwnProperty(t)?Ee(Pe[t]):"transparent"===t?new ke(NaN,NaN,NaN,0):null}function Ee(t){return new ke(t>>16&255,t>>8&255,255&t,1)}function Ne(t,e,i,n){return n<=0&&(t=e=i=NaN),new ke(t,e,i,n)}function ze(t,e,i,n){return 1===arguments.length?((s=t)instanceof _e||(s=Oe(s)),s?new ke((s=s.rgb()).r,s.g,s.b,s.opacity):new ke):new ke(t,e,i,null==n?1:n);var s}function ke(t,e,i,n){this.r=+t,this.g=+e,this.b=+i,this.opacity=+n}function De(){return`#${Ze(this.r)}${Ze(this.g)}${Ze(this.b)}`}function Fe(){const t=Re(this.opacity);return`${1===t?"rgb(":"rgba("}${Ue(this.r)}, ${Ue(this.g)}, ${Ue(this.b)}${1===t?")":`, ${t})`}`}function Re(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Ue(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Ze(t){return((t=Ue(t))<16?"0":"")+t.toString(16)}function je(t,e,i,n){return n<=0?t=e=i=NaN:i<=0||i>=1?t=e=NaN:e<=0&&(t=NaN),new Ge(t,e,i,n)}function Ve(t){if(t instanceof Ge)return new Ge(t.h,t.s,t.l,t.opacity);if(t instanceof _e||(t=Oe(t)),!t)return new Ge;if(t instanceof Ge)return t;var e=(t=t.rgb()).r/255,i=t.g/255,n=t.b/255,s=Math.min(e,i,n),r=Math.max(e,i,n),o=NaN,a=r-s,h=(r+s)/2;return a?(o=e===r?(i-n)/a+6*(i<n):i===r?(n-e)/a+2:(e-i)/a+4,a/=h<.5?r+s:2-r-s,o*=60):a=h>0&&h<1?0:o,new Ge(o,a,h,t.opacity)}function Ge(t,e,i,n){this.h=+t,this.s=+e,this.l=+i,this.opacity=+n}function qe(t){return(t=(t||0)%360)<0?t+360:t}function We(t){return Math.max(0,Math.min(1,t||0))}function He(t,e,i){return 255*(t<60?e+(i-e)*t/60:t<180?i:t<240?e+(i-e)*(240-t)/60:e)}function $e(t,e,i,n,s){var r=t*t,o=r*t;return((1-3*t+3*r-o)*e+(4-6*r+3*o)*i+(1+3*t+3*r-3*o)*n+o*s)/6}pe(_e,Oe,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Ce,formatHex:Ce,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return Ve(this).formatHsl()},formatRgb:Be,toString:Be}),pe(ke,ze,me(_e,{brighter(t){return t=null==t?ge:Math.pow(ge,t),new ke(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?ye:Math.pow(ye,t),new ke(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new ke(Ue(this.r),Ue(this.g),Ue(this.b),Re(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:De,formatHex:De,formatHex8:function(){return`#${Ze(this.r)}${Ze(this.g)}${Ze(this.b)}${Ze(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:Fe,toString:Fe})),pe(Ge,(function(t,e,i,n){return 1===arguments.length?Ve(t):new Ge(t,e,i,null==n?1:n)}),me(_e,{brighter(t){return t=null==t?ge:Math.pow(ge,t),new Ge(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?ye:Math.pow(ye,t),new Ge(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,i=this.l,n=i+(i<.5?i:1-i)*e,s=2*i-n;return new ke(He(t>=240?t-240:t+120,s,n),He(t,s,n),He(t<120?t+240:t-120,s,n),this.opacity)},clamp(){return new Ge(qe(this.h),We(this.s),We(this.l),Re(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Re(this.opacity);return`${1===t?"hsl(":"hsla("}${qe(this.h)}, ${100*We(this.s)}%, ${100*We(this.l)}%${1===t?")":`, ${t})`}`}}));const Ye=t=>()=>t;function Xe(t,e){var i=e-t;return i?function(t,e){return function(i){return t+i*e}}(t,i):Ye(isNaN(t)?e:t)}const Ke=function t(e){var i=function(t){return 1==(t=+t)?Xe:function(e,i){return i-e?function(t,e,i){return t=Math.pow(t,i),e=Math.pow(e,i)-t,i=1/i,function(n){return Math.pow(t+n*e,i)}}(e,i,t):Ye(isNaN(e)?i:e)}}(e);function n(t,e){var n=i((t=ze(t)).r,(e=ze(e)).r),s=i(t.g,e.g),r=i(t.b,e.b),o=Xe(t.opacity,e.opacity);return function(e){return t.r=n(e),t.g=s(e),t.b=r(e),t.opacity=o(e),t+""}}return n.gamma=t,n}(1);function Je(t){return function(e){var i,n,s=e.length,r=new Array(s),o=new Array(s),a=new Array(s);for(i=0;i<s;++i)n=ze(e[i]),r[i]=n.r||0,o[i]=n.g||0,a[i]=n.b||0;return r=t(r),o=t(o),a=t(a),n.opacity=1,function(t){return n.r=r(t),n.g=o(t),n.b=a(t),n+""}}}Je((function(t){var e=t.length-1;return function(i){var n=i<=0?i=0:i>=1?(i=1,e-1):Math.floor(i*e),s=t[n],r=t[n+1],o=n>0?t[n-1]:2*s-r,a=n<e-1?t[n+2]:2*r-s;return $e((i-n/e)*e,o,s,r,a)}})),Je((function(t){var e=t.length;return function(i){var n=Math.floor(((i%=1)<0?++i:i)*e),s=t[(n+e-1)%e],r=t[n%e],o=t[(n+1)%e],a=t[(n+2)%e];return $e((i-n/e)*e,s,r,o,a)}}));var Qe=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ti=new RegExp(Qe.source,"g");function ei(t,e){var i,n,s,r=Qe.lastIndex=ti.lastIndex=0,o=-1,a=[],h=[];for(t+="",e+="";(i=Qe.exec(t))&&(n=ti.exec(e));)(s=n.index)>r&&(s=e.slice(r,s),a[o]?a[o]+=s:a[++o]=s),(i=i[0])===(n=n[0])?a[o]?a[o]+=n:a[++o]=n:(a[++o]=null,h.push({i:o,x:ne(i,n)})),r=ti.lastIndex;return r<e.length&&(s=e.slice(r),a[o]?a[o]+=s:a[++o]=s),a.length<2?h[0]?function(t){return function(e){return t(e)+""}}(h[0].x):function(t){return function(){return t}}(e):(e=h.length,function(t){for(var i,n=0;n<e;++n)a[(i=h[n]).i]=i.x(t);return a.join("")})}function ii(t,e){var i;return("number"==typeof e?ne:e instanceof Oe?Ke:(i=Oe(e))?(e=i,Ke):ei)(t,e)}function ni(t){return function(){this.removeAttribute(t)}}function si(t){return function(){this.removeAttributeNS(t.space,t.local)}}function ri(t,e,i){var n,s,r=i+"";return function(){var o=this.getAttribute(t);return o===r?null:o===n?s:s=e(n=o,i)}}function oi(t,e,i){var n,s,r=i+"";return function(){var o=this.getAttributeNS(t.space,t.local);return o===r?null:o===n?s:s=e(n=o,i)}}function ai(t,e,i){var n,s,r;return function(){var o,a,h=i(this);if(null!=h)return(o=this.getAttribute(t))===(a=h+"")?null:o===n&&a===s?r:(s=a,r=e(n=o,h));this.removeAttribute(t)}}function hi(t,e,i){var n,s,r;return function(){var o,a,h=i(this);if(null!=h)return(o=this.getAttributeNS(t.space,t.local))===(a=h+"")?null:o===n&&a===s?r:(s=a,r=e(n=o,h));this.removeAttributeNS(t.space,t.local)}}function li(t,e){var i,n;function s(){var s=e.apply(this,arguments);return s!==n&&(i=(n=s)&&function(t,e){return function(i){this.setAttributeNS(t.space,t.local,e.call(this,i))}}(t,s)),i}return s._value=e,s}function ui(t,e){var i,n;function s(){var s=e.apply(this,arguments);return s!==n&&(i=(n=s)&&function(t,e){return function(i){this.setAttribute(t,e.call(this,i))}}(t,s)),i}return s._value=e,s}function ci(t,e){return function(){Qt(this,t).delay=+e.apply(this,arguments)}}function di(t,e){return e=+e,function(){Qt(this,t).delay=e}}function fi(t,e){return function(){te(this,t).duration=+e.apply(this,arguments)}}function pi(t,e){return e=+e,function(){te(this,t).duration=e}}var mi=ft.prototype.constructor;function _i(t){return function(){this.style.removeProperty(t)}}var yi=0;function gi(t,e,i,n){this._groups=t,this._parents=e,this._name=i,this._id=n}function vi(){return++yi}var bi=ft.prototype;gi.prototype=function(t){return ft().transition(t)}.prototype={constructor:gi,select:function(t){var i=this._name,n=this._id;"function"!=typeof t&&(t=e(t));for(var s=this._groups,r=s.length,o=new Array(r),a=0;a<r;++a)for(var h,l,u=s[a],c=u.length,d=o[a]=new Array(c),f=0;f<c;++f)(h=u[f])&&(l=t.call(h,h.__data__,f,u))&&("__data__"in h&&(l.__data__=h.__data__),d[f]=l,Jt(d[f],i,n,f,d,ee(h,n)));return new gi(o,this._parents,i,n)},selectAll:function(t){var e=this._name,i=this._id;"function"!=typeof t&&(t=s(t));for(var n=this._groups,r=n.length,o=[],a=[],h=0;h<r;++h)for(var l,u=n[h],c=u.length,d=0;d<c;++d)if(l=u[d]){for(var f,p=t.call(l,l.__data__,d,u),m=ee(l,i),_=0,y=p.length;_<y;++_)(f=p[_])&&Jt(f,e,i,_,p,m);o.push(p),a.push(l)}return new gi(o,a,e,i)},selectChild:bi.selectChild,selectChildren:bi.selectChildren,filter:function(t){"function"!=typeof t&&(t=r(t));for(var e=this._groups,i=e.length,n=new Array(i),s=0;s<i;++s)for(var o,a=e[s],h=a.length,l=n[s]=[],u=0;u<h;++u)(o=a[u])&&t.call(o,o.__data__,u,a)&&l.push(o);return new gi(n,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,i=t._groups,n=e.length,s=i.length,r=Math.min(n,s),o=new Array(n),a=0;a<r;++a)for(var h,l=e[a],u=i[a],c=l.length,d=o[a]=new Array(c),f=0;f<c;++f)(h=l[f]||u[f])&&(d[f]=h);for(;a<n;++a)o[a]=e[a];return new gi(o,this._parents,this._name,this._id)},selection:function(){return new mi(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,i=vi(),n=this._groups,s=n.length,r=0;r<s;++r)for(var o,a=n[r],h=a.length,l=0;l<h;++l)if(o=a[l]){var u=ee(o,e);Jt(o,t,i,l,a,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new gi(n,this._parents,t,i)},call:bi.call,nodes:bi.nodes,node:bi.node,size:bi.size,empty:bi.empty,each:bi.each,on:function(t,e){var i=this._id;return arguments.length<2?ee(this.node(),i).on.on(t):this.each(function(t,e,i){var n,s,r=function(t){return(t+"").trim().split(/^|\s+/).every((function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t}))}(e)?Qt:te;return function(){var o=r(this,t),a=o.on;a!==n&&(s=(n=a).copy()).on(e,i),o.on=s}}(i,t,e))},attr:function(t,e){var i=b(t),n="transform"===i?ue:ii;return this.attrTween(t,"function"==typeof e?(i.local?hi:ai)(i,n,fe(this,"attr."+t,e)):null==e?(i.local?si:ni)(i):(i.local?oi:ri)(i,n,e))},attrTween:function(t,e){var i="attr."+t;if(arguments.length<2)return(i=this.tween(i))&&i._value;if(null==e)return this.tween(i,null);if("function"!=typeof e)throw new Error;var n=b(t);return this.tween(i,(n.local?li:ui)(n,e))},style:function(t,e,i){var n="transform"==(t+="")?le:ii;return null==e?this.styleTween(t,function(t,e){var i,n,s;return function(){var r=O(this,t),o=(this.style.removeProperty(t),O(this,t));return r===o?null:r===i&&o===n?s:s=e(i=r,n=o)}}(t,n)).on("end.style."+t,_i(t)):"function"==typeof e?this.styleTween(t,function(t,e,i){var n,s,r;return function(){var o=O(this,t),a=i(this),h=a+"";return null==a&&(this.style.removeProperty(t),h=a=O(this,t)),o===h?null:o===n&&h===s?r:(s=h,r=e(n=o,a))}}(t,n,fe(this,"style."+t,e))).each(function(t,e){var i,n,s,r,o="style."+e,a="end."+o;return function(){var h=te(this,t),l=h.on,u=null==h.value[o]?r||(r=_i(e)):void 0;l===i&&s===u||(n=(i=l).copy()).on(a,s=u),h.on=n}}(this._id,t)):this.styleTween(t,function(t,e,i){var n,s,r=i+"";return function(){var o=O(this,t);return o===r?null:o===n?s:s=e(n=o,i)}}(t,n,e),i).on("end.style."+t,null)},styleTween:function(t,e,i){var n="style."+(t+="");if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;return this.tween(n,function(t,e,i){var n,s;function r(){var r=e.apply(this,arguments);return r!==s&&(n=(s=r)&&function(t,e,i){return function(n){this.style.setProperty(t,e.call(this,n),i)}}(t,r,i)),n}return r._value=e,r}(t,e,null==i?"":i))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(fe(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,function(t){var e,i;function n(){var n=t.apply(this,arguments);return n!==i&&(e=(i=n)&&function(t){return function(e){this.textContent=t.call(this,e)}}(n)),e}return n._value=t,n}(t))},remove:function(){return this.on("end.remove",function(t){return function(){var e=this.parentNode;for(var i in this.__transition)if(+i!==t)return;e&&e.removeChild(this)}}(this._id))},tween:function(t,e){var i=this._id;if(t+="",arguments.length<2){for(var n,s=ee(this.node(),i).tween,r=0,o=s.length;r<o;++r)if((n=s[r]).name===t)return n.value;return null}return this.each((null==e?ce:de)(i,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?ci:di)(e,t)):ee(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?fi:pi)(e,t)):ee(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(function(t,e){if("function"!=typeof e)throw new Error;return function(){te(this,t).ease=e}}(e,t)):ee(this.node(),e).ease},easeVarying:function(t){if("function"!=typeof t)throw new Error;return this.each(function(t,e){return function(){var i=e.apply(this,arguments);if("function"!=typeof i)throw new Error;te(this,t).ease=i}}(this._id,t))},end:function(){var t,e,i=this,n=i._id,s=i.size();return new Promise((function(r,o){var a={value:o},h={value:function(){0==--s&&r()}};i.each((function(){var i=te(this,n),s=i.on;s!==t&&((e=(t=s).copy())._.cancel.push(a),e._.interrupt.push(a),e._.end.push(h)),i.on=e})),0===s&&r()}))},[Symbol.iterator]:bi[Symbol.iterator]};var wi={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function xi(t,e){for(var i;!(i=t.__transition)||!(i=i[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return i}ft.prototype.interrupt=function(t){return this.each((function(){ie(this,t)}))},ft.prototype.transition=function(t){var e,i;t instanceof gi?(e=t._id,t=t._name):(e=vi(),(i=wi).time=Dt(),t=null==t?null:t+"");for(var n=this._groups,s=n.length,r=0;r<s;++r)for(var o,a=n[r],h=a.length,l=0;l<h;++l)(o=a[l])&&Jt(o,t,e,l,a,i||xi(o,e));return new gi(n,this._parents,t,e)};const Mi=t=>()=>t;function Si(t,{sourceEvent:e,target:i,transform:n,dispatch:s}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:i,enumerable:!0,configurable:!0},transform:{value:n,enumerable:!0,configurable:!0},_:{value:s}})}function Ii(t,e,i){this.k=t,this.x=e,this.y=i}Ii.prototype={constructor:Ii,scale:function(t){return 1===t?this:new Ii(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new Ii(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Ti=new Ii(1,0,0);function Li(t){t.stopImmediatePropagation()}function Ai(t){t.preventDefault(),t.stopImmediatePropagation()}function Pi(t){return!(t.ctrlKey&&"wheel"!==t.type||t.button)}function Ci(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t).hasAttribute("viewBox")?[[(t=t.viewBox.baseVal).x,t.y],[t.x+t.width,t.y+t.height]]:[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]:[[0,0],[t.clientWidth,t.clientHeight]]}function Bi(){return this.__zoom||Ti}function Oi(t){return-t.deltaY*(1===t.deltaMode?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function Ei(){return navigator.maxTouchPoints||"ontouchstart"in this}function Ni(t,e,i){var n=t.invertX(e[0][0])-i[0][0],s=t.invertX(e[1][0])-i[1][0],r=t.invertY(e[0][1])-i[0][1],o=t.invertY(e[1][1])-i[1][1];return t.translate(s>n?(n+s)/2:Math.min(0,n)||Math.max(0,s),o>r?(r+o)/2:Math.min(0,r)||Math.max(0,o))}Ii.prototype;class zi{constructor(t,e,i,n){this.opts=n||{},this.canvas=t,this.w=this.canvas.offsetWidth,this.h=this.canvas.offsetHeight,this.canvas.width=this.w,this.canvas.height=this.h;const s=this.canvas.getContext("2d");if(!s)throw"Impossible to create canvas 2D context";if(this.ctx=s,this.center=e||{x:.5*this.w,y:.5*this.h},this.zf=i,this.backgroundColor=n.backgroundColor||"white",this.onZoomStartFun=n.onZoomStartFun,this.onZoomEndFun=n.onZoomEndFun,this.onZoomFun=n.onZoomFun,this.extGeo={xMin:NaN,xMax:NaN,yMin:NaN,yMax:NaN},this.updateExtentGeo(),!n.disableZoom){let t=Ti;(function(){var t,e,i,n=Pi,s=Ci,r=Ni,o=Oi,a=Ei,h=[0,1/0],l=[[-1/0,-1/0],[1/0,1/0]],u=250,c=St,d=bt("start","zoom","end"),f=500,p=150,m=0,_=10;function y(t){t.property("__zoom",Bi).on("wheel.zoom",S,{passive:!1}).on("mousedown.zoom",I).on("dblclick.zoom",T).filter(a).on("touchstart.zoom",L).on("touchmove.zoom",A).on("touchend.zoom touchcancel.zoom",P).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function g(t,e){return(e=Math.max(h[0],Math.min(h[1],e)))===t.k?t:new Ii(e,t.x,t.y)}function v(t,e,i){var n=e[0]-i[0]*t.k,s=e[1]-i[1]*t.k;return n===t.x&&s===t.y?t:new Ii(t.k,n,s)}function b(t){return[(+t[0][0]+ +t[1][0])/2,(+t[0][1]+ +t[1][1])/2]}function w(t,e,i,n){t.on("start.zoom",(function(){x(this,arguments).event(n).start()})).on("interrupt.zoom end.zoom",(function(){x(this,arguments).event(n).end()})).tween("zoom",(function(){var t=this,r=arguments,o=x(t,r).event(n),a=s.apply(t,r),h=null==i?b(a):"function"==typeof i?i.apply(t,r):i,l=Math.max(a[1][0]-a[0][0],a[1][1]-a[0][1]),u=t.__zoom,d="function"==typeof e?e.apply(t,r):e,f=c(u.invert(h).concat(l/u.k),d.invert(h).concat(l/d.k));return function(t){if(1===t)t=d;else{var e=f(t),i=l/e[2];t=new Ii(i,h[0]-e[0]*i,h[1]-e[1]*i)}o.zoom(null,t)}}))}function x(t,e,i){return!i&&t.__zooming||new M(t,e)}function M(t,e){this.that=t,this.args=e,this.active=0,this.sourceEvent=null,this.extent=s.apply(t,e),this.taps=0}function S(t,...e){if(n.apply(this,arguments)){var i=x(this,e).event(t),s=this.__zoom,a=Math.max(h[0],Math.min(h[1],s.k*Math.pow(2,o.apply(this,arguments)))),u=It(t);if(i.wheel)i.mouse[0][0]===u[0]&&i.mouse[0][1]===u[1]||(i.mouse[1]=s.invert(i.mouse[0]=u)),clearTimeout(i.wheel);else{if(s.k===a)return;i.mouse=[u,s.invert(u)],ie(this),i.start()}Ai(t),i.wheel=setTimeout((function(){i.wheel=null,i.end()}),p),i.zoom("mouse",r(v(g(s,a),i.mouse[0],i.mouse[1]),i.extent,l))}}function I(t,...e){if(!i&&n.apply(this,arguments)){var s=t.currentTarget,o=x(this,e,!0).event(t),a=pt(t.view).on("mousemove.zoom",(function(t){if(Ai(t),!o.moved){var e=t.clientX-u,i=t.clientY-c;o.moved=e*e+i*i>m}o.event(t).zoom("mouse",r(v(o.that.__zoom,o.mouse[0]=It(t,s),o.mouse[1]),o.extent,l))}),!0).on("mouseup.zoom",(function(t){a.on("mousemove.zoom mouseup.zoom",null),function(t,e){var i=t.document.documentElement,n=pt(t).on("dragstart.drag",null);e&&(n.on("click.drag",xt,wt),setTimeout((function(){n.on("click.drag",null)}),0)),"onselectstart"in i?n.on("selectstart.drag",null):(i.style.MozUserSelect=i.__noselect,delete i.__noselect)}(t.view,o.moved),Ai(t),o.event(t).end()}),!0),h=It(t,s),u=t.clientX,c=t.clientY;!function(t){var e=t.document.documentElement,i=pt(t).on("dragstart.drag",xt,wt);"onselectstart"in e?i.on("selectstart.drag",xt,wt):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}(t.view),Li(t),o.mouse=[h,this.__zoom.invert(h)],ie(this),o.start()}}function T(t,...e){if(n.apply(this,arguments)){var i=this.__zoom,o=It(t.changedTouches?t.changedTouches[0]:t,this),a=i.invert(o),h=i.k*(t.shiftKey?.5:2),c=r(v(g(i,h),o,a),s.apply(this,e),l);Ai(t),u>0?pt(this).transition().duration(u).call(w,c,o,t):pt(this).call(y.transform,c,o,t)}}function L(i,...s){if(n.apply(this,arguments)){var r,o,a,h,l=i.touches,u=l.length,c=x(this,s,i.changedTouches.length===u).event(i);for(Li(i),o=0;o<u;++o)h=[h=It(a=l[o],this),this.__zoom.invert(h),a.identifier],c.touch0?c.touch1||c.touch0[2]===h[2]||(c.touch1=h,c.taps=0):(c.touch0=h,r=!0,c.taps=1+!!t);t&&(t=clearTimeout(t)),r&&(c.taps<2&&(e=h[0],t=setTimeout((function(){t=null}),f)),ie(this),c.start())}}function A(t,...e){if(this.__zooming){var i,n,s,o,a=x(this,e).event(t),h=t.changedTouches,u=h.length;for(Ai(t),i=0;i<u;++i)s=It(n=h[i],this),a.touch0&&a.touch0[2]===n.identifier?a.touch0[0]=s:a.touch1&&a.touch1[2]===n.identifier&&(a.touch1[0]=s);if(n=a.that.__zoom,a.touch1){var c=a.touch0[0],d=a.touch0[1],f=a.touch1[0],p=a.touch1[1],m=(m=f[0]-c[0])*m+(m=f[1]-c[1])*m,_=(_=p[0]-d[0])*_+(_=p[1]-d[1])*_;n=g(n,Math.sqrt(m/_)),s=[(c[0]+f[0])/2,(c[1]+f[1])/2],o=[(d[0]+p[0])/2,(d[1]+p[1])/2]}else{if(!a.touch0)return;s=a.touch0[0],o=a.touch0[1]}a.zoom("touch",r(v(n,s,o),a.extent,l))}}function P(t,...n){if(this.__zooming){var s,r,o=x(this,n).event(t),a=t.changedTouches,h=a.length;for(Li(t),i&&clearTimeout(i),i=setTimeout((function(){i=null}),f),s=0;s<h;++s)r=a[s],o.touch0&&o.touch0[2]===r.identifier?delete o.touch0:o.touch1&&o.touch1[2]===r.identifier&&delete o.touch1;if(o.touch1&&!o.touch0&&(o.touch0=o.touch1,delete o.touch1),o.touch0)o.touch0[1]=this.__zoom.invert(o.touch0[0]);else if(o.end(),2===o.taps&&(r=It(r,this),Math.hypot(e[0]-r[0],e[1]-r[1])<_)){var l=pt(this).on("dblclick.zoom");l&&l.apply(this,arguments)}}}return y.transform=function(t,e,i,n){var s=t.selection?t.selection():t;s.property("__zoom",Bi),t!==s?w(t,e,i,n):s.interrupt().each((function(){x(this,arguments).event(n).start().zoom(null,"function"==typeof e?e.apply(this,arguments):e).end()}))},y.scaleBy=function(t,e,i,n){y.scaleTo(t,(function(){return this.__zoom.k*("function"==typeof e?e.apply(this,arguments):e)}),i,n)},y.scaleTo=function(t,e,i,n){y.transform(t,(function(){var t=s.apply(this,arguments),n=this.__zoom,o=null==i?b(t):"function"==typeof i?i.apply(this,arguments):i,a=n.invert(o),h="function"==typeof e?e.apply(this,arguments):e;return r(v(g(n,h),o,a),t,l)}),i,n)},y.translateBy=function(t,e,i,n){y.transform(t,(function(){return r(this.__zoom.translate("function"==typeof e?e.apply(this,arguments):e,"function"==typeof i?i.apply(this,arguments):i),s.apply(this,arguments),l)}),null,n)},y.translateTo=function(t,e,i,n,o){y.transform(t,(function(){var t=s.apply(this,arguments),o=this.__zoom,a=null==n?b(t):"function"==typeof n?n.apply(this,arguments):n;return r(Ti.translate(a[0],a[1]).scale(o.k).translate("function"==typeof e?-e.apply(this,arguments):-e,"function"==typeof i?-i.apply(this,arguments):-i),t,l)}),n,o)},M.prototype={event:function(t){return t&&(this.sourceEvent=t),this},start:function(){return 1==++this.active&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(t,e){return this.mouse&&"mouse"!==t&&(this.mouse[1]=e.invert(this.mouse[0])),this.touch0&&"touch"!==t&&(this.touch0[1]=e.invert(this.touch0[0])),this.touch1&&"touch"!==t&&(this.touch1[1]=e.invert(this.touch1[0])),this.that.__zoom=e,this.emit("zoom"),this},end:function(){return 0==--this.active&&(delete this.that.__zooming,this.emit("end")),this},emit:function(t){var e=pt(this.that).datum();d.call(t,this.that,new Si(t,{sourceEvent:this.sourceEvent,target:y,type:t,transform:this.that.__zoom,dispatch:d}),e)}},y.wheelDelta=function(t){return arguments.length?(o="function"==typeof t?t:Mi(+t),y):o},y.filter=function(t){return arguments.length?(n="function"==typeof t?t:Mi(!!t),y):n},y.touchable=function(t){return arguments.length?(a="function"==typeof t?t:Mi(!!t),y):a},y.extent=function(t){return arguments.length?(s="function"==typeof t?t:Mi([[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]]),y):s},y.scaleExtent=function(t){return arguments.length?(h[0]=+t[0],h[1]=+t[1],y):[h[0],h[1]]},y.translateExtent=function(t){return arguments.length?(l[0][0]=+t[0][0],l[1][0]=+t[1][0],l[0][1]=+t[0][1],l[1][1]=+t[1][1],y):[[l[0][0],l[0][1]],[l[1][0],l[1][1]]]},y.constrain=function(t){return arguments.length?(r=t,y):r},y.duration=function(t){return arguments.length?(u=+t,y):u},y.interpolate=function(t){return arguments.length?(c=t,y):c},y.on=function(){var t=d.on.apply(d,arguments);return t===d?y:t},y.clickDistance=function(t){return arguments.length?(m=(t=+t)*t,y):Math.sqrt(m)},y.tapDistance=function(t){return arguments.length?(_=+t,y):_},y})().wheelDelta((t=>-t.deltaY*(1===t.deltaMode?.07:t.deltaMode?1:.004))).on("zoom",(e=>{const i=e.transform,n=t.k/i.k;if(1==n){const e=t.x-i.x,n=t.y-i.y;this.pan(e*this.getZf(),-n*this.getZf())}else{const t=e.sourceEvent;if(t instanceof WheelEvent)this.zoom(n,this.pixToGeoX(e.sourceEvent.offsetX),this.pixToGeoY(e.sourceEvent.offsetY));else if(t instanceof TouchEvent){let e=0,i=0;for(let n of t.targetTouches)e+=n.clientX,i+=n.clientY;e/=t.targetTouches.length,i/=t.targetTouches.length,this.zoom(n,this.pixToGeoX(e),this.pixToGeoY(i))}}t=i,this.onZoomFun&&this.onZoomFun(e)})).on("start",(t=>{this.canvasSave.c=document.createElement("canvas"),this.canvasSave.c.setAttribute("width",""+this.w),this.canvasSave.c.setAttribute("height",""+this.h),this.canvasSave.c.getContext("2d").drawImage(this.canvas,0,0),this.canvasSave.dx=0,this.canvasSave.dy=0,this.canvasSave.f=1,this.onZoomStartFun&&this.onZoomStartFun(t)})).on("end",(t=>{this.redraw(!0),this.canvasSave={c:null,dx:0,dy:0,f:1},this.onZoomEndFun&&this.onZoomEndFun(t)}))(pt(this.canvas))}this.zfExtent=[0,1/0],this.canvasSave={c:null,dx:0,dy:0,f:1}}setCenter(t){this.center=t}getCenter(){return this.center}setZf(t){this.zf=t,this.slider&&this.slider.attr("value",+this.zf)}getZf(){return this.zf}setZfExtent(t){this.zfExtent=t}getZfExtent(){return this.zfExtent}initCanvasTransform(){this.ctx.setTransform(1,0,0,1,0,0)}setCanvasTransform(){const t=1/this.getZf(),e=-this.center.x/this.getZf()+.5*this.w,i=this.center.y/this.getZf()+.5*this.h;this.ctx.setTransform(t,0,0,-t,e,i)}getWebGLTransform(){const t=2/(this.w*this.getZf()),e=2/(this.h*this.getZf());return[t,0,0,0,e,0,-t*this.center.x,-e*this.center.y,1]}redraw(t=!0){throw new Error("Method redraw not implemented.")}clear(t="white"){this.opts.transparentBackground?this.ctx.clearRect(0,0,this.w,this.h):(this.ctx&&(this.ctx.fillStyle=t),this.ctx.fillRect(0,0,this.w,this.h))}pan(t=0,e=0){this.center.x+=t,this.center.y+=e,this.updateExtentGeo(),this.canvasSave.c&&(this.canvasSave.dx-=t/this.getZf(),this.canvasSave.dy+=e/this.getZf(),this.clear(this.backgroundColor),this.ctx.drawImage(this.canvasSave.c,this.canvasSave.dx,this.canvasSave.dy))}zoom(t=1,e=this.center.x,i=this.center.y){if(this.zfExtent[0]==this.getZf()&&t<=1)return;if(this.zfExtent[1]==this.getZf()&&t>=1)return;const n=t*this.getZf();n<this.zfExtent[0]&&(t=this.zfExtent[0]/this.getZf()),n>this.zfExtent[1]&&(t=this.zfExtent[1]/this.getZf()),this.setZf(t*this.getZf());const s=(e-this.center.x)*(1-t);this.center.x+=s;const r=(i-this.center.y)*(1-t);this.center.y+=r,this.updateExtentGeo(),this.canvasSave.c&&(this.clear(this.backgroundColor),this.canvasSave.f/=t,this.canvasSave.dx=this.geoToPixX(e)*(1-this.canvasSave.f),this.canvasSave.dy=this.geoToPixY(i)*(1-this.canvasSave.f),this.clear(this.backgroundColor),this.ctx.drawImage(this.canvasSave.c,this.canvasSave.dx,this.canvasSave.dy,this.canvasSave.f*this.canvasSave.c.width,this.canvasSave.f*this.canvasSave.c.height))}updateExtentGeo(t=20){return this.extGeo={xMin:this.pixToGeoX(-t),xMax:this.pixToGeoX(this.w+t),yMin:this.pixToGeoY(this.h+t),yMax:this.pixToGeoY(-t)},this.extGeo}toDraw(t){return!(t.x<this.extGeo.xMin||t.x>this.extGeo.xMax||t.y<this.extGeo.yMin||t.y>this.extGeo.yMax)}geoToPixX(t){return(t-this.center.x)/this.getZf()+.5*this.w}geoToPixY(t){return-(t-this.center.y)/this.getZf()+.5*this.h}pixToGeoX(t){return(t-.5*this.w)*this.getZf()+this.center.x}pixToGeoY(t){return-(t-.5*this.h)*this.getZf()+this.center.y}setViewFromURL(){const t=zi.getParameterByName("x"),e=zi.getParameterByName("y"),i=zi.getParameterByName("z"),n=this.getCenter();null==t||null==t||isNaN(+t)||(n.x=+t),null==e||null==e||isNaN(+e)||(n.y=+e),null==i||null==i||isNaN(+i)||this.setZf(+i)}addZoomSlider(t,e){(e=e||{}).width=e.width||"30px",e.height=e.height||"300px";const i=pt("#"+t);if(i.empty())return console.error("Could not find div element to build zoom slider. Id: "+t),this;const n=this;return this.slider=i.append("input").attr("type","range").attr("min",this.getZfExtent()[0]).attr("max",this.getZfExtent()[1]).attr("value",this.getZf()).on("input",(function(t){if(!this||!this.value)return;const e=+this.value;pt(this).attr("value",e),n.setZf(e),n.redraw()})).style("width",e.width).style("height",e.height).style("opacity",.7).on("mouseover",(function(t){pt(this).style("opacity",1)})).on("mouseout",(function(t){pt(this).style("opacity",.7)})).style("-webkit-appearance","slider-vertical").style("writing-mode","bt-lr").attr("orient","vertical").style("background","lightgray").style("outline","none").style("-webkit-transition",".2s").style("transition","opacity .2s"),this}static getParameterByName(t){t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var e=new RegExp("[\\?&]"+t+"=([^&#]*)").exec(location.search);return e?decodeURIComponent(e[1].replace(/\+/g," ")):null}}class ki{constructor(t,e,i={}){if(i=i||{},this.dataset=t,this.styles=e,this.visible=0!=i.visible,this.minZoom=i.minZoom||0,this.maxZoom=i.maxZoom||1/0,this.minZoom>=this.maxZoom)throw new Error("Unexpected zoom limits for layer. Zoom min should be smaller than zoom max.");this.pixNb=i.pixNb||3,this.cellInfoHTML=i.cellInfoHTML||ki.defaultCellInfoHTML}getDatasetComponent(t){if(t<this.minZoom||t>this.maxZoom)return;if(1==this.dataset.datasetComponents.length)return this.dataset.datasetComponents[0];const e=this.dataset.resolutions;let i=0,n=e[i]/this.pixNb;for(;n<t&&i<e.length;)i++,n=e[i]/this.pixNb;return i==e.length?this.dataset.datasetComponents[e.length-1]:this.dataset.datasetComponents[i]}static defaultCellInfoHTML(t){const e=[];for(const i of Object.keys(t))"x"!==i&&"y"!==i&&e.push("<b>",i,"</b>"," : ",t[i],"<br>");return e.join("")}}class Di{constructor(t,e,i={}){if(i=i||{},this.datasetComponents=t,this.resolutions=e,this.datasetComponents.length>1&&this.datasetComponents.length!=this.resolutions.length)throw new Error("Uncompatible number of datasets and resolutions: "+this.datasetComponents.length+" "+this.resolutions.length);i.preprocess&&this.setPrepocesses(i.preprocess)}setPrepocesses(t){for(let e of this.datasetComponents)e.preprocess=t;return this}static make(t,e,i){const n=[];for(const i of t)n.push(e(i));return new Di(n,t,i)}}class Fi{constructor(t){t=t||{},this.div=t.div||"tooltip_eurostat",this.maxWidth=t.maxWidth||"20em",this.fontSize=t.fontSize||"1.2em",this.background=t.background||"white",this.padding=t.padding||"5px",this.border=t.border||"0px",this["border-radius"]=t["border-radius"]||"5px",this["box-shadow"]=t["box-shadow"]||"5px 5px 5px grey",this["font-family"]=t["font-family"]||"Helvetica, Arial, sans-serif",this.transitionDuration=t.transitionDuration||100,this.xOffset=t.xOffset||30,this.yOffset=t.yOffset||20,this.yMouseOffset=t.yMouseOffset||0,this.xMouseOffset=t.xMouseOffset||0,this.tooltip=pt("#"+this.div),this.tooltip.empty()&&(this.tooltip=pt("body").append("div").attr("id",this.div)),this.tooltip.style("max-width",this.maxWidth),this.tooltip.style("overflow","hidden"),this.tooltip.style("font-size",this.fontSize),this.tooltip.style("background",this.background),this.tooltip.style("padding",this.padding),this.tooltip.style("border",this.border),this.tooltip.style("border-radius",this["border-radius"]),this.tooltip.style("box-shadow",this["box-shadow"]),this.tooltip.style("font-family",this["font-family"]),this.tooltip.style("position","absolute"),this.tooltip.style("pointer-events","none"),this.tooltip.style("opacity","0")}show(){this.tooltip.transition().duration(this.transitionDuration).style("opacity",1)}hide(){this.tooltip.transition().duration(this.transitionDuration).style("opacity",0)}html(t){this.tooltip.html(t)}setPosition(t){this.tooltip.style("left",t.pageX+this.xOffset+"px").style("top",t.pageY-this.yOffset+"px")}style(t,e){return 1==arguments.length?this.tooltip.style(t):(this.tooltip.style(t,e),this)}attr(t,e){return 1==arguments.length?this.tooltip.attr(t):(this.tooltip.attr(t,e),this)}}var Ri={},Ui={};function Zi(t){return new Function("d","return {"+t.map((function(t,e){return JSON.stringify(t)+": d["+e+'] || ""'})).join(",")+"}")}function ji(t){var e=Object.create(null),i=[];return t.forEach((function(t){for(var n in t)n in e||i.push(e[n]=n)})),i}function Vi(t,e){var i=t+"",n=i.length;return n<e?new Array(e-n+1).join(0)+i:i}function Gi(t){var e=new RegExp('["'+t+"\n\r]"),i=t.charCodeAt(0);function n(t,e){var n,s=[],r=t.length,o=0,a=0,h=r<=0,l=!1;function u(){if(h)return Ui;if(l)return l=!1,Ri;var e,n,s=o;if(34===t.charCodeAt(s)){for(;o++<r&&34!==t.charCodeAt(o)||34===t.charCodeAt(++o););return(e=o)>=r?h=!0:10===(n=t.charCodeAt(o++))?l=!0:13===n&&(l=!0,10===t.charCodeAt(o)&&++o),t.slice(s+1,e-1).replace(/""/g,'"')}for(;o<r;){if(10===(n=t.charCodeAt(e=o++)))l=!0;else if(13===n)l=!0,10===t.charCodeAt(o)&&++o;else if(n!==i)continue;return t.slice(s,e)}return h=!0,t.slice(s,r)}for(10===t.charCodeAt(r-1)&&--r,13===t.charCodeAt(r-1)&&--r;(n=u())!==Ui;){for(var c=[];n!==Ri&&n!==Ui;)c.push(n),n=u();e&&null==(c=e(c,a++))||s.push(c)}return s}function s(e,i){return e.map((function(e){return i.map((function(t){return o(e[t])})).join(t)}))}function r(e){return e.map(o).join(t)}function o(t){return null==t?"":t instanceof Date?(s=(i=t).getUTCHours(),r=i.getUTCMinutes(),o=i.getUTCSeconds(),a=i.getUTCMilliseconds(),isNaN(i)?"Invalid Date":((n=i.getUTCFullYear())<0?"-"+Vi(-n,6):n>9999?"+"+Vi(n,6):Vi(n,4))+"-"+Vi(i.getUTCMonth()+1,2)+"-"+Vi(i.getUTCDate(),2)+(a?"T"+Vi(s,2)+":"+Vi(r,2)+":"+Vi(o,2)+"."+Vi(a,3)+"Z":o?"T"+Vi(s,2)+":"+Vi(r,2)+":"+Vi(o,2)+"Z":r||s?"T"+Vi(s,2)+":"+Vi(r,2)+"Z":"")):e.test(t+="")?'"'+t.replace(/"/g,'""')+'"':t;var i,n,s,r,o,a}return{parse:function(t,e){var i,s,r=n(t,(function(t,n){if(i)return i(t,n-1);s=t,i=e?function(t,e){var i=Zi(t);return function(n,s){return e(i(n),s,t)}}(t,e):Zi(t)}));return r.columns=s||[],r},parseRows:n,format:function(e,i){return null==i&&(i=ji(e)),[i.map(o).join(t)].concat(s(e,i)).join("\n")},formatBody:function(t,e){return null==e&&(e=ji(t)),s(t,e).join("\n")},formatRows:function(t){return t.map(r).join("\n")},formatRow:r,formatValue:o}}var qi=Gi(","),Wi=qi.parse,Hi=(qi.parseRows,qi.format,qi.formatBody,qi.formatRows,qi.formatRow,qi.formatValue,Gi("\t")),$i=Hi.parse;function Yi(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.text()}function Xi(t){return function(e,i,n){return 2===arguments.length&&"function"==typeof i&&(n=i,i=void 0),function(t,e){return fetch(t,e).then(Yi)}(e,i).then((function(e){return t(e,n)}))}}Hi.parseRows,Hi.format,Hi.formatBody,Hi.formatRows,Hi.formatRow,Hi.formatValue;var Ki=Xi(Wi);Xi($i);class Ji{constructor(t,e,i={}){i=i||{},this.url=t,this.resolution=e,this.preprocess=i.preprocess||void 0,this.cellsViewCache=[]}getData(t,e){throw new Error("Method getData not implemented.")}updateViewCache(t){throw new Error("Method updateViewCache not implemented.")}getCellFromPosition(t,e){const i=this.getResolution(),n=i*Math.floor(t.x/i),s=i*Math.floor(t.y/i);for(const t of e)if(t.x==n&&t.y==s)return t}getResolution(){return this.resolution}getViewCache(){return this.cellsViewCache}}class Qi extends Ji{constructor(t,e,i={}){super(t,e,i),this.cells=[],this.infoLoadingStatus="notLoaded"}getData(t,e){return"notLoaded"!=this.infoLoadingStatus||(this.infoLoadingStatus="loading",(async()=>{try{const t=await Ki(this.url);for(const e of t)e.x=+e.x,e.y=+e.y;if(this.preprocess){this.cells=[];for(const e of t)0!=this.preprocess(e)&&this.cells.push(e)}else this.cells=t;e&&e(),this.infoLoadingStatus="loaded"}catch(t){this.infoLoadingStatus="failed",this.cells=[]}})()),this}updateViewCache(t){if(this.cells){this.cellsViewCache=[];for(const e of this.cells)+e.x+this.resolution<t.xMin||+e.x-this.resolution>t.xMax||+e.y+this.resolution<t.yMin||+e.y-this.resolution>t.yMax||this.cellsViewCache.push(e)}}}class tn{constructor(t,e,i,n){this.cells=t,this.x=e,this.y=i;const s=n.resolutionGeo,r=n.tileSizeCell;this.extGeo={xMin:n.originPoint.x+s*r*this.x,xMax:n.originPoint.x+s*r*(this.x+1),yMin:n.originPoint.y+s*r*this.y,yMax:n.originPoint.y+s*r*(this.y+1)};for(let t of this.cells)t.x=this.extGeo.xMin+t.x*s,t.y=this.extGeo.yMin+t.y*s}}function en(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);if(204!==t.status&&205!==t.status)return t.json()}function nn(t,e){return fetch(t,e).then(en)}var sn,rn,on,an,hn,ln,un,cn,dn,fn,pn,mn,_n;function yn(t){if(null===t)return"null";if(void 0===t)return"undefined";switch(typeof t){case"number":case"bigint":return`${t}`;case"string":return`"${t}"`}return"function"==typeof t[Symbol.toPrimitive]?t[Symbol.toPrimitive]("string"):ArrayBuffer.isView(t)?t instanceof BigInt64Array||t instanceof BigUint64Array?`[${[...t].map((t=>yn(t)))}]`:`[${t}]`:ArrayBuffer.isView(t)?`[${t}]`:JSON.stringify(t,((t,e)=>"bigint"==typeof e?`${e}`:e))}function gn(t,e,i,n){return new(i||(i=Promise))((function(s,r){function o(t){try{h(n.next(t))}catch(t){r(t)}}function a(t){try{h(n.throw(t))}catch(t){r(t)}}function h(t){var e;t.done?s(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}h((n=n.apply(t,e||[])).next())}))}function vn(t){return this instanceof vn?(this.v=t,this):new vn(t)}function bn(t,e,i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,s=i.apply(t,e||[]),r=[];return n={},o("next"),o("throw"),o("return"),n[Symbol.asyncIterator]=function(){return this},n;function o(t){s[t]&&(n[t]=function(e){return new Promise((function(i,n){r.push([t,e,i,n])>1||a(t,e)}))})}function a(t,e){try{(i=s[t](e)).value instanceof vn?Promise.resolve(i.value.v).then(h,l):u(r[0][2],i)}catch(t){u(r[0][3],t)}var i}function h(t){a("next",t)}function l(t){a("throw",t)}function u(t,e){t(e),r.shift(),r.length&&a(r[0][0],r[0][1])}}function wn(t){var e,i;return e={},n("next"),n("throw",(function(t){throw t})),n("return"),e[Symbol.iterator]=function(){return this},e;function n(n,s){e[n]=t[n]?function(e){return(i=!i)?{value:vn(t[n](e)),done:!1}:s?s(e):e}:s}}function xn(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,i=t[Symbol.asyncIterator];return i?i.call(t):(t=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],n=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(t),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(i){e[i]=t[i]&&function(e){return new Promise((function(n,s){!function(t,e,i,n){Promise.resolve(n).then((function(e){t({value:e,done:i})}),e)}(n,s,(e=t[i](e)).done,e.value)}))}}}!function(t){t[t.V1=0]="V1",t[t.V2=1]="V2",t[t.V3=2]="V3",t[t.V4=3]="V4",t[t.V5=4]="V5"}(sn||(sn={})),(_n=rn||(rn={}))[_n.Sparse=0]="Sparse",_n[_n.Dense=1]="Dense",function(t){t[t.HALF=0]="HALF",t[t.SINGLE=1]="SINGLE",t[t.DOUBLE=2]="DOUBLE"}(on||(on={})),(mn=an||(an={}))[mn.DAY=0]="DAY",mn[mn.MILLISECOND=1]="MILLISECOND",(pn=hn||(hn={}))[pn.SECOND=0]="SECOND",pn[pn.MILLISECOND=1]="MILLISECOND",pn[pn.MICROSECOND=2]="MICROSECOND",pn[pn.NANOSECOND=3]="NANOSECOND",(fn=ln||(ln={}))[fn.YEAR_MONTH=0]="YEAR_MONTH",fn[fn.DAY_TIME=1]="DAY_TIME",fn[fn.MONTH_DAY_NANO=2]="MONTH_DAY_NANO",function(t){t[t.NONE=0]="NONE",t[t.Schema=1]="Schema",t[t.DictionaryBatch=2]="DictionaryBatch",t[t.RecordBatch=3]="RecordBatch",t[t.Tensor=4]="Tensor",t[t.SparseTensor=5]="SparseTensor"}(un||(un={})),function(t){t[t.NONE=0]="NONE",t[t.Null=1]="Null",t[t.Int=2]="Int",t[t.Float=3]="Float",t[t.Binary=4]="Binary",t[t.Utf8=5]="Utf8",t[t.Bool=6]="Bool",t[t.Decimal=7]="Decimal",t[t.Date=8]="Date",t[t.Time=9]="Time",t[t.Timestamp=10]="Timestamp",t[t.Interval=11]="Interval",t[t.List=12]="List",t[t.Struct=13]="Struct",t[t.Union=14]="Union",t[t.FixedSizeBinary=15]="FixedSizeBinary",t[t.FixedSizeList=16]="FixedSizeList",t[t.Map=17]="Map",t[t.Dictionary=-1]="Dictionary",t[t.Int8=-2]="Int8",t[t.Int16=-3]="Int16",t[t.Int32=-4]="Int32",t[t.Int64=-5]="Int64",t[t.Uint8=-6]="Uint8",t[t.Uint16=-7]="Uint16",t[t.Uint32=-8]="Uint32",t[t.Uint64=-9]="Uint64",t[t.Float16=-10]="Float16",t[t.Float32=-11]="Float32",t[t.Float64=-12]="Float64",t[t.DateDay=-13]="DateDay",t[t.DateMillisecond=-14]="DateMillisecond",t[t.TimestampSecond=-15]="TimestampSecond",t[t.TimestampMillisecond=-16]="TimestampMillisecond",t[t.TimestampMicrosecond=-17]="TimestampMicrosecond",t[t.TimestampNanosecond=-18]="TimestampNanosecond",t[t.TimeSecond=-19]="TimeSecond",t[t.TimeMillisecond=-20]="TimeMillisecond",t[t.TimeMicrosecond=-21]="TimeMicrosecond",t[t.TimeNanosecond=-22]="TimeNanosecond",t[t.DenseUnion=-23]="DenseUnion",t[t.SparseUnion=-24]="SparseUnion",t[t.IntervalDayTime=-25]="IntervalDayTime",t[t.IntervalYearMonth=-26]="IntervalYearMonth"}(cn||(cn={})),function(t){t[t.OFFSET=0]="OFFSET",t[t.DATA=1]="DATA",t[t.VALIDITY=2]="VALIDITY",t[t.TYPE=3]="TYPE"}(dn||(dn={})),Object.create,Object.create;const Mn=new TextDecoder("utf-8"),Sn=t=>Mn.decode(t),In=new TextEncoder,Tn=t=>In.encode(t),[Ln,An]=(()=>{const t=()=>{throw new Error("BigInt is not available in this environment")};function e(){throw t()}return e.asIntN=()=>{throw t()},e.asUintN=()=>{throw t()},"undefined"!=typeof BigInt?[BigInt,!0]:[e,!1]})(),[Pn,Cn]=(()=>{const t=()=>{throw new Error("BigInt64Array is not available in this environment")};return"undefined"!=typeof BigInt64Array?[BigInt64Array,!0]:[class{static get BYTES_PER_ELEMENT(){return 8}static of(){throw t()}static from(){throw t()}constructor(){throw t()}},!1]})(),[Bn,On]=(()=>{const t=()=>{throw new Error("BigUint64Array is not available in this environment")};return"undefined"!=typeof BigUint64Array?[BigUint64Array,!0]:[class{static get BYTES_PER_ELEMENT(){return 8}static of(){throw t()}static from(){throw t()}constructor(){throw t()}},!1]})(),En=t=>"function"==typeof t,Nn=t=>null!=t&&Object(t)===t,zn=t=>Nn(t)&&En(t.then),kn=t=>Nn(t)&&En(t[Symbol.iterator]),Dn=t=>Nn(t)&&En(t[Symbol.asyncIterator]),Fn=t=>Nn(t)&&Nn(t.schema),Rn=t=>Nn(t)&&"done"in t&&"value"in t,Un=t=>Nn(t)&&En(t.stat)&&(t=>"number"==typeof t)(t.fd),Zn=t=>Nn(t)&&Vn(t.body),jn=t=>"_getDOMStream"in t&&"_getNodeStream"in t,Vn=t=>Nn(t)&&En(t.cancel)&&En(t.getReader)&&!jn(t),Gn=t=>Nn(t)&&En(t.read)&&En(t.pipe)&&(t=>"boolean"==typeof t)(t.readable)&&!jn(t),qn=t=>Nn(t)&&En(t.clear)&&En(t.bytes)&&En(t.position)&&En(t.setPosition)&&En(t.capacity)&&En(t.getBufferIdentifier)&&En(t.createLong),Wn="undefined"!=typeof SharedArrayBuffer?SharedArrayBuffer:ArrayBuffer;function Hn(t,e,i=0,n=e.byteLength){const s=t.byteLength,r=new Uint8Array(t.buffer,t.byteOffset,s),o=new Uint8Array(e.buffer,e.byteOffset,Math.min(n,s));return r.set(o,i),t}function $n(t,e){const i=function(t){const e=t[0]?[t[0]]:[];let i,n,s,r;for(let o,a,h=0,l=0,u=t.length;++h<u;)o=e[l],a=t[h],!o||!a||o.buffer!==a.buffer||a.byteOffset<o.byteOffset?a&&(e[++l]=a):(({byteOffset:i,byteLength:s}=o),({byteOffset:n,byteLength:r}=a),i+s<n||n+r<i?a&&(e[++l]=a):e[l]=new Uint8Array(o.buffer,i,n-i+r));return e}(t),n=i.reduce(((t,e)=>t+e.byteLength),0);let s,r,o,a=0,h=-1;const l=Math.min(e||Number.POSITIVE_INFINITY,n);for(const t=i.length;++h<t;){if(s=i[h],r=s.subarray(0,Math.min(s.length,l-a)),l<=a+r.length){r.length<s.length?i[h]=s.subarray(r.length):r.length===s.length&&h++,o?Hn(o,r,a):o=r;break}Hn(o||(o=new Uint8Array(l)),r,a),a+=r.length}return[o||new Uint8Array(0),i.slice(h),n-(o?o.byteLength:0)]}function Yn(t,e){let i=Rn(e)?e.value:e;return i instanceof t?t===Uint8Array?new t(i.buffer,i.byteOffset,i.byteLength):i:i?("string"==typeof i&&(i=Tn(i)),i instanceof ArrayBuffer||i instanceof Wn?new t(i):qn(i)?Yn(t,i.bytes()):ArrayBuffer.isView(i)?i.byteLength<=0?new t(0):new t(i.buffer,i.byteOffset,i.byteLength/t.BYTES_PER_ELEMENT):t.from(i)):new t(0)}const Xn=t=>Yn(Int32Array,t),Kn=t=>Yn(Uint8Array,t),Jn=t=>(t.next(),t);function Qn(t,e){return bn(this,arguments,(function*(){if(zn(e))return yield vn(yield vn(yield*wn(xn(Qn(t,yield vn(e))))));const i=function(t){return bn(this,arguments,(function*(){yield yield vn(yield vn(t))}))},n="string"==typeof e||ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof Wn?i(e):kn(e)?function(t){return bn(this,arguments,(function*(){yield vn(yield*wn(xn(Jn(function*(t){let e=null;do{e=t.next(yield null==e?void 0:e.value)}while(!e.done)}(t[Symbol.iterator]())))))}))}(e):Dn(e)?e:i(e);return yield vn(yield*wn(xn(Jn(function(e){return bn(this,arguments,(function*(){let i=null;do{i=yield vn(e.next(yield yield vn(Yn(t,i))))}while(!i.done)}))}(n[Symbol.asyncIterator]()))))),yield vn(new t)}))}const ts=Symbol.for("isArrowBigNum");function es(t,...e){return 0===e.length?Object.setPrototypeOf(Yn(this.TypedArray,t),this.constructor.prototype):Object.setPrototypeOf(new this.TypedArray(t,...e),this.constructor.prototype)}function is(...t){return es.apply(this,t)}function ns(...t){return es.apply(this,t)}function ss(...t){return es.apply(this,t)}function rs(t){const{buffer:e,byteOffset:i,length:n,signed:s}=t,r=new Bn(e,i,n),o=s&&r[r.length-1]&BigInt(1)<<BigInt(63);let a=o?BigInt(1):BigInt(0),h=BigInt(0);if(o){for(const t of r)a+=~t*(BigInt(1)<<BigInt(32)*h++);a*=BigInt(-1)}else for(const t of r)a+=t*(BigInt(1)<<BigInt(32)*h++);return a}let os,as;function hs(t){let e="";const i=new Uint32Array(2);let n=new Uint16Array(t.buffer,t.byteOffset,t.byteLength/2);const s=new Uint32Array((n=new Uint16Array(n).reverse()).buffer);let r=-1;const o=n.length-1;do{for(i[0]=n[r=0];r<o;)n[r++]=i[1]=i[0]/10,i[0]=(i[0]-10*i[1]<<16)+n[r];n[r]=i[1]=i[0]/10,i[0]=i[0]-10*i[1],e=`${i[0]}${e}`}while(s[0]||s[1]||s[2]||s[3]);return null!=e?e:"0"}es.prototype[ts]=!0,es.prototype.toJSON=function(){return`"${os(this)}"`},es.prototype.valueOf=function(){return rs(this)},es.prototype.toString=function(){return os(this)},es.prototype[Symbol.toPrimitive]=function(t="default"){switch(t){case"number":return rs(this);case"string":return os(this);case"default":return as(this)}return os(this)},Object.setPrototypeOf(is.prototype,Object.create(Int32Array.prototype)),Object.setPrototypeOf(ns.prototype,Object.create(Uint32Array.prototype)),Object.setPrototypeOf(ss.prototype,Object.create(Uint32Array.prototype)),Object.assign(is.prototype,es.prototype,{constructor:is,signed:!0,TypedArray:Int32Array,BigIntArray:Pn}),Object.assign(ns.prototype,es.prototype,{constructor:ns,signed:!1,TypedArray:Uint32Array,BigIntArray:Bn}),Object.assign(ss.prototype,es.prototype,{constructor:ss,signed:!0,TypedArray:Uint32Array,BigIntArray:Bn}),An?(as=t=>8===t.byteLength?new t.BigIntArray(t.buffer,t.byteOffset,1)[0]:hs(t),os=t=>8===t.byteLength?`${new t.BigIntArray(t.buffer,t.byteOffset,1)[0]}`:hs(t)):(os=hs,as=os);class ls{static new(t,e){switch(e){case!0:return new is(t);case!1:return new ns(t)}switch(t.constructor){case Int8Array:case Int16Array:case Int32Array:case Pn:return new is(t)}return 16===t.byteLength?new ss(t):new ns(t)}static signed(t){return new is(t)}static unsigned(t){return new ns(t)}static decimal(t){return new ss(t)}constructor(t,e){return ls.new(t,e)}}var us,cs,ds,fs,ps,ms,_s,ys,gs,vs,bs,ws,xs,Ms,Ss,Is,Ts,Ls,As,Ps;class Cs{static isNull(t){return(null==t?void 0:t.typeId)===cn.Null}static isInt(t){return(null==t?void 0:t.typeId)===cn.Int}static isFloat(t){return(null==t?void 0:t.typeId)===cn.Float}static isBinary(t){return(null==t?void 0:t.typeId)===cn.Binary}static isUtf8(t){return(null==t?void 0:t.typeId)===cn.Utf8}static isBool(t){return(null==t?void 0:t.typeId)===cn.Bool}static isDecimal(t){return(null==t?void 0:t.typeId)===cn.Decimal}static isDate(t){return(null==t?void 0:t.typeId)===cn.Date}static isTime(t){return(null==t?void 0:t.typeId)===cn.Time}static isTimestamp(t){return(null==t?void 0:t.typeId)===cn.Timestamp}static isInterval(t){return(null==t?void 0:t.typeId)===cn.Interval}static isList(t){return(null==t?void 0:t.typeId)===cn.List}static isStruct(t){return(null==t?void 0:t.typeId)===cn.Struct}static isUnion(t){return(null==t?void 0:t.typeId)===cn.Union}static isFixedSizeBinary(t){return(null==t?void 0:t.typeId)===cn.FixedSizeBinary}static isFixedSizeList(t){return(null==t?void 0:t.typeId)===cn.FixedSizeList}static isMap(t){return(null==t?void 0:t.typeId)===cn.Map}static isDictionary(t){return(null==t?void 0:t.typeId)===cn.Dictionary}static isDenseUnion(t){return Cs.isUnion(t)&&t.mode===rn.Dense}static isSparseUnion(t){return Cs.isUnion(t)&&t.mode===rn.Sparse}get typeId(){return cn.NONE}}us=Symbol.toStringTag,Cs[us]=((Ps=Cs.prototype).children=null,Ps.ArrayType=Array,Ps[Symbol.toStringTag]="DataType");class Bs extends Cs{toString(){return"Null"}get typeId(){return cn.Null}}cs=Symbol.toStringTag,Bs[cs]=(t=>t[Symbol.toStringTag]="Null")(Bs.prototype);class Os extends Cs{constructor(t,e){super(),this.isSigned=t,this.bitWidth=e}get typeId(){return cn.Int}get ArrayType(){switch(this.bitWidth){case 8:return this.isSigned?Int8Array:Uint8Array;case 16:return this.isSigned?Int16Array:Uint16Array;case 32:return this.isSigned?Int32Array:Uint32Array;case 64:return this.isSigned?BigInt64Array:BigUint64Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}toString(){return`${this.isSigned?"I":"Ui"}nt${this.bitWidth}`}}ds=Symbol.toStringTag,Os[ds]=(t=>(t.isSigned=null,t.bitWidth=null,t[Symbol.toStringTag]="Int"))(Os.prototype);class Es extends Os{constructor(){super(!0,32)}get ArrayType(){return Int32Array}}Object.defineProperty(class extends Os{constructor(){super(!0,8)}get ArrayType(){return Int8Array}}.prototype,"ArrayType",{value:Int8Array}),Object.defineProperty(class extends Os{constructor(){super(!0,16)}get ArrayType(){return Int16Array}}.prototype,"ArrayType",{value:Int16Array}),Object.defineProperty(Es.prototype,"ArrayType",{value:Int32Array}),Object.defineProperty(class extends Os{constructor(){super(!0,64)}get ArrayType(){return BigInt64Array}}.prototype,"ArrayType",{value:BigInt64Array}),Object.defineProperty(class extends Os{constructor(){super(!1,8)}get ArrayType(){return Uint8Array}}.prototype,"ArrayType",{value:Uint8Array}),Object.defineProperty(class extends Os{constructor(){super(!1,16)}get ArrayType(){return Uint16Array}}.prototype,"ArrayType",{value:Uint16Array}),Object.defineProperty(class extends Os{constructor(){super(!1,32)}get ArrayType(){return Uint32Array}}.prototype,"ArrayType",{value:Uint32Array}),Object.defineProperty(class extends Os{constructor(){super(!1,64)}get ArrayType(){return BigUint64Array}}.prototype,"ArrayType",{value:BigUint64Array});class Ns extends Cs{constructor(t){super(),this.precision=t}get typeId(){return cn.Float}get ArrayType(){switch(this.precision){case on.HALF:return Uint16Array;case on.SINGLE:return Float32Array;case on.DOUBLE:return Float64Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}toString(){return`Float${this.precision<<5||16}`}}fs=Symbol.toStringTag,Ns[fs]=(t=>(t.precision=null,t[Symbol.toStringTag]="Float"))(Ns.prototype),Object.defineProperty(class extends Ns{constructor(){super(on.HALF)}}.prototype,"ArrayType",{value:Uint16Array}),Object.defineProperty(class extends Ns{constructor(){super(on.SINGLE)}}.prototype,"ArrayType",{value:Float32Array}),Object.defineProperty(class extends Ns{constructor(){super(on.DOUBLE)}}.prototype,"ArrayType",{value:Float64Array});class zs extends Cs{constructor(){super()}get typeId(){return cn.Binary}toString(){return"Binary"}}ps=Symbol.toStringTag,zs[ps]=(t=>(t.ArrayType=Uint8Array,t[Symbol.toStringTag]="Binary"))(zs.prototype);class ks extends Cs{constructor(){super()}get typeId(){return cn.Utf8}toString(){return"Utf8"}}ms=Symbol.toStringTag,ks[ms]=(t=>(t.ArrayType=Uint8Array,t[Symbol.toStringTag]="Utf8"))(ks.prototype);class Ds extends Cs{constructor(){super()}get typeId(){return cn.Bool}toString(){return"Bool"}}_s=Symbol.toStringTag,Ds[_s]=(t=>(t.ArrayType=Uint8Array,t[Symbol.toStringTag]="Bool"))(Ds.prototype);class Fs extends Cs{constructor(t,e,i=128){super(),this.scale=t,this.precision=e,this.bitWidth=i}get typeId(){return cn.Decimal}toString(){return`Decimal[${this.precision}e${this.scale>0?"+":""}${this.scale}]`}}ys=Symbol.toStringTag,Fs[ys]=(t=>(t.scale=null,t.precision=null,t.ArrayType=Uint32Array,t[Symbol.toStringTag]="Decimal"))(Fs.prototype);class Rs extends Cs{constructor(t){super(),this.unit=t}get typeId(){return cn.Date}toString(){return`Date${32*(this.unit+1)}<${an[this.unit]}>`}}gs=Symbol.toStringTag,Rs[gs]=(t=>(t.unit=null,t.ArrayType=Int32Array,t[Symbol.toStringTag]="Date"))(Rs.prototype);class Us extends Cs{constructor(t,e){super(),this.unit=t,this.bitWidth=e}get typeId(){return cn.Time}toString(){return`Time${this.bitWidth}<${hn[this.unit]}>`}get ArrayType(){switch(this.bitWidth){case 32:return Int32Array;case 64:return BigInt64Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}}vs=Symbol.toStringTag,Us[vs]=(t=>(t.unit=null,t.bitWidth=null,t[Symbol.toStringTag]="Time"))(Us.prototype);class Zs extends Cs{constructor(t,e){super(),this.unit=t,this.timezone=e}get typeId(){return cn.Timestamp}toString(){return`Timestamp<${hn[this.unit]}${this.timezone?`, ${this.timezone}`:""}>`}}bs=Symbol.toStringTag,Zs[bs]=(t=>(t.unit=null,t.timezone=null,t.ArrayType=Int32Array,t[Symbol.toStringTag]="Timestamp"))(Zs.prototype);class js extends Cs{constructor(t){super(),this.unit=t}get typeId(){return cn.Interval}toString(){return`Interval<${ln[this.unit]}>`}}ws=Symbol.toStringTag,js[ws]=(t=>(t.unit=null,t.ArrayType=Int32Array,t[Symbol.toStringTag]="Interval"))(js.prototype);class Vs extends Cs{constructor(t){super(),this.children=[t]}get typeId(){return cn.List}toString(){return`List<${this.valueType}>`}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}}xs=Symbol.toStringTag,Vs[xs]=(t=>(t.children=null,t[Symbol.toStringTag]="List"))(Vs.prototype);class Gs extends Cs{constructor(t){super(),this.children=t}get typeId(){return cn.Struct}toString(){return`Struct<{${this.children.map((t=>`${t.name}:${t.type}`)).join(", ")}}>`}}Ms=Symbol.toStringTag,Gs[Ms]=(t=>(t.children=null,t[Symbol.toStringTag]="Struct"))(Gs.prototype);class qs extends Cs{constructor(t,e,i){super(),this.mode=t,this.children=i,this.typeIds=e=Int32Array.from(e),this.typeIdToChildIndex=e.reduce(((t,e,i)=>(t[e]=i)&&t||t),Object.create(null))}get typeId(){return cn.Union}toString(){return`${this[Symbol.toStringTag]}<${this.children.map((t=>`${t.type}`)).join(" | ")}>`}}Ss=Symbol.toStringTag,qs[Ss]=(t=>(t.mode=null,t.typeIds=null,t.children=null,t.typeIdToChildIndex=null,t.ArrayType=Int8Array,t[Symbol.toStringTag]="Union"))(qs.prototype);class Ws extends Cs{constructor(t){super(),this.byteWidth=t}get typeId(){return cn.FixedSizeBinary}toString(){return`FixedSizeBinary[${this.byteWidth}]`}}Is=Symbol.toStringTag,Ws[Is]=(t=>(t.byteWidth=null,t.ArrayType=Uint8Array,t[Symbol.toStringTag]="FixedSizeBinary"))(Ws.prototype);class Hs extends Cs{constructor(t,e){super(),this.listSize=t,this.children=[e]}get typeId(){return cn.FixedSizeList}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}toString(){return`FixedSizeList[${this.listSize}]<${this.valueType}>`}}Ts=Symbol.toStringTag,Hs[Ts]=(t=>(t.children=null,t.listSize=null,t[Symbol.toStringTag]="FixedSizeList"))(Hs.prototype);class $s extends Cs{constructor(t,e=!1){super(),this.children=[t],this.keysSorted=e}get typeId(){return cn.Map}get keyType(){return this.children[0].type.children[0].type}get valueType(){return this.children[0].type.children[1].type}get childType(){return this.children[0].type}toString(){return`Map<{${this.children[0].type.children.map((t=>`${t.name}:${t.type}`)).join(", ")}}>`}}Ls=Symbol.toStringTag,$s[Ls]=(t=>(t.children=null,t.keysSorted=null,t[Symbol.toStringTag]="Map_"))($s.prototype);const Ys=(Xs=-1,()=>++Xs);var Xs;class Ks extends Cs{constructor(t,e,i,n){super(),this.indices=e,this.dictionary=t,this.isOrdered=n||!1,this.id=null==i?Ys():"number"==typeof i?i:i.low}get typeId(){return cn.Dictionary}get children(){return this.dictionary.children}get valueType(){return this.dictionary}get ArrayType(){return this.dictionary.ArrayType}toString(){return`Dictionary<${this.indices}, ${this.dictionary}>`}}function Js(t){const e=t;switch(t.typeId){case cn.Decimal:return t.bitWidth/32;case cn.Timestamp:return 2;case cn.Date:case cn.Interval:return 1+e.unit;case cn.FixedSizeList:return e.listSize;case cn.FixedSizeBinary:return e.byteWidth;default:return 1}}As=Symbol.toStringTag,Ks[As]=(t=>(t.id=null,t.indices=null,t.isOrdered=null,t.dictionary=null,t[Symbol.toStringTag]="Dictionary"))(Ks.prototype);class Qs{visitMany(t,...e){return t.map(((t,i)=>this.visit(t,...e.map((t=>t[i])))))}visit(...t){return this.getVisitFn(t[0],!1).apply(this,t)}getVisitFn(t,e=!0){return function(t,e,i=!0){return"number"==typeof e?tr(t,e,i):"string"==typeof e&&e in cn?tr(t,cn[e],i):e&&e instanceof Cs?tr(t,er(e),i):(null==e?void 0:e.type)&&e.type instanceof Cs?tr(t,er(e.type),i):tr(t,cn.NONE,i)}(this,t,e)}getVisitFnByTypeId(t,e=!0){return tr(this,t,e)}visitNull(t,...e){return null}visitBool(t,...e){return null}visitInt(t,...e){return null}visitFloat(t,...e){return null}visitUtf8(t,...e){return null}visitBinary(t,...e){return null}visitFixedSizeBinary(t,...e){return null}visitDate(t,...e){return null}visitTimestamp(t,...e){return null}visitTime(t,...e){return null}visitDecimal(t,...e){return null}visitList(t,...e){return null}visitStruct(t,...e){return null}visitUnion(t,...e){return null}visitDictionary(t,...e){return null}visitInterval(t,...e){return null}visitFixedSizeList(t,...e){return null}visitMap(t,...e){return null}}function tr(t,e,i=!0){let n=null;switch(e){case cn.Null:n=t.visitNull;break;case cn.Bool:n=t.visitBool;break;case cn.Int:n=t.visitInt;break;case cn.Int8:n=t.visitInt8||t.visitInt;break;case cn.Int16:n=t.visitInt16||t.visitInt;break;case cn.Int32:n=t.visitInt32||t.visitInt;break;case cn.Int64:n=t.visitInt64||t.visitInt;break;case cn.Uint8:n=t.visitUint8||t.visitInt;break;case cn.Uint16:n=t.visitUint16||t.visitInt;break;case cn.Uint32:n=t.visitUint32||t.visitInt;break;case cn.Uint64:n=t.visitUint64||t.visitInt;break;case cn.Float:n=t.visitFloat;break;case cn.Float16:n=t.visitFloat16||t.visitFloat;break;case cn.Float32:n=t.visitFloat32||t.visitFloat;break;case cn.Float64:n=t.visitFloat64||t.visitFloat;break;case cn.Utf8:n=t.visitUtf8;break;case cn.Binary:n=t.visitBinary;break;case cn.FixedSizeBinary:n=t.visitFixedSizeBinary;break;case cn.Date:n=t.visitDate;break;case cn.DateDay:n=t.visitDateDay||t.visitDate;break;case cn.DateMillisecond:n=t.visitDateMillisecond||t.visitDate;break;case cn.Timestamp:n=t.visitTimestamp;break;case cn.TimestampSecond:n=t.visitTimestampSecond||t.visitTimestamp;break;case cn.TimestampMillisecond:n=t.visitTimestampMillisecond||t.visitTimestamp;break;case cn.TimestampMicrosecond:n=t.visitTimestampMicrosecond||t.visitTimestamp;break;case cn.TimestampNanosecond:n=t.visitTimestampNanosecond||t.visitTimestamp;break;case cn.Time:n=t.visitTime;break;case cn.TimeSecond:n=t.visitTimeSecond||t.visitTime;break;case cn.TimeMillisecond:n=t.visitTimeMillisecond||t.visitTime;break;case cn.TimeMicrosecond:n=t.visitTimeMicrosecond||t.visitTime;break;case cn.TimeNanosecond:n=t.visitTimeNanosecond||t.visitTime;break;case cn.Decimal:n=t.visitDecimal;break;case cn.List:n=t.visitList;break;case cn.Struct:n=t.visitStruct;break;case cn.Union:n=t.visitUnion;break;case cn.DenseUnion:n=t.visitDenseUnion||t.visitUnion;break;case cn.SparseUnion:n=t.visitSparseUnion||t.visitUnion;break;case cn.Dictionary:n=t.visitDictionary;break;case cn.Interval:n=t.visitInterval;break;case cn.IntervalDayTime:n=t.visitIntervalDayTime||t.visitInterval;break;case cn.IntervalYearMonth:n=t.visitIntervalYearMonth||t.visitInterval;break;case cn.FixedSizeList:n=t.visitFixedSizeList;break;case cn.Map:n=t.visitMap}if("function"==typeof n)return n;if(!i)return()=>null;throw new Error(`Unrecognized type '${cn[e]}'`)}function er(t){switch(t.typeId){case cn.Null:return cn.Null;case cn.Int:{const{bitWidth:e,isSigned:i}=t;switch(e){case 8:return i?cn.Int8:cn.Uint8;case 16:return i?cn.Int16:cn.Uint16;case 32:return i?cn.Int32:cn.Uint32;case 64:return i?cn.Int64:cn.Uint64}return cn.Int}case cn.Float:switch(t.precision){case on.HALF:return cn.Float16;case on.SINGLE:return cn.Float32;case on.DOUBLE:return cn.Float64}return cn.Float;case cn.Binary:return cn.Binary;case cn.Utf8:return cn.Utf8;case cn.Bool:return cn.Bool;case cn.Decimal:return cn.Decimal;case cn.Time:switch(t.unit){case hn.SECOND:return cn.TimeSecond;case hn.MILLISECOND:return cn.TimeMillisecond;case hn.MICROSECOND:return cn.TimeMicrosecond;case hn.NANOSECOND:return cn.TimeNanosecond}return cn.Time;case cn.Timestamp:switch(t.unit){case hn.SECOND:return cn.TimestampSecond;case hn.MILLISECOND:return cn.TimestampMillisecond;case hn.MICROSECOND:return cn.TimestampMicrosecond;case hn.NANOSECOND:return cn.TimestampNanosecond}return cn.Timestamp;case cn.Date:switch(t.unit){case an.DAY:return cn.DateDay;case an.MILLISECOND:return cn.DateMillisecond}return cn.Date;case cn.Interval:switch(t.unit){case ln.DAY_TIME:return cn.IntervalDayTime;case ln.YEAR_MONTH:return cn.IntervalYearMonth}return cn.Interval;case cn.Map:return cn.Map;case cn.List:return cn.List;case cn.Struct:return cn.Struct;case cn.Union:switch(t.mode){case rn.Dense:return cn.DenseUnion;case rn.Sparse:return cn.SparseUnion}return cn.Union;case cn.FixedSizeBinary:return cn.FixedSizeBinary;case cn.FixedSizeList:return cn.FixedSizeList;case cn.Dictionary:return cn.Dictionary}throw new Error(`Unrecognized type '${cn[t.typeId]}'`)}Qs.prototype.visitInt8=null,Qs.prototype.visitInt16=null,Qs.prototype.visitInt32=null,Qs.prototype.visitInt64=null,Qs.prototype.visitUint8=null,Qs.prototype.visitUint16=null,Qs.prototype.visitUint32=null,Qs.prototype.visitUint64=null,Qs.prototype.visitFloat16=null,Qs.prototype.visitFloat32=null,Qs.prototype.visitFloat64=null,Qs.prototype.visitDateDay=null,Qs.prototype.visitDateMillisecond=null,Qs.prototype.visitTimestampSecond=null,Qs.prototype.visitTimestampMillisecond=null,Qs.prototype.visitTimestampMicrosecond=null,Qs.prototype.visitTimestampNanosecond=null,Qs.prototype.visitTimeSecond=null,Qs.prototype.visitTimeMillisecond=null,Qs.prototype.visitTimeMicrosecond=null,Qs.prototype.visitTimeNanosecond=null,Qs.prototype.visitDenseUnion=null,Qs.prototype.visitSparseUnion=null,Qs.prototype.visitIntervalDayTime=null,Qs.prototype.visitIntervalYearMonth=null;const ir=new Float64Array(1),nr=new Uint32Array(ir.buffer);function sr(t){const e=(31744&t)>>10,i=(1023&t)/1024,n=Math.pow(-1,(32768&t)>>15);switch(e){case 31:return n*(i?Number.NaN:1/0);case 0:return n*(i?6103515625e-14*i:0)}return n*Math.pow(2,e-15)*(1+i)}class rr extends Qs{}function or(t){return(e,i,n)=>{if(e.setValid(i,null!=n))return t(e,i,n)}}const ar=(t,e,i)=>{t[e]=Math.trunc(i%4294967296),t[e+1]=Math.trunc(i/4294967296)},hr=(t,e,i,n)=>{if(i+1<e.length){const{[i]:s,[i+1]:r}=e;t.set(n.subarray(0,r-s),s)}},lr=({values:t},e,i)=>{t[e]=i},ur=({values:t},e,i)=>{t[e]=i},cr=({values:t},e,i)=>{t[e]=function(t){if(t!=t)return 32256;ir[0]=t;const e=(2147483648&nr[1])>>16&65535;let i=2146435072&nr[1],n=0;return i>=1089470464?nr[0]>0?i=31744:(i=(2080374784&i)>>16,n=(1048575&nr[1])>>10):i<=1056964608?(n=1048576+(1048575&nr[1]),n=1048576+(n<<(i>>20)-998)>>21,i=0):(i=i-1056964608>>10,n=512+(1048575&nr[1])>>10),e|i|65535&n}(i)},dr=({values:t},e,i)=>{((t,e,i)=>{t[e]=Math.trunc(i/864e5)})(t,e,i.valueOf())},fr=({values:t},e,i)=>{ar(t,2*e,i.valueOf())},pr=({values:t},e,i)=>ar(t,2*e,i/1e3),mr=({values:t},e,i)=>ar(t,2*e,i),_r=({values:t},e,i)=>((t,e,i)=>{t[e]=Math.trunc(1e3*i%4294967296),t[e+1]=Math.trunc(1e3*i/4294967296)})(t,2*e,i),yr=({values:t},e,i)=>((t,e,i)=>{t[e]=Math.trunc(1e6*i%4294967296),t[e+1]=Math.trunc(1e6*i/4294967296)})(t,2*e,i),gr=({values:t},e,i)=>{t[e]=i},vr=({values:t},e,i)=>{t[e]=i},br=({values:t},e,i)=>{t[e]=i},wr=({values:t},e,i)=>{t[e]=i},xr=(t,e,i)=>{const n=t.type.typeIdToChildIndex[t.typeIds[e]],s=t.children[n];Tr.visit(s,t.valueOffsets[e],i)},Mr=(t,e,i)=>{const n=t.type.typeIdToChildIndex[t.typeIds[e]],s=t.children[n];Tr.visit(s,e,i)},Sr=({values:t},e,i)=>{t.set(i.subarray(0,2),2*e)},Ir=({values:t},e,i)=>{t[e]=12*i[0]+i[1]%12};rr.prototype.visitBool=or((({offset:t,values:e},i,n)=>{const s=t+i;n?e[s>>3]|=1<<s%8:e[s>>3]&=~(1<<s%8)})),rr.prototype.visitInt=or(lr),rr.prototype.visitInt8=or(lr),rr.prototype.visitInt16=or(lr),rr.prototype.visitInt32=or(lr),rr.prototype.visitInt64=or(lr),rr.prototype.visitUint8=or(lr),rr.prototype.visitUint16=or(lr),rr.prototype.visitUint32=or(lr),rr.prototype.visitUint64=or(lr),rr.prototype.visitFloat=or(((t,e,i)=>{switch(t.type.precision){case on.HALF:return cr(t,e,i);case on.SINGLE:case on.DOUBLE:return ur(t,e,i)}})),rr.prototype.visitFloat16=or(cr),rr.prototype.visitFloat32=or(ur),rr.prototype.visitFloat64=or(ur),rr.prototype.visitUtf8=or((({values:t,valueOffsets:e},i,n)=>{hr(t,e,i,Tn(n))})),rr.prototype.visitBinary=or((({values:t,valueOffsets:e},i,n)=>hr(t,e,i,n))),rr.prototype.visitFixedSizeBinary=or((({stride:t,values:e},i,n)=>{e.set(n.subarray(0,t),t*i)})),rr.prototype.visitDate=or(((t,e,i)=>{t.type.unit===an.DAY?dr(t,e,i):fr(t,e,i)})),rr.prototype.visitDateDay=or(dr),rr.prototype.visitDateMillisecond=or(fr),rr.prototype.visitTimestamp=or(((t,e,i)=>{switch(t.type.unit){case hn.SECOND:return pr(t,e,i);case hn.MILLISECOND:return mr(t,e,i);case hn.MICROSECOND:return _r(t,e,i);case hn.NANOSECOND:return yr(t,e,i)}})),rr.prototype.visitTimestampSecond=or(pr),rr.prototype.visitTimestampMillisecond=or(mr),rr.prototype.visitTimestampMicrosecond=or(_r),rr.prototype.visitTimestampNanosecond=or(yr),rr.prototype.visitTime=or(((t,e,i)=>{switch(t.type.unit){case hn.SECOND:return gr(t,e,i);case hn.MILLISECOND:return vr(t,e,i);case hn.MICROSECOND:return br(t,e,i);case hn.NANOSECOND:return wr(t,e,i)}})),rr.prototype.visitTimeSecond=or(gr),rr.prototype.visitTimeMillisecond=or(vr),rr.prototype.visitTimeMicrosecond=or(br),rr.prototype.visitTimeNanosecond=or(wr),rr.prototype.visitDecimal=or((({values:t,stride:e},i,n)=>{t.set(n.subarray(0,e),e*i)})),rr.prototype.visitList=or(((t,e,i)=>{const n=t.children[0],s=t.valueOffsets,r=Tr.getVisitFn(n);if(Array.isArray(i))for(let t=-1,o=s[e],a=s[e+1];o<a;)r(n,o++,i[++t]);else for(let t=-1,o=s[e],a=s[e+1];o<a;)r(n,o++,i.get(++t))})),rr.prototype.visitStruct=or(((t,e,i)=>{const n=t.type.children.map((t=>Tr.getVisitFn(t.type))),s=i instanceof Map?(r=e,o=i,(t,e,i,n)=>e&&t(e,r,o.get(i.name))):i instanceof Vo?((t,e)=>(i,n,s,r)=>n&&i(n,t,e.get(r)))(e,i):Array.isArray(i)?((t,e)=>(i,n,s,r)=>n&&i(n,t,e[r]))(e,i):((t,e)=>(i,n,s,r)=>n&&i(n,t,e[s.name]))(e,i);var r,o;t.type.children.forEach(((e,i)=>s(n[i],t.children[i],e,i)))})),rr.prototype.visitUnion=or(((t,e,i)=>{t.type.mode===rn.Dense?xr(t,e,i):Mr(t,e,i)})),rr.prototype.visitDenseUnion=or(xr),rr.prototype.visitSparseUnion=or(Mr),rr.prototype.visitDictionary=or(((t,e,i)=>{var n;null===(n=t.dictionary)||void 0===n||n.set(t.values[e],i)})),rr.prototype.visitInterval=or(((t,e,i)=>{t.type.unit===ln.DAY_TIME?Sr(t,e,i):Ir(t,e,i)})),rr.prototype.visitIntervalDayTime=or(Sr),rr.prototype.visitIntervalYearMonth=or(Ir),rr.prototype.visitFixedSizeList=or(((t,e,i)=>{const{stride:n}=t,s=t.children[0],r=Tr.getVisitFn(s);if(Array.isArray(i))for(let t=-1,o=e*n;++t<n;)r(s,o+t,i[t]);else for(let t=-1,o=e*n;++t<n;)r(s,o+t,i.get(t))})),rr.prototype.visitMap=or(((t,e,i)=>{const n=t.children[0],{valueOffsets:s}=t,r=Tr.getVisitFn(n);let{[e]:o,[e+1]:a}=s;const h=i instanceof Map?i.entries():Object.entries(i);for(const t of h)if(r(n,o,t),++o>=a)break}));const Tr=new rr,Lr=Symbol.for("parent"),Ar=Symbol.for("rowIndex");class Pr{constructor(t,e){return this[Lr]=t,this[Ar]=e,new Proxy(this,new Br)}toArray(){return Object.values(this.toJSON())}toJSON(){const t=this[Ar],e=this[Lr],i=e.type.children,n={};for(let s=-1,r=i.length;++s<r;)n[i[s].name]=Qr.visit(e.children[s],t);return n}toString(){return`{${[...this].map((([t,e])=>`${yn(t)}: ${yn(e)}`)).join(", ")}}`}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}[Symbol.iterator](){return new Cr(this[Lr],this[Ar])}}class Cr{constructor(t,e){this.childIndex=0,this.children=t.children,this.rowIndex=e,this.childFields=t.type.children,this.numChildren=this.childFields.length}[Symbol.iterator](){return this}next(){const t=this.childIndex;return t<this.numChildren?(this.childIndex=t+1,{done:!1,value:[this.childFields[t].name,Qr.visit(this.children[t],this.rowIndex)]}):{done:!0,value:null}}}Object.defineProperties(Pr.prototype,{[Symbol.toStringTag]:{enumerable:!1,configurable:!1,value:"Row"},[Lr]:{writable:!0,enumerable:!1,configurable:!1,value:null},[Ar]:{writable:!0,enumerable:!1,configurable:!1,value:-1}});class Br{isExtensible(){return!1}deleteProperty(){return!1}preventExtensions(){return!0}ownKeys(t){return t[Lr].type.children.map((t=>t.name))}has(t,e){return-1!==t[Lr].type.children.findIndex((t=>t.name===e))}getOwnPropertyDescriptor(t,e){if(-1!==t[Lr].type.children.findIndex((t=>t.name===e)))return{writable:!0,enumerable:!0,configurable:!0}}get(t,e){if(Reflect.has(t,e))return t[e];const i=t[Lr].type.children.findIndex((t=>t.name===e));if(-1!==i){const n=Qr.visit(t[Lr].children[i],t[Ar]);return Reflect.set(t,e,n),n}}set(t,e,i){const n=t[Lr].type.children.findIndex((t=>t.name===e));return-1!==n?(Tr.visit(t[Lr].children[n],t[Ar],i),Reflect.set(t,e,i)):!(!Reflect.has(t,e)&&"symbol"!=typeof e)&&Reflect.set(t,e,i)}}class Or extends Qs{}function Er(t){return(e,i)=>e.getValid(i)?t(e,i):null}const Nr=(t,e)=>4294967296*t[e+1]+(t[e]>>>0),zr=t=>new Date(t),kr=(t,e,i)=>{if(i+1>=e.length)return null;const n=e[i],s=e[i+1];return t.subarray(n,s)},Dr=({values:t},e)=>((t,e)=>zr(((t,e)=>864e5*t[e])(t,e)))(t,e),Fr=({values:t},e)=>((t,e)=>zr(Nr(t,e)))(t,2*e),Rr=({stride:t,values:e},i)=>e[t*i],Ur=({values:t},e)=>t[e],Zr=({values:t},e)=>1e3*Nr(t,2*e),jr=({values:t},e)=>Nr(t,2*e),Vr=({values:t},e)=>((t,e)=>t[e+1]/1e3*4294967296+(t[e]>>>0)/1e3)(t,2*e),Gr=({values:t},e)=>((t,e)=>t[e+1]/1e6*4294967296+(t[e]>>>0)/1e6)(t,2*e),qr=({values:t},e)=>t[e],Wr=({values:t},e)=>t[e],Hr=({values:t},e)=>t[e],$r=({values:t},e)=>t[e],Yr=(t,e)=>{const i=t.type.typeIdToChildIndex[t.typeIds[e]],n=t.children[i];return Qr.visit(n,t.valueOffsets[e])},Xr=(t,e)=>{const i=t.type.typeIdToChildIndex[t.typeIds[e]],n=t.children[i];return Qr.visit(n,e)},Kr=({values:t},e)=>t.subarray(2*e,2*(e+1)),Jr=({values:t},e)=>{const i=t[e],n=new Int32Array(2);return n[0]=Math.trunc(i/12),n[1]=Math.trunc(i%12),n};Or.prototype.visitNull=Er(((t,e)=>null)),Or.prototype.visitBool=Er((({offset:t,values:e},i)=>{const n=t+i;return 0!=(e[n>>3]&1<<n%8)})),Or.prototype.visitInt=Er((({values:t},e)=>t[e])),Or.prototype.visitInt8=Er(Rr),Or.prototype.visitInt16=Er(Rr),Or.prototype.visitInt32=Er(Rr),Or.prototype.visitInt64=Er(Ur),Or.prototype.visitUint8=Er(Rr),Or.prototype.visitUint16=Er(Rr),Or.prototype.visitUint32=Er(Rr),Or.prototype.visitUint64=Er(Ur),Or.prototype.visitFloat=Er((({type:t,values:e},i)=>t.precision!==on.HALF?e[i]:sr(e[i]))),Or.prototype.visitFloat16=Er((({stride:t,values:e},i)=>sr(e[t*i]))),Or.prototype.visitFloat32=Er(Rr),Or.prototype.visitFloat64=Er(Rr),Or.prototype.visitUtf8=Er((({values:t,valueOffsets:e},i)=>{const n=kr(t,e,i);return null!==n?Sn(n):null})),Or.prototype.visitBinary=Er((({values:t,valueOffsets:e},i)=>kr(t,e,i))),Or.prototype.visitFixedSizeBinary=Er((({stride:t,values:e},i)=>e.subarray(t*i,t*(i+1)))),Or.prototype.visitDate=Er(((t,e)=>t.type.unit===an.DAY?Dr(t,e):Fr(t,e))),Or.prototype.visitDateDay=Er(Dr),Or.prototype.visitDateMillisecond=Er(Fr),Or.prototype.visitTimestamp=Er(((t,e)=>{switch(t.type.unit){case hn.SECOND:return Zr(t,e);case hn.MILLISECOND:return jr(t,e);case hn.MICROSECOND:return Vr(t,e);case hn.NANOSECOND:return Gr(t,e)}})),Or.prototype.visitTimestampSecond=Er(Zr),Or.prototype.visitTimestampMillisecond=Er(jr),Or.prototype.visitTimestampMicrosecond=Er(Vr),Or.prototype.visitTimestampNanosecond=Er(Gr),Or.prototype.visitTime=Er(((t,e)=>{switch(t.type.unit){case hn.SECOND:return qr(t,e);case hn.MILLISECOND:return Wr(t,e);case hn.MICROSECOND:return Hr(t,e);case hn.NANOSECOND:return $r(t,e)}})),Or.prototype.visitTimeSecond=Er(qr),Or.prototype.visitTimeMillisecond=Er(Wr),Or.prototype.visitTimeMicrosecond=Er(Hr),Or.prototype.visitTimeNanosecond=Er($r),Or.prototype.visitDecimal=Er((({values:t,stride:e},i)=>ls.decimal(t.subarray(e*i,e*(i+1))))),Or.prototype.visitList=Er(((t,e)=>{const{valueOffsets:i,stride:n,children:s}=t,{[e*n]:r,[e*n+1]:o}=i,a=s[0].slice(r,o-r);return new Vo([a])})),Or.prototype.visitStruct=Er(((t,e)=>new Pr(t,e))),Or.prototype.visitUnion=Er(((t,e)=>t.type.mode===rn.Dense?Yr(t,e):Xr(t,e))),Or.prototype.visitDenseUnion=Er(Yr),Or.prototype.visitSparseUnion=Er(Xr),Or.prototype.visitDictionary=Er(((t,e)=>{var i;return null===(i=t.dictionary)||void 0===i?void 0:i.get(t.values[e])})),Or.prototype.visitInterval=Er(((t,e)=>t.type.unit===ln.DAY_TIME?Kr(t,e):Jr(t,e))),Or.prototype.visitIntervalDayTime=Er(Kr),Or.prototype.visitIntervalYearMonth=Er(Jr),Or.prototype.visitFixedSizeList=Er(((t,e)=>{const{stride:i,children:n}=t,s=n[0].slice(e*i,i);return new Vo([s])})),Or.prototype.visitMap=Er(((t,e)=>{const{valueOffsets:i,children:n}=t,{[e]:s,[e+1]:r}=i,o=n[0];return new io(o.slice(s,r-s))}));const Qr=new Or,to=Symbol.for("keys"),eo=Symbol.for("vals");class io{constructor(t){return this[to]=new Vo([t.children[0]]).memoize(),this[eo]=t.children[1],new Proxy(this,new so)}[Symbol.iterator](){return new no(this[to],this[eo])}get size(){return this[to].length}toArray(){return Object.values(this.toJSON())}toJSON(){const t=this[to],e=this[eo],i={};for(let n=-1,s=t.length;++n<s;)i[t.get(n)]=Qr.visit(e,n);return i}toString(){return`{${[...this].map((([t,e])=>`${yn(t)}: ${yn(e)}`)).join(", ")}}`}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}}class no{constructor(t,e){this.keys=t,this.vals=e,this.keyIndex=0,this.numKeys=t.length}[Symbol.iterator](){return this}next(){const t=this.keyIndex;return t===this.numKeys?{done:!0,value:null}:(this.keyIndex++,{done:!1,value:[this.keys.get(t),Qr.visit(this.vals,t)]})}}class so{isExtensible(){return!1}deleteProperty(){return!1}preventExtensions(){return!0}ownKeys(t){return t[to].toArray().map(String)}has(t,e){return t[to].includes(e)}getOwnPropertyDescriptor(t,e){if(-1!==t[to].indexOf(e))return{writable:!0,enumerable:!0,configurable:!0}}get(t,e){if(Reflect.has(t,e))return t[e];const i=t[to].indexOf(e);if(-1!==i){const n=Qr.visit(Reflect.get(t,eo),i);return Reflect.set(t,e,n),n}}set(t,e,i){const n=t[to].indexOf(e);return-1!==n?(Tr.visit(Reflect.get(t,eo),n,i),Reflect.set(t,e,i)):!!Reflect.has(t,e)&&Reflect.set(t,e,i)}}let ro;function oo(t,e,i,n){const{length:s=0}=t;let r="number"!=typeof e?0:e,o="number"!=typeof i?s:i;return r<0&&(r=(r%s+s)%s),o<0&&(o=(o%s+s)%s),o<r&&(ro=r,r=o,o=ro),o>s&&(o=s),n?n(t,r,o):[r,o]}Object.defineProperties(io.prototype,{[Symbol.toStringTag]:{enumerable:!1,configurable:!1,value:"Row"},[to]:{writable:!0,enumerable:!1,configurable:!1,value:null},[eo]:{writable:!0,enumerable:!1,configurable:!1,value:null}});const ao=t=>t!=t;function ho(t){if("object"!=typeof t||null===t)return ao(t)?ao:e=>e===t;if(t instanceof Date){const e=t.valueOf();return t=>t instanceof Date&&t.valueOf()===e}return ArrayBuffer.isView(t)?e=>!!e&&function(t,e){let i=0;const n=t.length;if(n!==e.length)return!1;if(n>0)do{if(t[i]!==e[i])return!1}while(++i<n);return!0}(t,e):t instanceof Map?function(t){let e=-1;const i=[];for(const n of t.values())i[++e]=ho(n);return lo(i)}(t):Array.isArray(t)?function(t){const e=[];for(let i=-1,n=t.length;++i<n;)e[i]=ho(t[i]);return lo(e)}(t):t instanceof Vo?function(t){const e=[];for(let i=-1,n=t.length;++i<n;)e[i]=ho(t.get(i));return lo(e)}(t):function(t,e=!1){const i=Object.keys(t);if(!e&&0===i.length)return()=>!1;const n=[];for(let e=-1,s=i.length;++e<s;)n[e]=ho(t[i[e]]);return lo(n,i)}(t,!0)}function lo(t,e){return i=>{if(!i||"object"!=typeof i)return!1;switch(i.constructor){case Array:return function(t,e){const i=t.length;if(e.length!==i)return!1;for(let n=-1;++n<i;)if(!t[n](e[n]))return!1;return!0}(t,i);case Map:return uo(t,i,i.keys());case io:case Pr:case Object:case void 0:return uo(t,i,e||Object.keys(i))}return i instanceof Vo&&function(t,e){const i=t.length;if(e.length!==i)return!1;for(let n=-1;++n<i;)if(!t[n](e.get(n)))return!1;return!0}(t,i)}}function uo(t,e,i){const n=i[Symbol.iterator](),s=e instanceof Map?e.keys():Object.keys(e)[Symbol.iterator](),r=e instanceof Map?e.values():Object.values(e)[Symbol.iterator]();let o=0;const a=t.length;let h=r.next(),l=n.next(),u=s.next();for(;o<a&&!l.done&&!u.done&&!h.done&&l.value===u.value&&t[o](h.value);++o,l=n.next(),u=s.next(),h=r.next());return!!(o===a&&l.done&&u.done&&h.done)||(n.return&&n.return(),s.return&&s.return(),r.return&&r.return(),!1)}class co{constructor(t=0,e){this.numChunks=t,this.getChunkIterator=e,this.chunkIndex=0,this.chunkIterator=this.getChunkIterator(0)}next(){for(;this.chunkIndex<this.numChunks;){const t=this.chunkIterator.next();if(!t.done)return t;++this.chunkIndex<this.numChunks&&(this.chunkIterator=this.getChunkIterator(this.chunkIndex))}return{done:!0,value:null}}[Symbol.iterator](){return this}}function fo(t){return t.reduce(((t,e)=>t+e.nullCount),0)}function po(t){return t.reduce(((t,e,i)=>(t[i+1]=t[i]+e.length,t)),new Uint32Array(t.length+1))}function mo(t,e,i,n){const s=[];for(let r=-1,o=t.length;++r<o;){const o=t[r],a=e[r],{length:h}=o;if(a>=n)break;if(i>=a+h)continue;if(a>=i&&a+h<=n){s.push(o);continue}const l=Math.max(0,i-a),u=Math.min(n-a,h);s.push(o.slice(l,u-l))}return 0===s.length&&s.push(t[0].slice(0,0)),s}function _o(t,e,i,n){let s=0,r=0,o=e.length-1;do{if(s>=o-1)return i<e[o]?n(t,s,i-e[s]):null;r=s+Math.trunc(.5*(o-s)),i<e[r]?o=r:s=r}while(s<o)}function yo(t,e){return t.getValid(e)}function go(t){function e(e,i,n){return t(e[i],n)}return function(t){return _o(this.data,this._offsets,t,e)}}function vo(t){let e;function i(i,n,s){return t(i[n],s,e)}return function(t,n){const s=this.data;e=n;const r=_o(s,this._offsets,t,i);return e=void 0,r}}function bo(t){let e;function i(i,n,s){let r=s,o=0,a=0;for(let s=n-1,h=i.length;++s<h;){const n=i[s];if(~(o=t(n,e,r)))return a+o;r=0,a+=n.length}return-1}return function(t,n){e=t;const s=this.data,r="number"!=typeof n?i(s,0,0):_o(s,this._offsets,n,i);return e=void 0,r}}function wo(t,e,i,n){return 0!=(i&1<<n)}function xo(t,e,i,n){return(i&1<<n)>>n}function Mo(t){const e=[];let i=0,n=0,s=0;for(const r of t)r&&(s|=1<<n),8==++n&&(e[i++]=s,s=n=0);(0===i||n>0)&&(e[i++]=s);const r=new Uint8Array(e.length+7&-8);return r.set(e),r}class So{constructor(t,e,i,n,s){this.bytes=t,this.length=i,this.context=n,this.get=s,this.bit=e%8,this.byteIndex=e>>3,this.byte=t[this.byteIndex++],this.index=0}next(){return this.index<this.length?(8===this.bit&&(this.bit=0,this.byte=this.bytes[this.byteIndex++]),{value:this.get(this.context,this.index++,this.byte,this.bit++)}):{done:!0,value:null}}[Symbol.iterator](){return this}}function Io(t,e,i){if(i-e<=0)return 0;if(i-e<8){let n=0;for(const s of new So(t,e,i-e,t,xo))n+=s;return n}const n=i>>3<<3,s=e+(e%8==0?0:8-e%8);return Io(t,e,s)+Io(t,n,i)+function(t,e,i){let n=0,s=Math.trunc(e);const r=new DataView(t.buffer,t.byteOffset,t.byteLength),o=void 0===i?t.byteLength:s+i;for(;o-s>=4;)n+=To(r.getUint32(s)),s+=4;for(;o-s>=2;)n+=To(r.getUint16(s)),s+=2;for(;o-s>=1;)n+=To(r.getUint8(s)),s+=1;return n}(t,s>>3,n-s>>3)}function To(t){let e=Math.trunc(t);return e-=e>>>1&1431655765,e=(858993459&e)+(e>>>2&858993459),16843009*(e+(e>>>4)&252645135)>>>24}class Lo extends Qs{}function Ao(t,e,i){if(void 0===e)return-1;if(null===e)return function(t,e){const{nullBitmap:i}=t;if(!i||t.nullCount<=0)return-1;let n=0;for(const s of new So(i,t.offset+(e||0),t.length,i,wo)){if(!s)return n;++n}return-1}(t,i);const n=Qr.getVisitFn(t),s=ho(e);for(let e=(i||0)-1,r=t.length;++e<r;)if(s(n(t,e)))return e;return-1}function Po(t,e,i){const n=Qr.getVisitFn(t),s=ho(e);for(let e=(i||0)-1,r=t.length;++e<r;)if(s(n(t,e)))return e;return-1}Lo.prototype.visitNull=function(t,e){return null===e&&t.length>0?0:-1},Lo.prototype.visitBool=Ao,Lo.prototype.visitInt=Ao,Lo.prototype.visitInt8=Ao,Lo.prototype.visitInt16=Ao,Lo.prototype.visitInt32=Ao,Lo.prototype.visitInt64=Ao,Lo.prototype.visitUint8=Ao,Lo.prototype.visitUint16=Ao,Lo.prototype.visitUint32=Ao,Lo.prototype.visitUint64=Ao,Lo.prototype.visitFloat=Ao,Lo.prototype.visitFloat16=Ao,Lo.prototype.visitFloat32=Ao,Lo.prototype.visitFloat64=Ao,Lo.prototype.visitUtf8=Ao,Lo.prototype.visitBinary=Ao,Lo.prototype.visitFixedSizeBinary=Ao,Lo.prototype.visitDate=Ao,Lo.prototype.visitDateDay=Ao,Lo.prototype.visitDateMillisecond=Ao,Lo.prototype.visitTimestamp=Ao,Lo.prototype.visitTimestampSecond=Ao,Lo.prototype.visitTimestampMillisecond=Ao,Lo.prototype.visitTimestampMicrosecond=Ao,Lo.prototype.visitTimestampNanosecond=Ao,Lo.prototype.visitTime=Ao,Lo.prototype.visitTimeSecond=Ao,Lo.prototype.visitTimeMillisecond=Ao,Lo.prototype.visitTimeMicrosecond=Ao,Lo.prototype.visitTimeNanosecond=Ao,Lo.prototype.visitDecimal=Ao,Lo.prototype.visitList=Ao,Lo.prototype.visitStruct=Ao,Lo.prototype.visitUnion=Ao,Lo.prototype.visitDenseUnion=Po,Lo.prototype.visitSparseUnion=Po,Lo.prototype.visitDictionary=Ao,Lo.prototype.visitInterval=Ao,Lo.prototype.visitIntervalDayTime=Ao,Lo.prototype.visitIntervalYearMonth=Ao,Lo.prototype.visitFixedSizeList=Ao,Lo.prototype.visitMap=Ao;const Co=new Lo;class Bo extends Qs{}function Oo(t){const{type:e}=t;if(0===t.nullCount&&1===t.stride&&(e.typeId===cn.Timestamp||e instanceof Os&&64!==e.bitWidth||e instanceof Us&&64!==e.bitWidth||e instanceof Ns&&e.precision!==on.HALF))return new co(t.data.length,(e=>{const i=t.data[e];return i.values.subarray(0,i.length)[Symbol.iterator]()}));let i=0;return new co(t.data.length,(e=>{const n=t.data[e].length,s=t.slice(i,i+n);return i+=n,new Eo(s)}))}class Eo{constructor(t){this.vector=t,this.index=0}next(){return this.index<this.vector.length?{value:this.vector.get(this.index++)}:{done:!0,value:null}}[Symbol.iterator](){return this}}Bo.prototype.visitNull=Oo,Bo.prototype.visitBool=Oo,Bo.prototype.visitInt=Oo,Bo.prototype.visitInt8=Oo,Bo.prototype.visitInt16=Oo,Bo.prototype.visitInt32=Oo,Bo.prototype.visitInt64=Oo,Bo.prototype.visitUint8=Oo,Bo.prototype.visitUint16=Oo,Bo.prototype.visitUint32=Oo,Bo.prototype.visitUint64=Oo,Bo.prototype.visitFloat=Oo,Bo.prototype.visitFloat16=Oo,Bo.prototype.visitFloat32=Oo,Bo.prototype.visitFloat64=Oo,Bo.prototype.visitUtf8=Oo,Bo.prototype.visitBinary=Oo,Bo.prototype.visitFixedSizeBinary=Oo,Bo.prototype.visitDate=Oo,Bo.prototype.visitDateDay=Oo,Bo.prototype.visitDateMillisecond=Oo,Bo.prototype.visitTimestamp=Oo,Bo.prototype.visitTimestampSecond=Oo,Bo.prototype.visitTimestampMillisecond=Oo,Bo.prototype.visitTimestampMicrosecond=Oo,Bo.prototype.visitTimestampNanosecond=Oo,Bo.prototype.visitTime=Oo,Bo.prototype.visitTimeSecond=Oo,Bo.prototype.visitTimeMillisecond=Oo,Bo.prototype.visitTimeMicrosecond=Oo,Bo.prototype.visitTimeNanosecond=Oo,Bo.prototype.visitDecimal=Oo,Bo.prototype.visitList=Oo,Bo.prototype.visitStruct=Oo,Bo.prototype.visitUnion=Oo,Bo.prototype.visitDenseUnion=Oo,Bo.prototype.visitSparseUnion=Oo,Bo.prototype.visitDictionary=Oo,Bo.prototype.visitInterval=Oo,Bo.prototype.visitIntervalDayTime=Oo,Bo.prototype.visitIntervalYearMonth=Oo,Bo.prototype.visitFixedSizeList=Oo,Bo.prototype.visitMap=Oo;const No=new Bo,zo=(t,e)=>t+e;class ko extends Qs{visitNull(t,e){return 0}visitInt(t,e){return t.type.bitWidth/8}visitFloat(t,e){return t.type.ArrayType.BYTES_PER_ELEMENT}visitBool(t,e){return 1/8}visitDecimal(t,e){return t.type.bitWidth/8}visitDate(t,e){return 4*(t.type.unit+1)}visitTime(t,e){return t.type.bitWidth/8}visitTimestamp(t,e){return t.type.unit===hn.SECOND?4:8}visitInterval(t,e){return 4*(t.type.unit+1)}visitStruct(t,e){return t.children.reduce(((t,i)=>t+Ro.visit(i,e)),0)}visitFixedSizeBinary(t,e){return t.type.byteWidth}visitMap(t,e){return 8+t.children.reduce(((t,i)=>t+Ro.visit(i,e)),0)}visitDictionary(t,e){var i;return t.type.indices.bitWidth/8+((null===(i=t.dictionary)||void 0===i?void 0:i.getByteLength(t.values[e]))||0)}}const Do=({type:t,children:e,typeIds:i,valueOffsets:n},s)=>{const r=t.typeIdToChildIndex[i[s]];return 8+Ro.visit(e[r],n[s])},Fo=({children:t},e)=>4+Ro.visitMany(t,t.map((()=>e))).reduce(zo,0);ko.prototype.visitUtf8=({valueOffsets:t},e)=>t[e+1]-t[e]+8,ko.prototype.visitBinary=({valueOffsets:t},e)=>t[e+1]-t[e]+8,ko.prototype.visitList=({valueOffsets:t,stride:e,children:i},n)=>{const s=i[0],{[n*e]:r}=t,{[n*e+1]:o}=t,a=Ro.getVisitFn(s.type),h=s.slice(r,o-r);let l=8;for(let t=-1,e=o-r;++t<e;)l+=a(h,t);return l},ko.prototype.visitFixedSizeList=({stride:t,children:e},i)=>{const n=e[0],s=n.slice(i*t,t),r=Ro.getVisitFn(n.type);let o=0;for(let t=-1,e=s.length;++t<e;)o+=r(s,t);return o},ko.prototype.visitUnion=(t,e)=>t.type.mode===rn.Dense?Do(t,e):Fo(t,e),ko.prototype.visitDenseUnion=Do,ko.prototype.visitSparseUnion=Fo;const Ro=new ko;var Uo;const Zo={},jo={};class Vo{constructor(t){var e,i,n;const s=t[0]instanceof Vo?t.flatMap((t=>t.data)):t;if(0===s.length||s.some((t=>!(t instanceof qo))))throw new TypeError("Vector constructor expects an Array of Data instances.");const r=null===(e=s[0])||void 0===e?void 0:e.type;switch(s.length){case 0:this._offsets=[0];break;case 1:{const{get:t,set:e,indexOf:i,byteLength:n}=Zo[r.typeId],o=s[0];this.isValid=t=>yo(o,t),this.get=e=>t(o,e),this.set=(t,i)=>e(o,t,i),this.indexOf=t=>i(o,t),this.getByteLength=t=>n(o,t),this._offsets=[0,o.length];break}default:Object.setPrototypeOf(this,jo[r.typeId]),this._offsets=po(s)}this.data=s,this.type=r,this.stride=Js(r),this.numChildren=null!==(n=null===(i=r.children)||void 0===i?void 0:i.length)&&void 0!==n?n:0,this.length=this._offsets[this._offsets.length-1]}get byteLength(){return-1===this._byteLength&&(this._byteLength=this.data.reduce(((t,e)=>t+e.byteLength),0)),this._byteLength}get nullCount(){return-1===this._nullCount&&(this._nullCount=fo(this.data)),this._nullCount}get ArrayType(){return this.type.ArrayType}get[Symbol.toStringTag](){return`${this.VectorName}<${this.type[Symbol.toStringTag]}>`}get VectorName(){return`${cn[this.type.typeId]}Vector`}isValid(t){return!1}get(t){return null}set(t,e){}indexOf(t,e){return-1}includes(t,e){return this.indexOf(t,e)>0}getByteLength(t){return 0}[Symbol.iterator](){return No.visit(this)}concat(...t){return new Vo(this.data.concat(t.flatMap((t=>t.data)).flat(Number.POSITIVE_INFINITY)))}slice(t,e){return new Vo(oo(this,t,e,(({data:t,_offsets:e},i,n)=>mo(t,e,i,n))))}toJSON(){return[...this]}toArray(){const{type:t,data:e,length:i,stride:n,ArrayType:s}=this;switch(t.typeId){case cn.Int:case cn.Float:case cn.Decimal:case cn.Time:case cn.Timestamp:switch(e.length){case 0:return new s;case 1:return e[0].values.subarray(0,i*n);default:return e.reduce(((t,{values:e})=>(t.array.set(e,t.offset),t.offset+=e.length,t)),{array:new s(i*n),offset:0}).array}}return[...this]}toString(){return`[${[...this].join(",")}]`}getChild(t){var e;return this.getChildAt(null===(e=this.type.children)||void 0===e?void 0:e.findIndex((e=>e.name===t)))}getChildAt(t){return t>-1&&t<this.numChildren?new Vo(this.data.map((({children:e})=>e[t]))):null}get isMemoized(){return!!Cs.isDictionary(this.type)&&this.data[0].dictionary.isMemoized}memoize(){if(Cs.isDictionary(this.type)){const t=new Go(this.data[0].dictionary),e=this.data.map((e=>{const i=e.clone();return i.dictionary=t,i}));return new Vo(e)}return new Go(this)}unmemoize(){if(Cs.isDictionary(this.type)&&this.isMemoized){const t=this.data[0].dictionary.unmemoize(),e=this.data.map((e=>{const i=e.clone();return i.dictionary=t,i}));return new Vo(e)}return this}}Uo=Symbol.toStringTag,Vo[Uo]=(t=>{t.type=Cs.prototype,t.data=[],t.length=0,t.stride=1,t.numChildren=0,t._nullCount=-1,t._byteLength=-1,t._offsets=new Uint32Array([0]),t[Symbol.isConcatSpreadable]=!0;const e=Object.keys(cn).map((t=>cn[t])).filter((t=>"number"==typeof t&&t!==cn.NONE));for(const i of e){const e=Qr.getVisitFnByTypeId(i),n=Tr.getVisitFnByTypeId(i),s=Co.getVisitFnByTypeId(i),r=Ro.getVisitFnByTypeId(i);Zo[i]={get:e,set:n,indexOf:s,byteLength:r},jo[i]=Object.create(t,{isValid:{value:go(yo)},get:{value:go(Qr.getVisitFnByTypeId(i))},set:{value:vo(Tr.getVisitFnByTypeId(i))},indexOf:{value:bo(Co.getVisitFnByTypeId(i))},getByteLength:{value:go(Ro.getVisitFnByTypeId(i))}})}return"Vector"})(Vo.prototype);class Go extends Vo{constructor(t){super(t.data);const e=this.get,i=this.set,n=this.slice,s=new Array(this.length);Object.defineProperty(this,"get",{value(t){const i=s[t];if(void 0!==i)return i;const n=e.call(this,t);return s[t]=n,n}}),Object.defineProperty(this,"set",{value(t,e){i.call(this,t,e),s[t]=e}}),Object.defineProperty(this,"slice",{value:(t,e)=>new Go(n.call(this,t,e))}),Object.defineProperty(this,"isMemoized",{value:!0}),Object.defineProperty(this,"unmemoize",{value:()=>new Vo(this.data)}),Object.defineProperty(this,"memoize",{value:()=>this})}}class qo{constructor(t,e,i,n,s,r=[],o){let a;this.type=t,this.children=r,this.dictionary=o,this.offset=Math.floor(Math.max(e||0,0)),this.length=Math.floor(Math.max(i||0,0)),this._nullCount=Math.floor(Math.max(n||0,-1)),s instanceof qo?(this.stride=s.stride,this.values=s.values,this.typeIds=s.typeIds,this.nullBitmap=s.nullBitmap,this.valueOffsets=s.valueOffsets):(this.stride=Js(t),s&&((a=s[0])&&(this.valueOffsets=a),(a=s[1])&&(this.values=a),(a=s[2])&&(this.nullBitmap=a),(a=s[3])&&(this.typeIds=a))),this.nullable=0!==this._nullCount&&this.nullBitmap&&this.nullBitmap.byteLength>0}get typeId(){return this.type.typeId}get ArrayType(){return this.type.ArrayType}get buffers(){return[this.valueOffsets,this.values,this.nullBitmap,this.typeIds]}get byteLength(){let t=0;const{valueOffsets:e,values:i,nullBitmap:n,typeIds:s}=this;return e&&(t+=e.byteLength),i&&(t+=i.byteLength),n&&(t+=n.byteLength),s&&(t+=s.byteLength),this.children.reduce(((t,e)=>t+e.byteLength),t)}get nullCount(){let t,e=this._nullCount;return e<=-1&&(t=this.nullBitmap)&&(this._nullCount=e=this.length-Io(t,this.offset,this.offset+this.length)),e}getValid(t){if(this.nullable&&this.nullCount>0){const e=this.offset+t;return 0!=(this.nullBitmap[e>>3]&1<<e%8)}return!0}setValid(t,e){if(!this.nullable)return e;if(!this.nullBitmap||this.nullBitmap.byteLength<=t>>3){const{nullBitmap:t}=this._changeLengthAndBackfillNullBitmap(this.length);Object.assign(this,{nullBitmap:t,_nullCount:0})}const{nullBitmap:i,offset:n}=this,s=n+t>>3,r=(n+t)%8,o=i[s]>>r&1;return e?0===o&&(i[s]|=1<<r,this._nullCount=this.nullCount+1):1===o&&(i[s]&=~(1<<r),this._nullCount=this.nullCount-1),e}clone(t=this.type,e=this.offset,i=this.length,n=this._nullCount,s=this,r=this.children){return new qo(t,e,i,n,s,r,this.dictionary)}slice(t,e){const{stride:i,typeId:n,children:s}=this,r=+(0===this._nullCount)-1,o=16===n?i:1,a=this._sliceBuffers(t,e,i,n);return this.clone(this.type,this.offset+t,e,r,a,0===s.length||this.valueOffsets?s:this._sliceChildren(s,o*t,o*e))}_changeLengthAndBackfillNullBitmap(t){if(this.typeId===cn.Null)return this.clone(this.type,0,t,0);const{length:e,nullCount:i}=this,n=new Uint8Array((t+63&-64)>>3).fill(255,0,e>>3);n[e>>3]=(1<<e-(-8&e))-1,i>0&&n.set(function(t,e,i){const n=i.byteLength+7&-8;if(t>0||i.byteLength<n){const s=new Uint8Array(n);return s.set(t%8==0?i.subarray(t>>3):Mo(new So(i,t,e,null,wo)).subarray(0,n)),s}return i}(this.offset,e,this.nullBitmap),0);const s=this.buffers;return s[dn.VALIDITY]=n,this.clone(this.type,0,t,i+(t-e),s)}_sliceBuffers(t,e,i,n){let s;const{buffers:r}=this;return(s=r[dn.TYPE])&&(r[dn.TYPE]=s.subarray(t,t+e)),(s=r[dn.OFFSET])&&(r[dn.OFFSET]=s.subarray(t,t+e+1))||(s=r[dn.DATA])&&(r[dn.DATA]=6===n?s:s.subarray(i*t,i*(t+e))),r}_sliceChildren(t,e,i){return t.map((t=>t.slice(e,i)))}}qo.prototype.children=Object.freeze([]);class Wo extends Qs{visit(t){return this.getVisitFn(t.type).call(this,t)}visitNull(t){const{type:e,offset:i=0,length:n=0}=t;return new qo(e,i,n,0)}visitBool(t){const{type:e,offset:i=0}=t,n=Kn(t.nullBitmap),s=Yn(e.ArrayType,t.data),{length:r=s.length>>3,nullCount:o=(t.nullBitmap?-1:0)}=t;return new qo(e,i,r,o,[void 0,s,n])}visitInt(t){const{type:e,offset:i=0}=t,n=Kn(t.nullBitmap),s=Yn(e.ArrayType,t.data),{length:r=s.length,nullCount:o=(t.nullBitmap?-1:0)}=t;return new qo(e,i,r,o,[void 0,s,n])}visitFloat(t){const{type:e,offset:i=0}=t,n=Kn(t.nullBitmap),s=Yn(e.ArrayType,t.data),{length:r=s.length,nullCount:o=(t.nullBitmap?-1:0)}=t;return new qo(e,i,r,o,[void 0,s,n])}visitUtf8(t){const{type:e,offset:i=0}=t,n=Kn(t.data),s=Kn(t.nullBitmap),r=Xn(t.valueOffsets),{length:o=r.length-1,nullCount:a=(t.nullBitmap?-1:0)}=t;return new qo(e,i,o,a,[r,n,s])}visitBinary(t){const{type:e,offset:i=0}=t,n=Kn(t.data),s=Kn(t.nullBitmap),r=Xn(t.valueOffsets),{length:o=r.length-1,nullCount:a=(t.nullBitmap?-1:0)}=t;return new qo(e,i,o,a,[r,n,s])}visitFixedSizeBinary(t){const{type:e,offset:i=0}=t,n=Kn(t.nullBitmap),s=Yn(e.ArrayType,t.data),{length:r=s.length/Js(e),nullCount:o=(t.nullBitmap?-1:0)}=t;return new qo(e,i,r,o,[void 0,s,n])}visitDate(t){const{type:e,offset:i=0}=t,n=Kn(t.nullBitmap),s=Yn(e.ArrayType,t.data),{length:r=s.length/Js(e),nullCount:o=(t.nullBitmap?-1:0)}=t;return new qo(e,i,r,o,[void 0,s,n])}visitTimestamp(t){const{type:e,offset:i=0}=t,n=Kn(t.nullBitmap),s=Yn(e.ArrayType,t.data),{length:r=s.length/Js(e),nullCount:o=(t.nullBitmap?-1:0)}=t;return new qo(e,i,r,o,[void 0,s,n])}visitTime(t){const{type:e,offset:i=0}=t,n=Kn(t.nullBitmap),s=Yn(e.ArrayType,t.data),{length:r=s.length/Js(e),nullCount:o=(t.nullBitmap?-1:0)}=t;return new qo(e,i,r,o,[void 0,s,n])}visitDecimal(t){const{type:e,offset:i=0}=t,n=Kn(t.nullBitmap),s=Yn(e.ArrayType,t.data),{length:r=s.length/Js(e),nullCount:o=(t.nullBitmap?-1:0)}=t;return new qo(e,i,r,o,[void 0,s,n])}visitList(t){const{type:e,offset:i=0,child:n}=t,s=Kn(t.nullBitmap),r=Xn(t.valueOffsets),{length:o=r.length-1,nullCount:a=(t.nullBitmap?-1:0)}=t;return new qo(e,i,o,a,[r,void 0,s],[n])}visitStruct(t){const{type:e,offset:i=0,children:n=[]}=t,s=Kn(t.nullBitmap),{length:r=n.reduce(((t,{length:e})=>Math.max(t,e)),0),nullCount:o=(t.nullBitmap?-1:0)}=t;return new qo(e,i,r,o,[void 0,void 0,s],n)}visitUnion(t){const{type:e,offset:i=0,children:n=[]}=t,s=Kn(t.nullBitmap),r=Yn(e.ArrayType,t.typeIds),{length:o=r.length,nullCount:a=(t.nullBitmap?-1:0)}=t;if(Cs.isSparseUnion(e))return new qo(e,i,o,a,[void 0,void 0,s,r],n);const h=Xn(t.valueOffsets);return new qo(e,i,o,a,[h,void 0,s,r],n)}visitDictionary(t){const{type:e,offset:i=0}=t,n=Kn(t.nullBitmap),s=Yn(e.indices.ArrayType,t.data),{dictionary:r=new Vo([(new Wo).visit({type:e.dictionary})])}=t,{length:o=s.length,nullCount:a=(t.nullBitmap?-1:0)}=t;return new qo(e,i,o,a,[void 0,s,n],[],r)}visitInterval(t){const{type:e,offset:i=0}=t,n=Kn(t.nullBitmap),s=Yn(e.ArrayType,t.data),{length:r=s.length/Js(e),nullCount:o=(t.nullBitmap?-1:0)}=t;return new qo(e,i,r,o,[void 0,s,n])}visitFixedSizeList(t){const{type:e,offset:i=0,child:n=(new Wo).visit({type:e.valueType})}=t,s=Kn(t.nullBitmap),{length:r=n.length/Js(e),nullCount:o=(t.nullBitmap?-1:0)}=t;return new qo(e,i,r,o,[void 0,void 0,s],[n])}visitMap(t){const{type:e,offset:i=0,child:n=(new Wo).visit({type:e.childType})}=t,s=Kn(t.nullBitmap),r=Xn(t.valueOffsets),{length:o=r.length-1,nullCount:a=(t.nullBitmap?-1:0)}=t;return new qo(e,i,o,a,[r,void 0,s],[n])}}function Ho(t){return(new Wo).visit(t)}class $o{constructor(t=[],e,i){this.fields=t||[],this.metadata=e||new Map,i||(i=Ko(t)),this.dictionaries=i}get[Symbol.toStringTag](){return"Schema"}get names(){return this.fields.map((t=>t.name))}toString(){return`Schema<{ ${this.fields.map(((t,e)=>`${e}: ${t}`)).join(", ")} }>`}select(t){const e=new Set(t),i=this.fields.filter((t=>e.has(t.name)));return new $o(i,this.metadata)}selectAt(t){const e=t.map((t=>this.fields[t])).filter(Boolean);return new $o(e,this.metadata)}assign(...t){const e=t[0]instanceof $o?t[0]:Array.isArray(t[0])?new $o(t[0]):new $o(t),i=[...this.fields],n=Xo(Xo(new Map,this.metadata),e.metadata),s=e.fields.filter((t=>{const e=i.findIndex((e=>e.name===t.name));return!~e||(i[e]=t.clone({metadata:Xo(Xo(new Map,i[e].metadata),t.metadata)}))&&!1})),r=Ko(s,new Map);return new $o([...i,...s],n,new Map([...this.dictionaries,...r]))}}$o.prototype.fields=null,$o.prototype.metadata=null,$o.prototype.dictionaries=null;class Yo{constructor(t,e,i=!1,n){this.name=t,this.type=e,this.nullable=i,this.metadata=n||new Map}static new(...t){let[e,i,n,s]=t;return t[0]&&"object"==typeof t[0]&&(({name:e}=t[0]),void 0===i&&(i=t[0].type),void 0===n&&(n=t[0].nullable),void 0===s&&(s=t[0].metadata)),new Yo(`${e}`,i,n,s)}get typeId(){return this.type.typeId}get[Symbol.toStringTag](){return"Field"}toString(){return`${this.name}: ${this.type}`}clone(...t){let[e,i,n,s]=t;return t[0]&&"object"==typeof t[0]?({name:e=this.name,type:i=this.type,nullable:n=this.nullable,metadata:s=this.metadata}=t[0]):[e=this.name,i=this.type,n=this.nullable,s=this.metadata]=t,Yo.new(e,i,n,s)}}function Xo(t,e){return new Map([...t||new Map,...e||new Map])}function Ko(t,e=new Map){for(let i=-1,n=t.length;++i<n;){const n=t[i].type;if(Cs.isDictionary(n))if(e.has(n.id)){if(e.get(n.id)!==n.dictionary)throw new Error("Cannot create Schema containing two different dictionaries with the same Id")}else e.set(n.id,n.dictionary);n.children&&n.children.length>0&&Ko(n.children,e)}return e}Yo.prototype.type=null,Yo.prototype.name=null,Yo.prototype.nullable=null,Yo.prototype.metadata=null;class Jo extends Qs{compareSchemas(t,e){return t===e||e instanceof t.constructor&&this.compareManyFields(t.fields,e.fields)}compareManyFields(t,e){return t===e||Array.isArray(t)&&Array.isArray(e)&&t.length===e.length&&t.every(((t,i)=>this.compareFields(t,e[i])))}compareFields(t,e){return t===e||e instanceof t.constructor&&t.name===e.name&&t.nullable===e.nullable&&this.visit(t.type,e.type)}}function Qo(t,e){return e instanceof t.constructor}function ta(t,e){return t===e||Qo(t,e)}function ea(t,e){return t===e||Qo(t,e)&&t.bitWidth===e.bitWidth&&t.isSigned===e.isSigned}function ia(t,e){return t===e||Qo(t,e)&&t.precision===e.precision}function na(t,e){return t===e||Qo(t,e)&&t.unit===e.unit}function sa(t,e){return t===e||Qo(t,e)&&t.unit===e.unit&&t.timezone===e.timezone}function ra(t,e){return t===e||Qo(t,e)&&t.unit===e.unit&&t.bitWidth===e.bitWidth}function oa(t,e){return t===e||Qo(t,e)&&t.mode===e.mode&&t.typeIds.every(((t,i)=>t===e.typeIds[i]))&&ha.compareManyFields(t.children,e.children)}function aa(t,e){return t===e||Qo(t,e)&&t.unit===e.unit}Jo.prototype.visitNull=ta,Jo.prototype.visitBool=ta,Jo.prototype.visitInt=ea,Jo.prototype.visitInt8=ea,Jo.prototype.visitInt16=ea,Jo.prototype.visitInt32=ea,Jo.prototype.visitInt64=ea,Jo.prototype.visitUint8=ea,Jo.prototype.visitUint16=ea,Jo.prototype.visitUint32=ea,Jo.prototype.visitUint64=ea,Jo.prototype.visitFloat=ia,Jo.prototype.visitFloat16=ia,Jo.prototype.visitFloat32=ia,Jo.prototype.visitFloat64=ia,Jo.prototype.visitUtf8=ta,Jo.prototype.visitBinary=ta,Jo.prototype.visitFixedSizeBinary=function(t,e){return t===e||Qo(t,e)&&t.byteWidth===e.byteWidth},Jo.prototype.visitDate=na,Jo.prototype.visitDateDay=na,Jo.prototype.visitDateMillisecond=na,Jo.prototype.visitTimestamp=sa,Jo.prototype.visitTimestampSecond=sa,Jo.prototype.visitTimestampMillisecond=sa,Jo.prototype.visitTimestampMicrosecond=sa,Jo.prototype.visitTimestampNanosecond=sa,Jo.prototype.visitTime=ra,Jo.prototype.visitTimeSecond=ra,Jo.prototype.visitTimeMillisecond=ra,Jo.prototype.visitTimeMicrosecond=ra,Jo.prototype.visitTimeNanosecond=ra,Jo.prototype.visitDecimal=ta,Jo.prototype.visitList=function(t,e){return t===e||Qo(t,e)&&t.children.length===e.children.length&&ha.compareManyFields(t.children,e.children)},Jo.prototype.visitStruct=function(t,e){return t===e||Qo(t,e)&&t.children.length===e.children.length&&ha.compareManyFields(t.children,e.children)},Jo.prototype.visitUnion=oa,Jo.prototype.visitDenseUnion=oa,Jo.prototype.visitSparseUnion=oa,Jo.prototype.visitDictionary=function(t,e){return t===e||Qo(t,e)&&t.id===e.id&&t.isOrdered===e.isOrdered&&ha.visit(t.indices,e.indices)&&ha.visit(t.dictionary,e.dictionary)},Jo.prototype.visitInterval=aa,Jo.prototype.visitIntervalDayTime=aa,Jo.prototype.visitIntervalYearMonth=aa,Jo.prototype.visitFixedSizeList=function(t,e){return t===e||Qo(t,e)&&t.listSize===e.listSize&&t.children.length===e.children.length&&ha.compareManyFields(t.children,e.children)},Jo.prototype.visitMap=function(t,e){return t===e||Qo(t,e)&&t.keysSorted===e.keysSorted&&t.children.length===e.children.length&&ha.compareManyFields(t.children,e.children)};const ha=new Jo;function la(t,e){return ha.compareSchemas(t,e)}var ua,ca;class da{constructor(...t){switch(t.length){case 2:if([this.schema]=t,!(this.schema instanceof $o))throw new TypeError("RecordBatch constructor expects a [Schema, Data] pair.");if([,this.data=Ho({nullCount:0,type:new Gs(this.schema.fields),children:this.schema.fields.map((t=>Ho({type:t.type,nullCount:0})))})]=t,!(this.data instanceof qo))throw new TypeError("RecordBatch constructor expects a [Schema, Data] pair.");[this.schema,this.data]=fa(this.schema,this.data.children);break;case 1:{const[e]=t,{fields:i,children:n,length:s}=Object.keys(e).reduce(((t,i,n)=>(t.children[n]=e[i],t.length=Math.max(t.length,e[i].length),t.fields[n]=Yo.new({name:i,type:e[i].type,nullable:!0}),t)),{length:0,fields:new Array,children:new Array}),r=new $o(i),o=Ho({type:new Gs(i),length:s,children:n,nullCount:0});[this.schema,this.data]=fa(r,o.children,s);break}default:throw new TypeError("RecordBatch constructor expects an Object mapping names to child Data, or a [Schema, Data] pair.")}}get dictionaries(){return this._dictionaries||(this._dictionaries=pa(this.schema.fields,this.data.children))}get numCols(){return this.schema.fields.length}get numRows(){return this.data.length}get nullCount(){return this.data.nullCount}isValid(t){return this.data.getValid(t)}get(t){return Qr.visit(this.data,t)}set(t,e){return Tr.visit(this.data,t,e)}indexOf(t,e){return Co.visit(this.data,t,e)}getByteLength(t){return Ro.visit(this.data,t)}[Symbol.iterator](){return No.visit(new Vo([this.data]))}toArray(){return[...this]}concat(...t){return new ga(this.schema,[this,...t])}slice(t,e){const[i]=new Vo([this.data]).slice(t,e).data;return new da(this.schema,i)}getChild(t){var e;return this.getChildAt(null===(e=this.schema.fields)||void 0===e?void 0:e.findIndex((e=>e.name===t)))}getChildAt(t){return t>-1&&t<this.schema.fields.length?new Vo([this.data.children[t]]):null}setChild(t,e){var i;return this.setChildAt(null===(i=this.schema.fields)||void 0===i?void 0:i.findIndex((e=>e.name===t)),e)}setChildAt(t,e){let i=this.schema,n=this.data;if(t>-1&&t<this.numCols){e||(e=new Vo([Ho({type:new Bs,length:this.numRows})]));const s=i.fields.slice(),r=n.children.slice(),o=s[t].clone({type:e.type});[s[t],r[t]]=[o,e.data[0]],i=new $o(s,new Map(this.schema.metadata)),n=Ho({type:new Gs(s),children:r})}return new da(i,n)}select(t){const e=this.schema.select(t),i=new Gs(e.fields),n=[];for(const e of t){const t=this.schema.fields.findIndex((t=>t.name===e));~t&&(n[t]=this.data.children[t])}return new da(e,Ho({type:i,length:this.numRows,children:n}))}selectAt(t){const e=this.schema.selectAt(t),i=t.map((t=>this.data.children[t])).filter(Boolean),n=Ho({type:new Gs(e.fields),length:this.numRows,children:i});return new da(e,n)}}function fa(t,e,i=e.reduce(((t,e)=>Math.max(t,e.length)),0)){var n;const s=[...t.fields],r=[...e],o=(i+63&-64)>>3;for(const[a,h]of t.fields.entries()){const t=e[a];t&&t.length===i||(s[a]=h.clone({nullable:!0}),r[a]=null!==(n=null==t?void 0:t._changeLengthAndBackfillNullBitmap(i))&&void 0!==n?n:Ho({type:h.type,length:i,nullCount:i,nullBitmap:new Uint8Array(o)}))}return[t.assign(s),Ho({type:new Gs(s),length:i,children:r})]}function pa(t,e,i=new Map){for(let n=-1,s=t.length;++n<s;){const s=t[n].type,r=e[n];if(Cs.isDictionary(s))if(i.has(s.id)){if(i.get(s.id)!==r.dictionary)throw new Error("Cannot create Schema containing two different dictionaries with the same Id")}else r.dictionary&&i.set(s.id,r.dictionary);s.children&&s.children.length>0&&pa(s.children,r.children,i)}return i}ua=Symbol.toStringTag,da[ua]=(t=>(t._nullCount=-1,t[Symbol.isConcatSpreadable]=!0,"RecordBatch"))(da.prototype);class ma extends da{constructor(t){const e=t.fields.map((t=>Ho({type:t.type})));super(t,Ho({type:new Gs(t.fields),nullCount:0,children:e}))}}function _a(t,e){return function(t,e){const i=[...t.fields],n=[],s={numBatches:e.reduce(((t,e)=>Math.max(t,e.length)),0)};let r=0,o=0,a=-1;const h=e.length;let l,u=[];for(;s.numBatches-- >0;){for(o=Number.POSITIVE_INFINITY,a=-1;++a<h;)u[a]=l=e[a].shift(),o=Math.min(o,l?l.length:o);Number.isFinite(o)&&(u=ya(i,o,u,e,s),o>0&&(n[r++]=Ho({type:new Gs(i),length:o,nullCount:0,children:u.slice()})))}return[t=t.assign(i),n.map((e=>new da(t,e)))]}(t,e.map((t=>t.data.concat())))}function ya(t,e,i,n,s){var r;const o=(e+63&-64)>>3;for(let a=-1,h=n.length;++a<h;){const h=i[a],l=null==h?void 0:h.length;if(l>=e)l===e?i[a]=h:(i[a]=h.slice(0,e),s.numBatches=Math.max(s.numBatches,n[a].unshift(h.slice(e,l-e))));else{const n=t[a];t[a]=n.clone({nullable:!0}),i[a]=null!==(r=null==h?void 0:h._changeLengthAndBackfillNullBitmap(e))&&void 0!==r?r:Ho({type:n.type,length:e,nullCount:e,nullBitmap:new Uint8Array(o)})}}return i}class ga{constructor(...t){var e,i;if(0===t.length)return this.batches=[],this.schema=new $o([]),this._offsets=[0],this;let n,s;t[0]instanceof $o&&(n=t.shift()),t[t.length-1]instanceof Uint32Array&&(s=t.pop());const r=t=>{if(t){if(t instanceof da)return[t];if(t instanceof ga)return t.batches;if(t instanceof qo){if(t.type instanceof Gs)return[new da(new $o(t.type.children),t)]}else{if(Array.isArray(t))return t.flatMap((t=>r(t)));if("function"==typeof t[Symbol.iterator])return[...t].flatMap((t=>r(t)));if("object"==typeof t){const e=Object.keys(t),i=e.map((e=>new Vo([t[e]]))),n=new $o(e.map(((t,e)=>new Yo(String(t),i[e].type)))),[,s]=_a(n,i);return 0===s.length?[new da(t)]:s}}}return[]},o=t.flatMap((t=>r(t)));if(n=null!==(i=null!=n?n:null===(e=o[0])||void 0===e?void 0:e.schema)&&void 0!==i?i:new $o([]),!(n instanceof $o))throw new TypeError("Table constructor expects a [Schema, RecordBatch[]] pair.");for(const t of o){if(!(t instanceof da))throw new TypeError("Table constructor expects a [Schema, RecordBatch[]] pair.");if(!la(n,t.schema))throw new TypeError("Table and inner RecordBatch schemas must be equivalent.")}this.schema=n,this.batches=o,this._offsets=null!=s?s:po(this.data)}get data(){return this.batches.map((({data:t})=>t))}get numCols(){return this.schema.fields.length}get numRows(){return this.data.reduce(((t,e)=>t+e.length),0)}get nullCount(){return-1===this._nullCount&&(this._nullCount=fo(this.data)),this._nullCount}isValid(t){return!1}get(t){return null}set(t,e){}indexOf(t,e){return-1}getByteLength(t){return 0}[Symbol.iterator](){return this.batches.length>0?No.visit(new Vo(this.data)):new Array(0)[Symbol.iterator]()}toArray(){return[...this]}toString(){return`[\n  ${this.toArray().join(",\n  ")}\n]`}concat(...t){const e=this.schema,i=this.data.concat(t.flatMap((({data:t})=>t)));return new ga(e,i.map((t=>new da(e,t))))}slice(t,e){const i=this.schema;[t,e]=oo({length:this.numRows},t,e);const n=mo(this.data,this._offsets,t,e);return new ga(i,n.map((t=>new da(i,t))))}getChild(t){return this.getChildAt(this.schema.fields.findIndex((e=>e.name===t)))}getChildAt(t){if(t>-1&&t<this.schema.fields.length){const e=this.data.map((e=>e.children[t]));if(0===e.length){const{type:i}=this.schema.fields[t],n=Ho({type:i,length:0,nullCount:0});e.push(n._changeLengthAndBackfillNullBitmap(this.numRows))}return new Vo(e)}return null}setChild(t,e){var i;return this.setChildAt(null===(i=this.schema.fields)||void 0===i?void 0:i.findIndex((e=>e.name===t)),e)}setChildAt(t,e){let i=this.schema,n=[...this.batches];if(t>-1&&t<this.numCols){e||(e=new Vo([Ho({type:new Bs,length:this.numRows})]));const s=i.fields.slice(),r=s[t].clone({type:e.type}),o=this.schema.fields.map(((t,e)=>this.getChildAt(e)));[s[t],o[t]]=[r,e],[i,n]=_a(i,o)}return new ga(i,n)}select(t){const e=this.schema.fields.reduce(((t,e,i)=>t.set(e.name,i)),new Map);return this.selectAt(t.map((t=>e.get(t))).filter((t=>t>-1)))}selectAt(t){const e=this.schema.selectAt(t),i=this.batches.map((e=>e.selectAt(t)));return new ga(e,i)}assign(t){const e=this.schema.fields,[i,n]=t.schema.fields.reduce(((t,i,n)=>{const[s,r]=t,o=e.findIndex((t=>t.name===i.name));return~o?r[o]=n:s.push(n),t}),[[],[]]),s=this.schema.assign(t.schema),r=[...e.map(((t,e)=>[e,n[e]])).map((([e,i])=>void 0===i?this.getChildAt(e):t.getChildAt(i))),...i.map((e=>t.getChildAt(e)))].filter(Boolean);return new ga(..._a(s,r))}}ca=Symbol.toStringTag,ga[ca]=(t=>(t.schema=null,t.batches=[],t._offsets=new Uint32Array([0]),t._nullCount=-1,t[Symbol.isConcatSpreadable]=!0,t.isValid=go(yo),t.get=go(Qr.getVisitFn(cn.Struct)),t.set=vo(Tr.getVisitFn(cn.Struct)),t.indexOf=bo(Co.getVisitFn(cn.Struct)),t.getByteLength=go(Ro.getVisitFn(cn.Struct)),"Table"))(ga.prototype);class va{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}offset(){return this.bb.readInt64(this.bb_pos)}metaDataLength(){return this.bb.readInt32(this.bb_pos+8)}bodyLength(){return this.bb.readInt64(this.bb_pos+16)}static sizeOf(){return 24}static createBlock(t,e,i,n){return t.prep(8,24),t.writeInt64(n),t.pad(4),t.writeInt32(i),t.writeInt64(e),t.offset()}}const ba=new Int32Array(2),wa=new Float32Array(ba.buffer),xa=new Float64Array(ba.buffer),Ma=1===new Uint16Array(new Uint8Array([1,0]).buffer)[0];class Sa{constructor(t,e){this.low=0|t,this.high=0|e}static create(t,e){return 0==t&&0==e?Sa.ZERO:new Sa(t,e)}toFloat64(){return(this.low>>>0)+4294967296*this.high}equals(t){return this.low==t.low&&this.high==t.high}}var Ia,Ta,La,Aa,Pa;Sa.ZERO=new Sa(0,0),function(t){t[t.UTF8_BYTES=1]="UTF8_BYTES",t[t.UTF16_STRING=2]="UTF16_STRING"}(Ia||(Ia={}));class Ca{constructor(t){this.bytes_=t,this.position_=0}static allocate(t){return new Ca(new Uint8Array(t))}clear(){this.position_=0}bytes(){return this.bytes_}position(){return this.position_}setPosition(t){this.position_=t}capacity(){return this.bytes_.length}readInt8(t){return this.readUint8(t)<<24>>24}readUint8(t){return this.bytes_[t]}readInt16(t){return this.readUint16(t)<<16>>16}readUint16(t){return this.bytes_[t]|this.bytes_[t+1]<<8}readInt32(t){return this.bytes_[t]|this.bytes_[t+1]<<8|this.bytes_[t+2]<<16|this.bytes_[t+3]<<24}readUint32(t){return this.readInt32(t)>>>0}readInt64(t){return new Sa(this.readInt32(t),this.readInt32(t+4))}readUint64(t){return new Sa(this.readUint32(t),this.readUint32(t+4))}readFloat32(t){return ba[0]=this.readInt32(t),wa[0]}readFloat64(t){return ba[Ma?0:1]=this.readInt32(t),ba[Ma?1:0]=this.readInt32(t+4),xa[0]}writeInt8(t,e){this.bytes_[t]=e}writeUint8(t,e){this.bytes_[t]=e}writeInt16(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8}writeUint16(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8}writeInt32(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8,this.bytes_[t+2]=e>>16,this.bytes_[t+3]=e>>24}writeUint32(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8,this.bytes_[t+2]=e>>16,this.bytes_[t+3]=e>>24}writeInt64(t,e){this.writeInt32(t,e.low),this.writeInt32(t+4,e.high)}writeUint64(t,e){this.writeUint32(t,e.low),this.writeUint32(t+4,e.high)}writeFloat32(t,e){wa[0]=e,this.writeInt32(t,ba[0])}writeFloat64(t,e){xa[0]=e,this.writeInt32(t,ba[Ma?0:1]),this.writeInt32(t+4,ba[Ma?1:0])}getBufferIdentifier(){if(this.bytes_.length<this.position_+4+4)throw new Error("FlatBuffers: ByteBuffer is too short to contain an identifier.");let t="";for(let e=0;e<4;e++)t+=String.fromCharCode(this.readInt8(this.position_+4+e));return t}__offset(t,e){const i=t-this.readInt32(t);return e<this.readInt16(i)?this.readInt16(i+e):0}__union(t,e){return t.bb_pos=e+this.readInt32(e),t.bb=this,t}__string(t,e){t+=this.readInt32(t);const i=this.readInt32(t);let n="",s=0;if(t+=4,e===Ia.UTF8_BYTES)return this.bytes_.subarray(t,t+i);for(;s<i;){let e;const i=this.readUint8(t+s++);if(i<192)e=i;else{const n=this.readUint8(t+s++);if(i<224)e=(31&i)<<6|63&n;else{const r=this.readUint8(t+s++);e=i<240?(15&i)<<12|(63&n)<<6|63&r:(7&i)<<18|(63&n)<<12|(63&r)<<6|63&this.readUint8(t+s++)}}e<65536?n+=String.fromCharCode(e):(e-=65536,n+=String.fromCharCode(55296+(e>>10),56320+(1023&e)))}return n}__union_with_string(t,e){return"string"==typeof t?this.__string(e):this.__union(t,e)}__indirect(t){return t+this.readInt32(t)}__vector(t){return t+this.readInt32(t)+4}__vector_len(t){return this.readInt32(t+this.readInt32(t))}__has_identifier(t){if(4!=t.length)throw new Error("FlatBuffers: file identifier must be length 4");for(let e=0;e<4;e++)if(t.charCodeAt(e)!=this.readInt8(this.position()+4+e))return!1;return!0}createLong(t,e){return Sa.create(t,e)}createScalarList(t,e){const i=[];for(let n=0;n<e;++n)null!==t(n)&&i.push(t(n));return i}createObjList(t,e){const i=[];for(let n=0;n<e;++n){const e=t(n);null!==e&&i.push(e.unpack())}return i}}class Ba{constructor(t){let e;this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null,e=t||1024,this.bb=Ca.allocate(e),this.space=e}clear(){this.bb.clear(),this.space=this.bb.capacity(),this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null}forceDefaults(t){this.force_defaults=t}dataBuffer(){return this.bb}asUint8Array(){return this.bb.bytes().subarray(this.bb.position(),this.bb.position()+this.offset())}prep(t,e){t>this.minalign&&(this.minalign=t);const i=1+~(this.bb.capacity()-this.space+e)&t-1;for(;this.space<i+t+e;){const t=this.bb.capacity();this.bb=Ba.growByteBuffer(this.bb),this.space+=this.bb.capacity()-t}this.pad(i)}pad(t){for(let e=0;e<t;e++)this.bb.writeInt8(--this.space,0)}writeInt8(t){this.bb.writeInt8(this.space-=1,t)}writeInt16(t){this.bb.writeInt16(this.space-=2,t)}writeInt32(t){this.bb.writeInt32(this.space-=4,t)}writeInt64(t){this.bb.writeInt64(this.space-=8,t)}writeFloat32(t){this.bb.writeFloat32(this.space-=4,t)}writeFloat64(t){this.bb.writeFloat64(this.space-=8,t)}addInt8(t){this.prep(1,0),this.writeInt8(t)}addInt16(t){this.prep(2,0),this.writeInt16(t)}addInt32(t){this.prep(4,0),this.writeInt32(t)}addInt64(t){this.prep(8,0),this.writeInt64(t)}addFloat32(t){this.prep(4,0),this.writeFloat32(t)}addFloat64(t){this.prep(8,0),this.writeFloat64(t)}addFieldInt8(t,e,i){(this.force_defaults||e!=i)&&(this.addInt8(e),this.slot(t))}addFieldInt16(t,e,i){(this.force_defaults||e!=i)&&(this.addInt16(e),this.slot(t))}addFieldInt32(t,e,i){(this.force_defaults||e!=i)&&(this.addInt32(e),this.slot(t))}addFieldInt64(t,e,i){!this.force_defaults&&e.equals(i)||(this.addInt64(e),this.slot(t))}addFieldFloat32(t,e,i){(this.force_defaults||e!=i)&&(this.addFloat32(e),this.slot(t))}addFieldFloat64(t,e,i){(this.force_defaults||e!=i)&&(this.addFloat64(e),this.slot(t))}addFieldOffset(t,e,i){(this.force_defaults||e!=i)&&(this.addOffset(e),this.slot(t))}addFieldStruct(t,e,i){e!=i&&(this.nested(e),this.slot(t))}nested(t){if(t!=this.offset())throw new Error("FlatBuffers: struct must be serialized inline.")}notNested(){if(this.isNested)throw new Error("FlatBuffers: object serialization must not be nested.")}slot(t){null!==this.vtable&&(this.vtable[t]=this.offset())}offset(){return this.bb.capacity()-this.space}static growByteBuffer(t){const e=t.capacity();if(3221225472&e)throw new Error("FlatBuffers: cannot grow buffer beyond 2 gigabytes.");const i=e<<1,n=Ca.allocate(i);return n.setPosition(i-e),n.bytes().set(t.bytes(),i-e),n}addOffset(t){this.prep(4,0),this.writeInt32(this.offset()-t+4)}startObject(t){this.notNested(),null==this.vtable&&(this.vtable=[]),this.vtable_in_use=t;for(let e=0;e<t;e++)this.vtable[e]=0;this.isNested=!0,this.object_start=this.offset()}endObject(){if(null==this.vtable||!this.isNested)throw new Error("FlatBuffers: endObject called without startObject");this.addInt32(0);const t=this.offset();let e=this.vtable_in_use-1;for(;e>=0&&0==this.vtable[e];e--);const i=e+1;for(;e>=0;e--)this.addInt16(0!=this.vtable[e]?t-this.vtable[e]:0);this.addInt16(t-this.object_start);const n=2*(i+2);this.addInt16(n);let s=0;const r=this.space;t:for(e=0;e<this.vtables.length;e++){const t=this.bb.capacity()-this.vtables[e];if(n==this.bb.readInt16(t)){for(let e=2;e<n;e+=2)if(this.bb.readInt16(r+e)!=this.bb.readInt16(t+e))continue t;s=this.vtables[e];break}}return s?(this.space=this.bb.capacity()-t,this.bb.writeInt32(this.space,s-t)):(this.vtables.push(this.offset()),this.bb.writeInt32(this.bb.capacity()-t,this.offset()-t)),this.isNested=!1,t}finish(t,e,i){const n=i?4:0;if(e){const t=e;if(this.prep(this.minalign,8+n),4!=t.length)throw new Error("FlatBuffers: file identifier must be length 4");for(let e=3;e>=0;e--)this.writeInt8(t.charCodeAt(e))}this.prep(this.minalign,4+n),this.addOffset(t),n&&this.addInt32(this.bb.capacity()-this.space),this.bb.setPosition(this.space)}finishSizePrefixed(t,e){this.finish(t,e,!0)}requiredField(t,e){const i=this.bb.capacity()-t,n=i-this.bb.readInt32(i);if(0==this.bb.readInt16(n+e))throw new Error("FlatBuffers: field "+e+" must be set")}startVector(t,e,i){this.notNested(),this.vector_num_elems=e,this.prep(4,t*e),this.prep(i,t*e)}endVector(){return this.writeInt32(this.vector_num_elems),this.offset()}createSharedString(t){if(!t)return 0;if(this.string_maps||(this.string_maps=new Map),this.string_maps.has(t))return this.string_maps.get(t);const e=this.createString(t);return this.string_maps.set(t,e),e}createString(t){if(!t)return 0;let e;if(t instanceof Uint8Array)e=t;else{e=[];let i=0;for(;i<t.length;){let n;const s=t.charCodeAt(i++);n=s<55296||s>=56320?s:(s<<10)+t.charCodeAt(i++)+-56613888,n<128?e.push(n):(n<2048?e.push(n>>6&31|192):(n<65536?e.push(n>>12&15|224):e.push(n>>18&7|240,n>>12&63|128),e.push(n>>6&63|128)),e.push(63&n|128))}}this.addInt8(0),this.startVector(1,e.length,1),this.bb.setPosition(this.space-=e.length);for(let t=0,i=this.space,n=this.bb.bytes();t<e.length;t++)n[i++]=e[t];return this.endVector()}createLong(t,e){return Sa.create(t,e)}createObjectOffset(t){return null===t?0:"string"==typeof t?this.createString(t):t.pack(this)}createObjectOffsetList(t){const e=[];for(let i=0;i<t.length;++i){const n=t[i];if(null===n)throw new Error("FlatBuffers: Argument for createObjectOffsetList cannot contain null.");e.push(this.createObjectOffset(n))}return e}createStructOffsetList(t,e){return e(this,t.length),this.createObjectOffsetList(t),this.endVector()}}class Oa{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsKeyValue(t,e){return(e||new Oa).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsKeyValue(t,e){return t.setPosition(t.position()+4),(e||new Oa).__init(t.readInt32(t.position())+t.position(),t)}key(t){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,t):null}value(t){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__string(this.bb_pos+e,t):null}static startKeyValue(t){t.startObject(2)}static addKey(t,e){t.addFieldOffset(0,e,0)}static addValue(t,e){t.addFieldOffset(1,e,0)}static endKeyValue(t){return t.endObject()}static createKeyValue(t,e,i){return Oa.startKeyValue(t),Oa.addKey(t,e),Oa.addValue(t,i),Oa.endKeyValue(t)}}!function(t){t[t.V1=0]="V1",t[t.V2=1]="V2",t[t.V3=2]="V3",t[t.V4=3]="V4",t[t.V5=4]="V5"}(Ta||(Ta={})),function(t){t[t.Little=0]="Little",t[t.Big=1]="Big"}(La||(La={})),function(t){t[t.DenseArray=0]="DenseArray"}(Aa||(Aa={}));class Ea{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsInt(t,e){return(e||new Ea).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsInt(t,e){return t.setPosition(t.position()+4),(e||new Ea).__init(t.readInt32(t.position())+t.position(),t)}bitWidth(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}isSigned(){const t=this.bb.__offset(this.bb_pos,6);return!!t&&!!this.bb.readInt8(this.bb_pos+t)}static startInt(t){t.startObject(2)}static addBitWidth(t,e){t.addFieldInt32(0,e,0)}static addIsSigned(t,e){t.addFieldInt8(1,+e,0)}static endInt(t){return t.endObject()}static createInt(t,e,i){return Ea.startInt(t),Ea.addBitWidth(t,e),Ea.addIsSigned(t,i),Ea.endInt(t)}}class Na{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsDictionaryEncoding(t,e){return(e||new Na).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDictionaryEncoding(t,e){return t.setPosition(t.position()+4),(e||new Na).__init(t.readInt32(t.position())+t.position(),t)}id(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt64(this.bb_pos+t):this.bb.createLong(0,0)}indexType(t){const e=this.bb.__offset(this.bb_pos,6);return e?(t||new Ea).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}isOrdered(){const t=this.bb.__offset(this.bb_pos,8);return!!t&&!!this.bb.readInt8(this.bb_pos+t)}dictionaryKind(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.readInt16(this.bb_pos+t):Aa.DenseArray}static startDictionaryEncoding(t){t.startObject(4)}static addId(t,e){t.addFieldInt64(0,e,t.createLong(0,0))}static addIndexType(t,e){t.addFieldOffset(1,e,0)}static addIsOrdered(t,e){t.addFieldInt8(2,+e,0)}static addDictionaryKind(t,e){t.addFieldInt16(3,e,Aa.DenseArray)}static endDictionaryEncoding(t){return t.endObject()}}!function(t){t[t.NONE=0]="NONE",t[t.Null=1]="Null",t[t.Int=2]="Int",t[t.FloatingPoint=3]="FloatingPoint",t[t.Binary=4]="Binary",t[t.Utf8=5]="Utf8",t[t.Bool=6]="Bool",t[t.Decimal=7]="Decimal",t[t.Date=8]="Date",t[t.Time=9]="Time",t[t.Timestamp=10]="Timestamp",t[t.Interval=11]="Interval",t[t.List=12]="List",t[t.Struct_=13]="Struct_",t[t.Union=14]="Union",t[t.FixedSizeBinary=15]="FixedSizeBinary",t[t.FixedSizeList=16]="FixedSizeList",t[t.Map=17]="Map",t[t.Duration=18]="Duration",t[t.LargeBinary=19]="LargeBinary",t[t.LargeUtf8=20]="LargeUtf8",t[t.LargeList=21]="LargeList"}(Pa||(Pa={}));class za{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsField(t,e){return(e||new za).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsField(t,e){return t.setPosition(t.position()+4),(e||new za).__init(t.readInt32(t.position())+t.position(),t)}name(t){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,t):null}nullable(){const t=this.bb.__offset(this.bb_pos,6);return!!t&&!!this.bb.readInt8(this.bb_pos+t)}typeType(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readUint8(this.bb_pos+t):Pa.NONE}type(t){const e=this.bb.__offset(this.bb_pos,10);return e?this.bb.__union(t,this.bb_pos+e):null}dictionary(t){const e=this.bb.__offset(this.bb_pos,12);return e?(t||new Na).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}children(t,e){const i=this.bb.__offset(this.bb_pos,14);return i?(e||new za).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+i)+4*t),this.bb):null}childrenLength(){const t=this.bb.__offset(this.bb_pos,14);return t?this.bb.__vector_len(this.bb_pos+t):0}customMetadata(t,e){const i=this.bb.__offset(this.bb_pos,16);return i?(e||new Oa).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+i)+4*t),this.bb):null}customMetadataLength(){const t=this.bb.__offset(this.bb_pos,16);return t?this.bb.__vector_len(this.bb_pos+t):0}static startField(t){t.startObject(7)}static addName(t,e){t.addFieldOffset(0,e,0)}static addNullable(t,e){t.addFieldInt8(1,+e,0)}static addTypeType(t,e){t.addFieldInt8(2,e,Pa.NONE)}static addType(t,e){t.addFieldOffset(3,e,0)}static addDictionary(t,e){t.addFieldOffset(4,e,0)}static addChildren(t,e){t.addFieldOffset(5,e,0)}static createChildrenVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addOffset(e[i]);return t.endVector()}static startChildrenVector(t,e){t.startVector(4,e,4)}static addCustomMetadata(t,e){t.addFieldOffset(6,e,0)}static createCustomMetadataVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addOffset(e[i]);return t.endVector()}static startCustomMetadataVector(t,e){t.startVector(4,e,4)}static endField(t){return t.endObject()}}class ka{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsSchema(t,e){return(e||new ka).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsSchema(t,e){return t.setPosition(t.position()+4),(e||new ka).__init(t.readInt32(t.position())+t.position(),t)}endianness(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):La.Little}fields(t,e){const i=this.bb.__offset(this.bb_pos,6);return i?(e||new za).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+i)+4*t),this.bb):null}fieldsLength(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}customMetadata(t,e){const i=this.bb.__offset(this.bb_pos,8);return i?(e||new Oa).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+i)+4*t),this.bb):null}customMetadataLength(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}features(t){const e=this.bb.__offset(this.bb_pos,10);return e?this.bb.readInt64(this.bb.__vector(this.bb_pos+e)+8*t):this.bb.createLong(0,0)}featuresLength(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__vector_len(this.bb_pos+t):0}static startSchema(t){t.startObject(4)}static addEndianness(t,e){t.addFieldInt16(0,e,La.Little)}static addFields(t,e){t.addFieldOffset(1,e,0)}static createFieldsVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addOffset(e[i]);return t.endVector()}static startFieldsVector(t,e){t.startVector(4,e,4)}static addCustomMetadata(t,e){t.addFieldOffset(2,e,0)}static createCustomMetadataVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addOffset(e[i]);return t.endVector()}static startCustomMetadataVector(t,e){t.startVector(4,e,4)}static addFeatures(t,e){t.addFieldOffset(3,e,0)}static createFeaturesVector(t,e){t.startVector(8,e.length,8);for(let i=e.length-1;i>=0;i--)t.addInt64(e[i]);return t.endVector()}static startFeaturesVector(t,e){t.startVector(8,e,8)}static endSchema(t){return t.endObject()}static finishSchemaBuffer(t,e){t.finish(e)}static finishSizePrefixedSchemaBuffer(t,e){t.finish(e,void 0,!0)}static createSchema(t,e,i,n,s){return ka.startSchema(t),ka.addEndianness(t,e),ka.addFields(t,i),ka.addCustomMetadata(t,n),ka.addFeatures(t,s),ka.endSchema(t)}}class Da{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsFooter(t,e){return(e||new Da).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFooter(t,e){return t.setPosition(t.position()+4),(e||new Da).__init(t.readInt32(t.position())+t.position(),t)}version(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Ta.V1}schema(t){const e=this.bb.__offset(this.bb_pos,6);return e?(t||new ka).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}dictionaries(t,e){const i=this.bb.__offset(this.bb_pos,8);return i?(e||new va).__init(this.bb.__vector(this.bb_pos+i)+24*t,this.bb):null}dictionariesLength(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}recordBatches(t,e){const i=this.bb.__offset(this.bb_pos,10);return i?(e||new va).__init(this.bb.__vector(this.bb_pos+i)+24*t,this.bb):null}recordBatchesLength(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__vector_len(this.bb_pos+t):0}customMetadata(t,e){const i=this.bb.__offset(this.bb_pos,12);return i?(e||new Oa).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+i)+4*t),this.bb):null}customMetadataLength(){const t=this.bb.__offset(this.bb_pos,12);return t?this.bb.__vector_len(this.bb_pos+t):0}static startFooter(t){t.startObject(5)}static addVersion(t,e){t.addFieldInt16(0,e,Ta.V1)}static addSchema(t,e){t.addFieldOffset(1,e,0)}static addDictionaries(t,e){t.addFieldOffset(2,e,0)}static startDictionariesVector(t,e){t.startVector(24,e,8)}static addRecordBatches(t,e){t.addFieldOffset(3,e,0)}static startRecordBatchesVector(t,e){t.startVector(24,e,8)}static addCustomMetadata(t,e){t.addFieldOffset(4,e,0)}static createCustomMetadataVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addOffset(e[i]);return t.endVector()}static startCustomMetadataVector(t,e){t.startVector(4,e,4)}static endFooter(t){return t.endObject()}static finishFooterBuffer(t,e){t.finish(e)}static finishSizePrefixedFooterBuffer(t,e){t.finish(e,void 0,!0)}}var Fa=Sa,Ra=Ba,Ua=Ca;class Za{constructor(t,e=sn.V4,i,n){this.schema=t,this.version=e,i&&(this._recordBatches=i),n&&(this._dictionaryBatches=n)}static decode(t){t=new Ua(Kn(t));const e=Da.getRootAsFooter(t),i=$o.decode(e.schema());return new ja(i,e)}static encode(t){const e=new Ra,i=$o.encode(e,t.schema);Da.startRecordBatchesVector(e,t.numRecordBatches);for(const i of[...t.recordBatches()].slice().reverse())Va.encode(e,i);const n=e.endVector();Da.startDictionariesVector(e,t.numDictionaries);for(const i of[...t.dictionaryBatches()].slice().reverse())Va.encode(e,i);const s=e.endVector();return Da.startFooter(e),Da.addSchema(e,i),Da.addVersion(e,sn.V4),Da.addRecordBatches(e,n),Da.addDictionaries(e,s),Da.finishFooterBuffer(e,Da.endFooter(e)),e.asUint8Array()}get numRecordBatches(){return this._recordBatches.length}get numDictionaries(){return this._dictionaryBatches.length}*recordBatches(){for(let t,e=-1,i=this.numRecordBatches;++e<i;)(t=this.getRecordBatch(e))&&(yield t)}*dictionaryBatches(){for(let t,e=-1,i=this.numDictionaries;++e<i;)(t=this.getDictionaryBatch(e))&&(yield t)}getRecordBatch(t){return t>=0&&t<this.numRecordBatches&&this._recordBatches[t]||null}getDictionaryBatch(t){return t>=0&&t<this.numDictionaries&&this._dictionaryBatches[t]||null}}class ja extends Za{constructor(t,e){super(t,e.version()),this._footer=e}get numRecordBatches(){return this._footer.recordBatchesLength()}get numDictionaries(){return this._footer.dictionariesLength()}getRecordBatch(t){if(t>=0&&t<this.numRecordBatches){const e=this._footer.recordBatches(t);if(e)return Va.decode(e)}return null}getDictionaryBatch(t){if(t>=0&&t<this.numDictionaries){const e=this._footer.dictionaries(t);if(e)return Va.decode(e)}return null}}class Va{constructor(t,e,i){this.metaDataLength=t,this.offset="number"==typeof i?i:i.low,this.bodyLength="number"==typeof e?e:e.low}static decode(t){return new Va(t.metaDataLength(),t.bodyLength(),t.offset())}static encode(t,e){const{metaDataLength:i}=e,n=new Fa(e.offset,0),s=new Fa(e.bodyLength,0);return va.createBlock(t,n,i,s)}}const Ga={fromIterable:t=>qa(function*(t){let e,i,n,s,r=!1,o=[],a=0;({cmd:n,size:s}=yield null);const h=(l=t,function*(t,e){const i=function*(t){yield t},n="string"==typeof e||ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof Wn?i(e):kn(e)?e:i(e);return yield*Jn(function*(e){let i=null;do{i=e.next(yield Yn(t,i))}while(!i.done)}(n[Symbol.iterator]())),new t}(Uint8Array,l))[Symbol.iterator]();var l;try{do{if(({done:e,value:i}=Number.isNaN(s-a)?h.next():h.next(s-a)),!e&&i.byteLength>0&&(o.push(i),a+=i.byteLength),e||s<=a)do{({cmd:n,size:s}=yield"peek"===n?$n(o,s)[0]:([i,o,a]=$n(o,s),i))}while(s<a)}while(!e)}catch(t){(r=!0)&&"function"==typeof h.throw&&h.throw(t)}finally{!1===r&&"function"==typeof h.return&&h.return(null)}return null}(t)),fromAsyncIterable:t=>qa(function(t){return bn(this,arguments,(function*(){let e,i,n,s,r=!1,o=[],a=0;({cmd:n,size:s}=yield yield vn(null));const h=(l=t,Qn(Uint8Array,l))[Symbol.asyncIterator]();var l;try{do{if(({done:e,value:i}=Number.isNaN(s-a)?yield vn(h.next()):yield vn(h.next(s-a))),!e&&i.byteLength>0&&(o.push(i),a+=i.byteLength),e||s<=a)do{({cmd:n,size:s}=yield yield vn("peek"===n?$n(o,s)[0]:([i,o,a]=$n(o,s),i)))}while(s<a)}while(!e)}catch(t){(r=!0)&&"function"==typeof h.throw&&(yield vn(h.throw(t)))}finally{!1===r&&"function"==typeof h.return&&(yield vn(h.return(new Uint8Array(0))))}return yield vn(null)}))}(t)),fromDOMStream:t=>qa(function(t){return bn(this,arguments,(function*(){let e,i,n,s=!1,r=!1,o=[],a=0;({cmd:i,size:n}=yield yield vn(null));const h=new Wa(t);try{do{if(({done:s,value:e}=Number.isNaN(n-a)?yield vn(h.read()):yield vn(h.read(n-a))),!s&&e.byteLength>0&&(o.push(Kn(e)),a+=e.byteLength),s||n<=a)do{({cmd:i,size:n}=yield yield vn("peek"===i?$n(o,n)[0]:([e,o,a]=$n(o,n),e)))}while(n<a)}while(!s)}catch(t){(r=!0)&&(yield vn(h.cancel(t)))}finally{!1===r?yield vn(h.cancel()):t.locked&&h.releaseLock()}return yield vn(null)}))}(t)),fromNodeStream:t=>qa(function(t){return bn(this,arguments,(function*(){const e=[];let i,n,s,r="error",o=!1,a=null,h=0,l=[];if(({cmd:i,size:n}=yield yield vn(null)),t.isTTY)return yield yield vn(new Uint8Array(0)),yield vn(null);try{e[0]=Ha(t,"end"),e[1]=Ha(t,"error");do{if(e[2]=Ha(t,"readable"),[r,a]=yield vn(Promise.race(e.map((t=>t[2])))),"error"===r)break;if((o="end"===r)||(Number.isFinite(n-h)?(s=Kn(t.read(n-h)),s.byteLength<n-h&&(s=Kn(t.read()))):s=Kn(t.read()),s.byteLength>0&&(l.push(s),h+=s.byteLength)),o||n<=h)do{({cmd:i,size:n}=yield yield vn("peek"===i?$n(l,n)[0]:([s,l,h]=$n(l,n),s)))}while(n<h)}while(!o)}finally{yield vn(function(e,i){return s=l=null,new Promise(((n,s)=>{for(const[i,n]of e)t.off(i,n);try{const e=t.destroy;e&&e.call(t,i),i=void 0}catch(t){i=t||i}finally{null!=i?s(i):n()}}))}(e,"error"===r?a:null))}return yield vn(null)}))}(t)),toDOMStream(t,e){throw new Error('"toDOMStream" not available in this environment')},toNodeStream(t,e){throw new Error('"toNodeStream" not available in this environment')}},qa=t=>(t.next(),t);class Wa{constructor(t){this.source=t,this.reader=null,this.reader=this.source.getReader(),this.reader.closed.catch((()=>{}))}get closed(){return this.reader?this.reader.closed.catch((()=>{})):Promise.resolve()}releaseLock(){this.reader&&this.reader.releaseLock(),this.reader=null}cancel(t){return gn(this,void 0,void 0,(function*(){const{reader:e,source:i}=this;e&&(yield e.cancel(t).catch((()=>{}))),i&&i.locked&&this.releaseLock()}))}read(t){return gn(this,void 0,void 0,(function*(){if(0===t)return{done:null==this.reader,value:new Uint8Array(0)};const e=yield this.reader.read();return!e.done&&(e.value=Kn(e)),e}))}}const Ha=(t,e)=>{const i=t=>n([e,t]);let n;return[e,i,new Promise((s=>(n=s)&&t.once(e,i)))]},$a=Object.freeze({done:!0,value:void 0});class Ya{constructor(t){this._json=t}get schema(){return this._json.schema}get batches(){return this._json.batches||[]}get dictionaries(){return this._json.dictionaries||[]}}class Xa{tee(){return this._getDOMStream().tee()}pipe(t,e){return this._getNodeStream().pipe(t,e)}pipeTo(t,e){return this._getDOMStream().pipeTo(t,e)}pipeThrough(t,e){return this._getDOMStream().pipeThrough(t,e)}_getDOMStream(){return this._DOMStream||(this._DOMStream=this.toDOMStream())}_getNodeStream(){return this._nodeStream||(this._nodeStream=this.toNodeStream())}}class Ka extends Xa{constructor(){super(),this._values=[],this.resolvers=[],this._closedPromise=new Promise((t=>this._closedPromiseResolve=t))}get closed(){return this._closedPromise}cancel(t){return gn(this,void 0,void 0,(function*(){yield this.return(t)}))}write(t){this._ensureOpen()&&(this.resolvers.length<=0?this._values.push(t):this.resolvers.shift().resolve({done:!1,value:t}))}abort(t){this._closedPromiseResolve&&(this.resolvers.length<=0?this._error={error:t}:this.resolvers.shift().reject({done:!0,value:t}))}close(){if(this._closedPromiseResolve){const{resolvers:t}=this;for(;t.length>0;)t.shift().resolve($a);this._closedPromiseResolve(),this._closedPromiseResolve=void 0}}[Symbol.asyncIterator](){return this}toDOMStream(t){return Ga.toDOMStream(this._closedPromiseResolve||this._error?this:this._values,t)}toNodeStream(t){return Ga.toNodeStream(this._closedPromiseResolve||this._error?this:this._values,t)}throw(t){return gn(this,void 0,void 0,(function*(){return yield this.abort(t),$a}))}return(t){return gn(this,void 0,void 0,(function*(){return yield this.close(),$a}))}read(t){return gn(this,void 0,void 0,(function*(){return(yield this.next(t,"read")).value}))}peek(t){return gn(this,void 0,void 0,(function*(){return(yield this.next(t,"peek")).value}))}next(...t){return this._values.length>0?Promise.resolve({done:!1,value:this._values.shift()}):this._error?Promise.reject({done:!0,value:this._error.error}):this._closedPromiseResolve?new Promise(((t,e)=>{this.resolvers.push({resolve:t,reject:e})})):Promise.resolve($a)}_ensureOpen(){if(this._closedPromiseResolve)return!0;throw new Error("AsyncQueue is closed")}}class Ja extends Ka{write(t){if((t=Kn(t)).byteLength>0)return super.write(t)}toString(t=!1){return t?Sn(this.toUint8Array(!0)):this.toUint8Array(!1).then(Sn)}toUint8Array(t=!1){return t?$n(this._values)[0]:(()=>gn(this,void 0,void 0,(function*(){var t,e;const i=[];let n=0;try{for(var s,r=xn(this);!(s=yield r.next()).done;){const t=s.value;i.push(t),n+=t.byteLength}}catch(e){t={error:e}}finally{try{s&&!s.done&&(e=r.return)&&(yield e.call(r))}finally{if(t)throw t.error}}return $n(i,n)[0]})))()}}class Qa{constructor(t){t&&(this.source=new eh(Ga.fromIterable(t)))}[Symbol.iterator](){return this}next(t){return this.source.next(t)}throw(t){return this.source.throw(t)}return(t){return this.source.return(t)}peek(t){return this.source.peek(t)}read(t){return this.source.read(t)}}class th{constructor(t){t instanceof th?this.source=t.source:t instanceof Ja?this.source=new ih(Ga.fromAsyncIterable(t)):Gn(t)?this.source=new ih(Ga.fromNodeStream(t)):Vn(t)?this.source=new ih(Ga.fromDOMStream(t)):Zn(t)?this.source=new ih(Ga.fromDOMStream(t.body)):kn(t)?this.source=new ih(Ga.fromIterable(t)):(zn(t)||Dn(t))&&(this.source=new ih(Ga.fromAsyncIterable(t)))}[Symbol.asyncIterator](){return this}next(t){return this.source.next(t)}throw(t){return this.source.throw(t)}return(t){return this.source.return(t)}get closed(){return this.source.closed}cancel(t){return this.source.cancel(t)}peek(t){return this.source.peek(t)}read(t){return this.source.read(t)}}class eh{constructor(t){this.source=t}cancel(t){this.return(t)}peek(t){return this.next(t,"peek").value}read(t){return this.next(t,"read").value}next(t,e="read"){return this.source.next({cmd:e,size:t})}throw(t){return Object.create(this.source.throw&&this.source.throw(t)||$a)}return(t){return Object.create(this.source.return&&this.source.return(t)||$a)}}class ih{constructor(t){this.source=t,this._closedPromise=new Promise((t=>this._closedPromiseResolve=t))}cancel(t){return gn(this,void 0,void 0,(function*(){yield this.return(t)}))}get closed(){return this._closedPromise}read(t){return gn(this,void 0,void 0,(function*(){return(yield this.next(t,"read")).value}))}peek(t){return gn(this,void 0,void 0,(function*(){return(yield this.next(t,"peek")).value}))}next(t,e="read"){return gn(this,void 0,void 0,(function*(){return yield this.source.next({cmd:e,size:t})}))}throw(t){return gn(this,void 0,void 0,(function*(){const e=this.source.throw&&(yield this.source.throw(t))||$a;return this._closedPromiseResolve&&this._closedPromiseResolve(),this._closedPromiseResolve=void 0,Object.create(e)}))}return(t){return gn(this,void 0,void 0,(function*(){const e=this.source.return&&(yield this.source.return(t))||$a;return this._closedPromiseResolve&&this._closedPromiseResolve(),this._closedPromiseResolve=void 0,Object.create(e)}))}}class nh extends Qa{constructor(t,e){super(),this.position=0,this.buffer=Kn(t),this.size=void 0===e?this.buffer.byteLength:e}readInt32(t){const{buffer:e,byteOffset:i}=this.readAt(t,4);return new DataView(e,i).getInt32(0,!0)}seek(t){return this.position=Math.min(t,this.size),t<this.size}read(t){const{buffer:e,size:i,position:n}=this;return e&&n<i?("number"!=typeof t&&(t=Number.POSITIVE_INFINITY),this.position=Math.min(i,n+Math.min(i-n,t)),e.subarray(n,this.position)):null}readAt(t,e){const i=this.buffer,n=Math.min(this.size,t+e);return i?i.subarray(t,n):new Uint8Array(e)}close(){this.buffer&&(this.buffer=null)}throw(t){return this.close(),{done:!0,value:t}}return(t){return this.close(),{done:!0,value:t}}}class sh extends th{constructor(t,e){super(),this.position=0,this._handle=t,"number"==typeof e?this.size=e:this._pending=(()=>gn(this,void 0,void 0,(function*(){this.size=(yield t.stat()).size,delete this._pending})))()}readInt32(t){return gn(this,void 0,void 0,(function*(){const{buffer:e,byteOffset:i}=yield this.readAt(t,4);return new DataView(e,i).getInt32(0,!0)}))}seek(t){return gn(this,void 0,void 0,(function*(){return this._pending&&(yield this._pending),this.position=Math.min(t,this.size),t<this.size}))}read(t){return gn(this,void 0,void 0,(function*(){this._pending&&(yield this._pending);const{_handle:e,size:i,position:n}=this;if(e&&n<i){"number"!=typeof t&&(t=Number.POSITIVE_INFINITY);let s=n,r=0,o=0;const a=Math.min(i,s+Math.min(i-s,t)),h=new Uint8Array(Math.max(0,(this.position=a)-s));for(;(s+=o)<a&&(r+=o)<h.byteLength;)({bytesRead:o}=yield e.read(h,r,h.byteLength-r,s));return h}return null}))}readAt(t,e){return gn(this,void 0,void 0,(function*(){this._pending&&(yield this._pending);const{_handle:i,size:n}=this;if(i&&t+e<n){const s=Math.min(n,t+e),r=new Uint8Array(s-t);return(yield i.read(r,0,e,t)).buffer}return new Uint8Array(e)}))}close(){return gn(this,void 0,void 0,(function*(){const t=this._handle;this._handle=null,t&&(yield t.close())}))}throw(t){return gn(this,void 0,void 0,(function*(){return yield this.close(),{done:!0,value:t}}))}return(t){return gn(this,void 0,void 0,(function*(){return yield this.close(),{done:!0,value:t}}))}}function rh(t){return t<0&&(t=4294967295+t+1),`0x${t.toString(16)}`}const oh=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8];class ah{constructor(t){this.buffer=t}high(){return this.buffer[1]}low(){return this.buffer[0]}_times(t){const e=new Uint32Array([this.buffer[1]>>>16,65535&this.buffer[1],this.buffer[0]>>>16,65535&this.buffer[0]]),i=new Uint32Array([t.buffer[1]>>>16,65535&t.buffer[1],t.buffer[0]>>>16,65535&t.buffer[0]]);let n=e[3]*i[3];this.buffer[0]=65535&n;let s=n>>>16;return n=e[2]*i[3],s+=n,n=e[3]*i[2]>>>0,s+=n,this.buffer[0]+=s<<16,this.buffer[1]=s>>>0<n?65536:0,this.buffer[1]+=s>>>16,this.buffer[1]+=e[1]*i[3]+e[2]*i[2]+e[3]*i[1],this.buffer[1]+=e[0]*i[3]+e[1]*i[2]+e[2]*i[1]+e[3]*i[0]<<16,this}_plus(t){const e=this.buffer[0]+t.buffer[0]>>>0;this.buffer[1]+=t.buffer[1],e<this.buffer[0]>>>0&&++this.buffer[1],this.buffer[0]=e}lessThan(t){return this.buffer[1]<t.buffer[1]||this.buffer[1]===t.buffer[1]&&this.buffer[0]<t.buffer[0]}equals(t){return this.buffer[1]===t.buffer[1]&&this.buffer[0]==t.buffer[0]}greaterThan(t){return t.lessThan(this)}hex(){return`${rh(this.buffer[1])} ${rh(this.buffer[0])}`}}class hh extends ah{times(t){return this._times(t),this}plus(t){return this._plus(t),this}static from(t,e=new Uint32Array(2)){return hh.fromString("string"==typeof t?t:t.toString(),e)}static fromNumber(t,e=new Uint32Array(2)){return hh.fromString(t.toString(),e)}static fromString(t,e=new Uint32Array(2)){const i=t.length,n=new hh(e);for(let e=0;e<i;){const s=8<i-e?8:i-e,r=new hh(new Uint32Array([Number.parseInt(t.slice(e,e+s),10),0])),o=new hh(new Uint32Array([oh[s],0]));n.times(o),n.plus(r),e+=s}return n}static convertArray(t){const e=new Uint32Array(2*t.length);for(let i=-1,n=t.length;++i<n;)hh.from(t[i],new Uint32Array(e.buffer,e.byteOffset+2*i*4,2));return e}static multiply(t,e){return new hh(new Uint32Array(t.buffer)).times(e)}static add(t,e){return new hh(new Uint32Array(t.buffer)).plus(e)}}class lh extends ah{negate(){return this.buffer[0]=1+~this.buffer[0],this.buffer[1]=~this.buffer[1],0==this.buffer[0]&&++this.buffer[1],this}times(t){return this._times(t),this}plus(t){return this._plus(t),this}lessThan(t){const e=this.buffer[1]<<0,i=t.buffer[1]<<0;return e<i||e===i&&this.buffer[0]<t.buffer[0]}static from(t,e=new Uint32Array(2)){return lh.fromString("string"==typeof t?t:t.toString(),e)}static fromNumber(t,e=new Uint32Array(2)){return lh.fromString(t.toString(),e)}static fromString(t,e=new Uint32Array(2)){const i=t.startsWith("-"),n=t.length,s=new lh(e);for(let e=i?1:0;e<n;){const i=8<n-e?8:n-e,r=new lh(new Uint32Array([Number.parseInt(t.slice(e,e+i),10),0])),o=new lh(new Uint32Array([oh[i],0]));s.times(o),s.plus(r),e+=i}return i?s.negate():s}static convertArray(t){const e=new Uint32Array(2*t.length);for(let i=-1,n=t.length;++i<n;)lh.from(t[i],new Uint32Array(e.buffer,e.byteOffset+2*i*4,2));return e}static multiply(t,e){return new lh(new Uint32Array(t.buffer)).times(e)}static add(t,e){return new lh(new Uint32Array(t.buffer)).plus(e)}}class uh{constructor(t){this.buffer=t}high(){return new lh(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2))}low(){return new lh(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset,2))}negate(){return this.buffer[0]=1+~this.buffer[0],this.buffer[1]=~this.buffer[1],this.buffer[2]=~this.buffer[2],this.buffer[3]=~this.buffer[3],0==this.buffer[0]&&++this.buffer[1],0==this.buffer[1]&&++this.buffer[2],0==this.buffer[2]&&++this.buffer[3],this}times(t){const e=new hh(new Uint32Array([this.buffer[3],0])),i=new hh(new Uint32Array([this.buffer[2],0])),n=new hh(new Uint32Array([this.buffer[1],0])),s=new hh(new Uint32Array([this.buffer[0],0])),r=new hh(new Uint32Array([t.buffer[3],0])),o=new hh(new Uint32Array([t.buffer[2],0])),a=new hh(new Uint32Array([t.buffer[1],0])),h=new hh(new Uint32Array([t.buffer[0],0]));let l=hh.multiply(s,h);this.buffer[0]=l.low();const u=new hh(new Uint32Array([l.high(),0]));return l=hh.multiply(n,h),u.plus(l),l=hh.multiply(s,a),u.plus(l),this.buffer[1]=u.low(),this.buffer[3]=u.lessThan(l)?1:0,this.buffer[2]=u.high(),new hh(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2)).plus(hh.multiply(i,h)).plus(hh.multiply(n,a)).plus(hh.multiply(s,o)),this.buffer[3]+=hh.multiply(e,h).plus(hh.multiply(i,a)).plus(hh.multiply(n,o)).plus(hh.multiply(s,r)).low(),this}plus(t){const e=new Uint32Array(4);return e[3]=this.buffer[3]+t.buffer[3]>>>0,e[2]=this.buffer[2]+t.buffer[2]>>>0,e[1]=this.buffer[1]+t.buffer[1]>>>0,e[0]=this.buffer[0]+t.buffer[0]>>>0,e[0]<this.buffer[0]>>>0&&++e[1],e[1]<this.buffer[1]>>>0&&++e[2],e[2]<this.buffer[2]>>>0&&++e[3],this.buffer[3]=e[3],this.buffer[2]=e[2],this.buffer[1]=e[1],this.buffer[0]=e[0],this}hex(){return`${rh(this.buffer[3])} ${rh(this.buffer[2])} ${rh(this.buffer[1])} ${rh(this.buffer[0])}`}static multiply(t,e){return new uh(new Uint32Array(t.buffer)).times(e)}static add(t,e){return new uh(new Uint32Array(t.buffer)).plus(e)}static from(t,e=new Uint32Array(4)){return uh.fromString("string"==typeof t?t:t.toString(),e)}static fromNumber(t,e=new Uint32Array(4)){return uh.fromString(t.toString(),e)}static fromString(t,e=new Uint32Array(4)){const i=t.startsWith("-"),n=t.length,s=new uh(e);for(let e=i?1:0;e<n;){const i=8<n-e?8:n-e,r=new uh(new Uint32Array([Number.parseInt(t.slice(e,e+i),10),0,0,0])),o=new uh(new Uint32Array([oh[i],0,0,0]));s.times(o),s.plus(r),e+=i}return i?s.negate():s}static convertArray(t){const e=new Uint32Array(4*t.length);for(let i=-1,n=t.length;++i<n;)uh.from(t[i],new Uint32Array(e.buffer,e.byteOffset+16*i,4));return e}}class ch extends Qs{constructor(t,e,i,n){super(),this.nodesIndex=-1,this.buffersIndex=-1,this.bytes=t,this.nodes=e,this.buffers=i,this.dictionaries=n}visit(t){return super.visit(t instanceof Yo?t.type:t)}visitNull(t,{length:e}=this.nextFieldNode()){return Ho({type:t,length:e})}visitBool(t,{length:e,nullCount:i}=this.nextFieldNode()){return Ho({type:t,length:e,nullCount:i,nullBitmap:this.readNullBitmap(t,i),data:this.readData(t)})}visitInt(t,{length:e,nullCount:i}=this.nextFieldNode()){return Ho({type:t,length:e,nullCount:i,nullBitmap:this.readNullBitmap(t,i),data:this.readData(t)})}visitFloat(t,{length:e,nullCount:i}=this.nextFieldNode()){return Ho({type:t,length:e,nullCount:i,nullBitmap:this.readNullBitmap(t,i),data:this.readData(t)})}visitUtf8(t,{length:e,nullCount:i}=this.nextFieldNode()){return Ho({type:t,length:e,nullCount:i,nullBitmap:this.readNullBitmap(t,i),valueOffsets:this.readOffsets(t),data:this.readData(t)})}visitBinary(t,{length:e,nullCount:i}=this.nextFieldNode()){return Ho({type:t,length:e,nullCount:i,nullBitmap:this.readNullBitmap(t,i),valueOffsets:this.readOffsets(t),data:this.readData(t)})}visitFixedSizeBinary(t,{length:e,nullCount:i}=this.nextFieldNode()){return Ho({type:t,length:e,nullCount:i,nullBitmap:this.readNullBitmap(t,i),data:this.readData(t)})}visitDate(t,{length:e,nullCount:i}=this.nextFieldNode()){return Ho({type:t,length:e,nullCount:i,nullBitmap:this.readNullBitmap(t,i),data:this.readData(t)})}visitTimestamp(t,{length:e,nullCount:i}=this.nextFieldNode()){return Ho({type:t,length:e,nullCount:i,nullBitmap:this.readNullBitmap(t,i),data:this.readData(t)})}visitTime(t,{length:e,nullCount:i}=this.nextFieldNode()){return Ho({type:t,length:e,nullCount:i,nullBitmap:this.readNullBitmap(t,i),data:this.readData(t)})}visitDecimal(t,{length:e,nullCount:i}=this.nextFieldNode()){return Ho({type:t,length:e,nullCount:i,nullBitmap:this.readNullBitmap(t,i),data:this.readData(t)})}visitList(t,{length:e,nullCount:i}=this.nextFieldNode()){return Ho({type:t,length:e,nullCount:i,nullBitmap:this.readNullBitmap(t,i),valueOffsets:this.readOffsets(t),child:this.visit(t.children[0])})}visitStruct(t,{length:e,nullCount:i}=this.nextFieldNode()){return Ho({type:t,length:e,nullCount:i,nullBitmap:this.readNullBitmap(t,i),children:this.visitMany(t.children)})}visitUnion(t){return t.mode===rn.Sparse?this.visitSparseUnion(t):this.visitDenseUnion(t)}visitDenseUnion(t,{length:e,nullCount:i}=this.nextFieldNode()){return Ho({type:t,length:e,nullCount:i,nullBitmap:this.readNullBitmap(t,i),typeIds:this.readTypeIds(t),valueOffsets:this.readOffsets(t),children:this.visitMany(t.children)})}visitSparseUnion(t,{length:e,nullCount:i}=this.nextFieldNode()){return Ho({type:t,length:e,nullCount:i,nullBitmap:this.readNullBitmap(t,i),typeIds:this.readTypeIds(t),children:this.visitMany(t.children)})}visitDictionary(t,{length:e,nullCount:i}=this.nextFieldNode()){return Ho({type:t,length:e,nullCount:i,nullBitmap:this.readNullBitmap(t,i),data:this.readData(t.indices),dictionary:this.readDictionary(t)})}visitInterval(t,{length:e,nullCount:i}=this.nextFieldNode()){return Ho({type:t,length:e,nullCount:i,nullBitmap:this.readNullBitmap(t,i),data:this.readData(t)})}visitFixedSizeList(t,{length:e,nullCount:i}=this.nextFieldNode()){return Ho({type:t,length:e,nullCount:i,nullBitmap:this.readNullBitmap(t,i),child:this.visit(t.children[0])})}visitMap(t,{length:e,nullCount:i}=this.nextFieldNode()){return Ho({type:t,length:e,nullCount:i,nullBitmap:this.readNullBitmap(t,i),valueOffsets:this.readOffsets(t),child:this.visit(t.children[0])})}nextFieldNode(){return this.nodes[++this.nodesIndex]}nextBufferRange(){return this.buffers[++this.buffersIndex]}readNullBitmap(t,e,i=this.nextBufferRange()){return e>0&&this.readData(t,i)||new Uint8Array(0)}readOffsets(t,e){return this.readData(t,e)}readTypeIds(t,e){return this.readData(t,e)}readData(t,{length:e,offset:i}=this.nextBufferRange()){return this.bytes.subarray(i,i+e)}readDictionary(t){return this.dictionaries.get(t.id)}}class dh extends ch{constructor(t,e,i,n){super(new Uint8Array(0),e,i,n),this.sources=t}readNullBitmap(t,e,{offset:i}=this.nextBufferRange()){return e<=0?new Uint8Array(0):Mo(this.sources[i])}readOffsets(t,{offset:e}=this.nextBufferRange()){return Yn(Uint8Array,Yn(Int32Array,this.sources[e]))}readTypeIds(t,{offset:e}=this.nextBufferRange()){return Yn(Uint8Array,Yn(t.ArrayType,this.sources[e]))}readData(t,{offset:e}=this.nextBufferRange()){const{sources:i}=this;return Cs.isTimestamp(t)||(Cs.isInt(t)||Cs.isTime(t))&&64===t.bitWidth||Cs.isDate(t)&&t.unit===an.MILLISECOND?Yn(Uint8Array,lh.convertArray(i[e])):Cs.isDecimal(t)?Yn(Uint8Array,uh.convertArray(i[e])):Cs.isBinary(t)||Cs.isFixedSizeBinary(t)?function(t){const e=t.join(""),i=new Uint8Array(e.length/2);for(let t=0;t<e.length;t+=2)i[t>>1]=Number.parseInt(e.slice(t,t+2),16);return i}(i[e]):Cs.isBool(t)?Mo(i[e]):Cs.isUtf8(t)?Tn(i[e].join("")):Yn(Uint8Array,Yn(t.ArrayType,i[e].map((t=>+t))))}}var fh,ph,mh,_h,yh,gh,vh,bh;!function(t){t[t.BUFFER=0]="BUFFER"}(fh||(fh={})),function(t){t[t.LZ4_FRAME=0]="LZ4_FRAME",t[t.ZSTD=1]="ZSTD"}(ph||(ph={}));class wh{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsBodyCompression(t,e){return(e||new wh).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsBodyCompression(t,e){return t.setPosition(t.position()+4),(e||new wh).__init(t.readInt32(t.position())+t.position(),t)}codec(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt8(this.bb_pos+t):ph.LZ4_FRAME}method(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt8(this.bb_pos+t):fh.BUFFER}static startBodyCompression(t){t.startObject(2)}static addCodec(t,e){t.addFieldInt8(0,e,ph.LZ4_FRAME)}static addMethod(t,e){t.addFieldInt8(1,e,fh.BUFFER)}static endBodyCompression(t){return t.endObject()}static createBodyCompression(t,e,i){return wh.startBodyCompression(t),wh.addCodec(t,e),wh.addMethod(t,i),wh.endBodyCompression(t)}}class xh{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}offset(){return this.bb.readInt64(this.bb_pos)}length(){return this.bb.readInt64(this.bb_pos+8)}static sizeOf(){return 16}static createBuffer(t,e,i){return t.prep(8,16),t.writeInt64(i),t.writeInt64(e),t.offset()}}class Mh{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}length(){return this.bb.readInt64(this.bb_pos)}nullCount(){return this.bb.readInt64(this.bb_pos+8)}static sizeOf(){return 16}static createFieldNode(t,e,i){return t.prep(8,16),t.writeInt64(i),t.writeInt64(e),t.offset()}}class Sh{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsRecordBatch(t,e){return(e||new Sh).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsRecordBatch(t,e){return t.setPosition(t.position()+4),(e||new Sh).__init(t.readInt32(t.position())+t.position(),t)}length(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt64(this.bb_pos+t):this.bb.createLong(0,0)}nodes(t,e){const i=this.bb.__offset(this.bb_pos,6);return i?(e||new Mh).__init(this.bb.__vector(this.bb_pos+i)+16*t,this.bb):null}nodesLength(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}buffers(t,e){const i=this.bb.__offset(this.bb_pos,8);return i?(e||new xh).__init(this.bb.__vector(this.bb_pos+i)+16*t,this.bb):null}buffersLength(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}compression(t){const e=this.bb.__offset(this.bb_pos,10);return e?(t||new wh).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}static startRecordBatch(t){t.startObject(4)}static addLength(t,e){t.addFieldInt64(0,e,t.createLong(0,0))}static addNodes(t,e){t.addFieldOffset(1,e,0)}static startNodesVector(t,e){t.startVector(16,e,8)}static addBuffers(t,e){t.addFieldOffset(2,e,0)}static startBuffersVector(t,e){t.startVector(16,e,8)}static addCompression(t,e){t.addFieldOffset(3,e,0)}static endRecordBatch(t){return t.endObject()}}class Ih{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsDictionaryBatch(t,e){return(e||new Ih).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDictionaryBatch(t,e){return t.setPosition(t.position()+4),(e||new Ih).__init(t.readInt32(t.position())+t.position(),t)}id(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt64(this.bb_pos+t):this.bb.createLong(0,0)}data(t){const e=this.bb.__offset(this.bb_pos,6);return e?(t||new Sh).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}isDelta(){const t=this.bb.__offset(this.bb_pos,8);return!!t&&!!this.bb.readInt8(this.bb_pos+t)}static startDictionaryBatch(t){t.startObject(3)}static addId(t,e){t.addFieldInt64(0,e,t.createLong(0,0))}static addData(t,e){t.addFieldOffset(1,e,0)}static addIsDelta(t,e){t.addFieldInt8(2,+e,0)}static endDictionaryBatch(t){return t.endObject()}}!function(t){t[t.HALF=0]="HALF",t[t.SINGLE=1]="SINGLE",t[t.DOUBLE=2]="DOUBLE"}(mh||(mh={}));class Th{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsFloatingPoint(t,e){return(e||new Th).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFloatingPoint(t,e){return t.setPosition(t.position()+4),(e||new Th).__init(t.readInt32(t.position())+t.position(),t)}precision(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):mh.HALF}static startFloatingPoint(t){t.startObject(1)}static addPrecision(t,e){t.addFieldInt16(0,e,mh.HALF)}static endFloatingPoint(t){return t.endObject()}static createFloatingPoint(t,e){return Th.startFloatingPoint(t),Th.addPrecision(t,e),Th.endFloatingPoint(t)}}class Lh{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsDecimal(t,e){return(e||new Lh).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDecimal(t,e){return t.setPosition(t.position()+4),(e||new Lh).__init(t.readInt32(t.position())+t.position(),t)}precision(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}scale(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt32(this.bb_pos+t):0}bitWidth(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readInt32(this.bb_pos+t):128}static startDecimal(t){t.startObject(3)}static addPrecision(t,e){t.addFieldInt32(0,e,0)}static addScale(t,e){t.addFieldInt32(1,e,0)}static addBitWidth(t,e){t.addFieldInt32(2,e,128)}static endDecimal(t){return t.endObject()}static createDecimal(t,e,i,n){return Lh.startDecimal(t),Lh.addPrecision(t,e),Lh.addScale(t,i),Lh.addBitWidth(t,n),Lh.endDecimal(t)}}!function(t){t[t.DAY=0]="DAY",t[t.MILLISECOND=1]="MILLISECOND"}(_h||(_h={}));class Ah{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsDate(t,e){return(e||new Ah).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDate(t,e){return t.setPosition(t.position()+4),(e||new Ah).__init(t.readInt32(t.position())+t.position(),t)}unit(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):_h.MILLISECOND}static startDate(t){t.startObject(1)}static addUnit(t,e){t.addFieldInt16(0,e,_h.MILLISECOND)}static endDate(t){return t.endObject()}static createDate(t,e){return Ah.startDate(t),Ah.addUnit(t,e),Ah.endDate(t)}}!function(t){t[t.SECOND=0]="SECOND",t[t.MILLISECOND=1]="MILLISECOND",t[t.MICROSECOND=2]="MICROSECOND",t[t.NANOSECOND=3]="NANOSECOND"}(yh||(yh={}));class Ph{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsTime(t,e){return(e||new Ph).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsTime(t,e){return t.setPosition(t.position()+4),(e||new Ph).__init(t.readInt32(t.position())+t.position(),t)}unit(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):yh.MILLISECOND}bitWidth(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt32(this.bb_pos+t):32}static startTime(t){t.startObject(2)}static addUnit(t,e){t.addFieldInt16(0,e,yh.MILLISECOND)}static addBitWidth(t,e){t.addFieldInt32(1,e,32)}static endTime(t){return t.endObject()}static createTime(t,e,i){return Ph.startTime(t),Ph.addUnit(t,e),Ph.addBitWidth(t,i),Ph.endTime(t)}}class Ch{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsTimestamp(t,e){return(e||new Ch).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsTimestamp(t,e){return t.setPosition(t.position()+4),(e||new Ch).__init(t.readInt32(t.position())+t.position(),t)}unit(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):yh.SECOND}timezone(t){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__string(this.bb_pos+e,t):null}static startTimestamp(t){t.startObject(2)}static addUnit(t,e){t.addFieldInt16(0,e,yh.SECOND)}static addTimezone(t,e){t.addFieldOffset(1,e,0)}static endTimestamp(t){return t.endObject()}static createTimestamp(t,e,i){return Ch.startTimestamp(t),Ch.addUnit(t,e),Ch.addTimezone(t,i),Ch.endTimestamp(t)}}!function(t){t[t.YEAR_MONTH=0]="YEAR_MONTH",t[t.DAY_TIME=1]="DAY_TIME",t[t.MONTH_DAY_NANO=2]="MONTH_DAY_NANO"}(gh||(gh={}));class Bh{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsInterval(t,e){return(e||new Bh).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsInterval(t,e){return t.setPosition(t.position()+4),(e||new Bh).__init(t.readInt32(t.position())+t.position(),t)}unit(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):gh.YEAR_MONTH}static startInterval(t){t.startObject(1)}static addUnit(t,e){t.addFieldInt16(0,e,gh.YEAR_MONTH)}static endInterval(t){return t.endObject()}static createInterval(t,e){return Bh.startInterval(t),Bh.addUnit(t,e),Bh.endInterval(t)}}!function(t){t[t.Sparse=0]="Sparse",t[t.Dense=1]="Dense"}(vh||(vh={}));class Oh{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsUnion(t,e){return(e||new Oh).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsUnion(t,e){return t.setPosition(t.position()+4),(e||new Oh).__init(t.readInt32(t.position())+t.position(),t)}mode(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):vh.Sparse}typeIds(t){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readInt32(this.bb.__vector(this.bb_pos+e)+4*t):0}typeIdsLength(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}typeIdsArray(){const t=this.bb.__offset(this.bb_pos,6);return t?new Int32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}static startUnion(t){t.startObject(2)}static addMode(t,e){t.addFieldInt16(0,e,vh.Sparse)}static addTypeIds(t,e){t.addFieldOffset(1,e,0)}static createTypeIdsVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addInt32(e[i]);return t.endVector()}static startTypeIdsVector(t,e){t.startVector(4,e,4)}static endUnion(t){return t.endObject()}static createUnion(t,e,i){return Oh.startUnion(t),Oh.addMode(t,e),Oh.addTypeIds(t,i),Oh.endUnion(t)}}class Eh{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsFixedSizeBinary(t,e){return(e||new Eh).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFixedSizeBinary(t,e){return t.setPosition(t.position()+4),(e||new Eh).__init(t.readInt32(t.position())+t.position(),t)}byteWidth(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}static startFixedSizeBinary(t){t.startObject(1)}static addByteWidth(t,e){t.addFieldInt32(0,e,0)}static endFixedSizeBinary(t){return t.endObject()}static createFixedSizeBinary(t,e){return Eh.startFixedSizeBinary(t),Eh.addByteWidth(t,e),Eh.endFixedSizeBinary(t)}}class Nh{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsFixedSizeList(t,e){return(e||new Nh).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFixedSizeList(t,e){return t.setPosition(t.position()+4),(e||new Nh).__init(t.readInt32(t.position())+t.position(),t)}listSize(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}static startFixedSizeList(t){t.startObject(1)}static addListSize(t,e){t.addFieldInt32(0,e,0)}static endFixedSizeList(t){return t.endObject()}static createFixedSizeList(t,e){return Nh.startFixedSizeList(t),Nh.addListSize(t,e),Nh.endFixedSizeList(t)}}class zh{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsMap(t,e){return(e||new zh).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsMap(t,e){return t.setPosition(t.position()+4),(e||new zh).__init(t.readInt32(t.position())+t.position(),t)}keysSorted(){const t=this.bb.__offset(this.bb_pos,4);return!!t&&!!this.bb.readInt8(this.bb_pos+t)}static startMap(t){t.startObject(1)}static addKeysSorted(t,e){t.addFieldInt8(0,+e,0)}static endMap(t){return t.endObject()}static createMap(t,e){return zh.startMap(t),zh.addKeysSorted(t,e),zh.endMap(t)}}!function(t){t[t.NONE=0]="NONE",t[t.Schema=1]="Schema",t[t.DictionaryBatch=2]="DictionaryBatch",t[t.RecordBatch=3]="RecordBatch",t[t.Tensor=4]="Tensor",t[t.SparseTensor=5]="SparseTensor"}(bh||(bh={}));class kh{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsMessage(t,e){return(e||new kh).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsMessage(t,e){return t.setPosition(t.position()+4),(e||new kh).__init(t.readInt32(t.position())+t.position(),t)}version(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Ta.V1}headerType(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readUint8(this.bb_pos+t):bh.NONE}header(t){const e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__union(t,this.bb_pos+e):null}bodyLength(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.readInt64(this.bb_pos+t):this.bb.createLong(0,0)}customMetadata(t,e){const i=this.bb.__offset(this.bb_pos,12);return i?(e||new Oa).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+i)+4*t),this.bb):null}customMetadataLength(){const t=this.bb.__offset(this.bb_pos,12);return t?this.bb.__vector_len(this.bb_pos+t):0}static startMessage(t){t.startObject(5)}static addVersion(t,e){t.addFieldInt16(0,e,Ta.V1)}static addHeaderType(t,e){t.addFieldInt8(1,e,bh.NONE)}static addHeader(t,e){t.addFieldOffset(2,e,0)}static addBodyLength(t,e){t.addFieldInt64(3,e,t.createLong(0,0))}static addCustomMetadata(t,e){t.addFieldOffset(4,e,0)}static createCustomMetadataVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addOffset(e[i]);return t.endVector()}static startCustomMetadataVector(t,e){t.startVector(4,e,4)}static endMessage(t){return t.endObject()}static finishMessageBuffer(t,e){t.finish(e)}static finishSizePrefixedMessageBuffer(t,e){t.finish(e,void 0,!0)}static createMessage(t,e,i,n,s,r){return kh.startMessage(t),kh.addVersion(t,e),kh.addHeaderType(t,i),kh.addHeader(t,n),kh.addBodyLength(t,s),kh.addCustomMetadata(t,r),kh.endMessage(t)}}class Dh{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsNull(t,e){return(e||new Dh).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsNull(t,e){return t.setPosition(t.position()+4),(e||new Dh).__init(t.readInt32(t.position())+t.position(),t)}static startNull(t){t.startObject(0)}static endNull(t){return t.endObject()}static createNull(t){return Dh.startNull(t),Dh.endNull(t)}}class Fh{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsBinary(t,e){return(e||new Fh).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsBinary(t,e){return t.setPosition(t.position()+4),(e||new Fh).__init(t.readInt32(t.position())+t.position(),t)}static startBinary(t){t.startObject(0)}static endBinary(t){return t.endObject()}static createBinary(t){return Fh.startBinary(t),Fh.endBinary(t)}}class Rh{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsBool(t,e){return(e||new Rh).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsBool(t,e){return t.setPosition(t.position()+4),(e||new Rh).__init(t.readInt32(t.position())+t.position(),t)}static startBool(t){t.startObject(0)}static endBool(t){return t.endObject()}static createBool(t){return Rh.startBool(t),Rh.endBool(t)}}class Uh{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsUtf8(t,e){return(e||new Uh).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsUtf8(t,e){return t.setPosition(t.position()+4),(e||new Uh).__init(t.readInt32(t.position())+t.position(),t)}static startUtf8(t){t.startObject(0)}static endUtf8(t){return t.endObject()}static createUtf8(t){return Uh.startUtf8(t),Uh.endUtf8(t)}}class Zh{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsList(t,e){return(e||new Zh).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsList(t,e){return t.setPosition(t.position()+4),(e||new Zh).__init(t.readInt32(t.position())+t.position(),t)}static startList(t){t.startObject(0)}static endList(t){return t.endObject()}static createList(t){return Zh.startList(t),Zh.endList(t)}}class jh{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsStruct_(t,e){return(e||new jh).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsStruct_(t,e){return t.setPosition(t.position()+4),(e||new jh).__init(t.readInt32(t.position())+t.position(),t)}static startStruct_(t){t.startObject(0)}static endStruct_(t){return t.endObject()}static createStruct_(t){return jh.startStruct_(t),jh.endStruct_(t)}}var Vh=Sa;const Gh=new class extends Qs{visit(t,e){return null==t||null==e?void 0:super.visit(t,e)}visitNull(t,e){return Dh.startNull(e),Dh.endNull(e)}visitInt(t,e){return Ea.startInt(e),Ea.addBitWidth(e,t.bitWidth),Ea.addIsSigned(e,t.isSigned),Ea.endInt(e)}visitFloat(t,e){return Th.startFloatingPoint(e),Th.addPrecision(e,t.precision),Th.endFloatingPoint(e)}visitBinary(t,e){return Fh.startBinary(e),Fh.endBinary(e)}visitBool(t,e){return Rh.startBool(e),Rh.endBool(e)}visitUtf8(t,e){return Uh.startUtf8(e),Uh.endUtf8(e)}visitDecimal(t,e){return Lh.startDecimal(e),Lh.addScale(e,t.scale),Lh.addPrecision(e,t.precision),Lh.addBitWidth(e,t.bitWidth),Lh.endDecimal(e)}visitDate(t,e){return Ah.startDate(e),Ah.addUnit(e,t.unit),Ah.endDate(e)}visitTime(t,e){return Ph.startTime(e),Ph.addUnit(e,t.unit),Ph.addBitWidth(e,t.bitWidth),Ph.endTime(e)}visitTimestamp(t,e){const i=t.timezone&&e.createString(t.timezone)||void 0;return Ch.startTimestamp(e),Ch.addUnit(e,t.unit),void 0!==i&&Ch.addTimezone(e,i),Ch.endTimestamp(e)}visitInterval(t,e){return Bh.startInterval(e),Bh.addUnit(e,t.unit),Bh.endInterval(e)}visitList(t,e){return Zh.startList(e),Zh.endList(e)}visitStruct(t,e){return jh.startStruct_(e),jh.endStruct_(e)}visitUnion(t,e){Oh.startTypeIdsVector(e,t.typeIds.length);const i=Oh.createTypeIdsVector(e,t.typeIds);return Oh.startUnion(e),Oh.addMode(e,t.mode),Oh.addTypeIds(e,i),Oh.endUnion(e)}visitDictionary(t,e){const i=this.visit(t.indices,e);return Na.startDictionaryEncoding(e),Na.addId(e,new Vh(t.id,0)),Na.addIsOrdered(e,t.isOrdered),void 0!==i&&Na.addIndexType(e,i),Na.endDictionaryEncoding(e)}visitFixedSizeBinary(t,e){return Eh.startFixedSizeBinary(e),Eh.addByteWidth(e,t.byteWidth),Eh.endFixedSizeBinary(e)}visitFixedSizeList(t,e){return Nh.startFixedSizeList(e),Nh.addListSize(e,t.listSize),Nh.endFixedSizeList(e)}visitMap(t,e){return zh.startMap(e),zh.addKeysSorted(e,t.keysSorted),zh.endMap(e)}};function qh(t){return new il(t.count,Hh(t.columns),$h(t.columns))}function Wh(t,e){return(t.children||[]).filter(Boolean).map((t=>Yo.fromJSON(t,e)))}function Hh(t){return(t||[]).reduce(((t,e)=>{return[...t,new rl(e.count,(i=e.VALIDITY,(i||[]).reduce(((t,e)=>t+ +(0===e)),0))),...Hh(e.children)];var i}),[])}function $h(t,e=[]){for(let i=-1,n=(t||[]).length;++i<n;){const n=t[i];n.VALIDITY&&e.push(new sl(e.length,n.VALIDITY.length)),n.TYPE&&e.push(new sl(e.length,n.TYPE.length)),n.OFFSET&&e.push(new sl(e.length,n.OFFSET.length)),n.DATA&&e.push(new sl(e.length,n.DATA.length)),e=$h(n.children,e)}return e}function Yh(t){return new Map(Object.entries(t||{}))}function Xh(t){return new Os(t.isSigned,t.bitWidth)}function Kh(t,e){const i=t.type.name;switch(i){case"NONE":case"null":return new Bs;case"binary":return new zs;case"utf8":return new ks;case"bool":return new Ds;case"list":return new Vs((e||[])[0]);case"struct":case"struct_":return new Gs(e||[])}switch(i){case"int":{const e=t.type;return new Os(e.isSigned,e.bitWidth)}case"floatingpoint":{const e=t.type;return new Ns(on[e.precision])}case"decimal":{const e=t.type;return new Fs(e.scale,e.precision,e.bitWidth)}case"date":{const e=t.type;return new Rs(an[e.unit])}case"time":{const e=t.type;return new Us(hn[e.unit],e.bitWidth)}case"timestamp":{const e=t.type;return new Zs(hn[e.unit],e.timezone)}case"interval":{const e=t.type;return new js(ln[e.unit])}case"union":{const i=t.type;return new qs(rn[i.mode],i.typeIds||[],e||[])}case"fixedsizebinary":{const e=t.type;return new Ws(e.byteWidth)}case"fixedsizelist":{const i=t.type;return new Hs(i.listSize,(e||[])[0])}case"map":{const i=t.type;return new $s((e||[])[0],i.keysSorted)}}throw new Error(`Unrecognized type: "${i}"`)}var Jh=Sa,Qh=Ba,tl=Ca;class el{constructor(t,e,i,n){this._version=e,this._headerType=i,this.body=new Uint8Array(0),n&&(this._createHeader=()=>n),this._bodyLength="number"==typeof t?t:t.low}static fromJSON(t,e){const i=new el(0,sn.V4,e);return i._createHeader=function(t,e){return()=>{switch(e){case un.Schema:return $o.fromJSON(t);case un.RecordBatch:return il.fromJSON(t);case un.DictionaryBatch:return nl.fromJSON(t)}throw new Error(`Unrecognized Message type: { name: ${un[e]}, type: ${e} }`)}}(t,e),i}static decode(t){t=new tl(Kn(t));const e=kh.getRootAsMessage(t),i=e.bodyLength(),n=e.version(),s=e.headerType(),r=new el(i,n,s);return r._createHeader=function(t,e){return()=>{switch(e){case un.Schema:return $o.decode(t.header(new ka));case un.RecordBatch:return il.decode(t.header(new Sh),t.version());case un.DictionaryBatch:return nl.decode(t.header(new Ih),t.version())}throw new Error(`Unrecognized Message type: { name: ${un[e]}, type: ${e} }`)}}(e,s),r}static encode(t){const e=new Qh;let i=-1;return t.isSchema()?i=$o.encode(e,t.header()):t.isRecordBatch()?i=il.encode(e,t.header()):t.isDictionaryBatch()&&(i=nl.encode(e,t.header())),kh.startMessage(e),kh.addVersion(e,sn.V4),kh.addHeader(e,i),kh.addHeaderType(e,t.headerType),kh.addBodyLength(e,new Jh(t.bodyLength,0)),kh.finishMessageBuffer(e,kh.endMessage(e)),e.asUint8Array()}static from(t,e=0){if(t instanceof $o)return new el(0,sn.V4,un.Schema,t);if(t instanceof il)return new el(e,sn.V4,un.RecordBatch,t);if(t instanceof nl)return new el(e,sn.V4,un.DictionaryBatch,t);throw new Error(`Unrecognized Message header: ${t}`)}get type(){return this.headerType}get version(){return this._version}get headerType(){return this._headerType}get bodyLength(){return this._bodyLength}header(){return this._createHeader()}isSchema(){return this.headerType===un.Schema}isRecordBatch(){return this.headerType===un.RecordBatch}isDictionaryBatch(){return this.headerType===un.DictionaryBatch}}class il{constructor(t,e,i){this._nodes=e,this._buffers=i,this._length="number"==typeof t?t:t.low}get nodes(){return this._nodes}get length(){return this._length}get buffers(){return this._buffers}}class nl{constructor(t,e,i=!1){this._data=t,this._isDelta=i,this._id="number"==typeof e?e:e.low}get id(){return this._id}get data(){return this._data}get isDelta(){return this._isDelta}get length(){return this.data.length}get nodes(){return this.data.nodes}get buffers(){return this.data.buffers}}class sl{constructor(t,e){this.offset="number"==typeof t?t:t.low,this.length="number"==typeof e?e:e.low}}class rl{constructor(t,e){this.length="number"==typeof t?t:t.low,this.nullCount="number"==typeof e?e:e.low}}function ol(t,e){const i=[];for(let n,s=-1,r=-1,o=t.childrenLength();++s<o;)(n=t.children(s))&&(i[++r]=Yo.decode(n,e));return i}function al(t){const e=new Map;if(t)for(let i,n,s=-1,r=Math.trunc(t.customMetadataLength());++s<r;)(i=t.customMetadata(s))&&null!=(n=i.key())&&e.set(n,i.value());return e}function hl(t){return new Os(t.isSigned(),t.bitWidth())}function ll(t,e){const i=t.typeType();switch(i){case Pa.NONE:case Pa.Null:return new Bs;case Pa.Binary:return new zs;case Pa.Utf8:return new ks;case Pa.Bool:return new Ds;case Pa.List:return new Vs((e||[])[0]);case Pa.Struct_:return new Gs(e||[])}switch(i){case Pa.Int:{const e=t.type(new Ea);return new Os(e.isSigned(),e.bitWidth())}case Pa.FloatingPoint:{const e=t.type(new Th);return new Ns(e.precision())}case Pa.Decimal:{const e=t.type(new Lh);return new Fs(e.scale(),e.precision(),e.bitWidth())}case Pa.Date:{const e=t.type(new Ah);return new Rs(e.unit())}case Pa.Time:{const e=t.type(new Ph);return new Us(e.unit(),e.bitWidth())}case Pa.Timestamp:{const e=t.type(new Ch);return new Zs(e.unit(),e.timezone())}case Pa.Interval:{const e=t.type(new Bh);return new js(e.unit())}case Pa.Union:{const i=t.type(new Oh);return new qs(i.mode(),i.typeIdsArray()||[],e||[])}case Pa.FixedSizeBinary:{const e=t.type(new Eh);return new Ws(e.byteWidth())}case Pa.FixedSizeList:{const i=t.type(new Nh);return new Hs(i.listSize(),(e||[])[0])}case Pa.Map:{const i=t.type(new zh);return new $s((e||[])[0],i.keysSorted())}}throw new Error(`Unrecognized type: "${Pa[i]}" (${i})`)}Yo.encode=function(t,e){let i=-1,n=-1,s=-1;const r=e.type;let o=e.typeId;Cs.isDictionary(r)?(o=r.dictionary.typeId,s=Gh.visit(r,t),n=Gh.visit(r.dictionary,t)):n=Gh.visit(r,t);const a=(r.children||[]).map((e=>Yo.encode(t,e))),h=za.createChildrenVector(t,a),l=e.metadata&&e.metadata.size>0?za.createCustomMetadataVector(t,[...e.metadata].map((([e,i])=>{const n=t.createString(`${e}`),s=t.createString(`${i}`);return Oa.startKeyValue(t),Oa.addKey(t,n),Oa.addValue(t,s),Oa.endKeyValue(t)}))):-1;return e.name&&(i=t.createString(e.name)),za.startField(t),za.addType(t,n),za.addTypeType(t,o),za.addChildren(t,h),za.addNullable(t,!!e.nullable),-1!==i&&za.addName(t,i),-1!==s&&za.addDictionary(t,s),-1!==l&&za.addCustomMetadata(t,l),za.endField(t)},Yo.decode=function(t,e){let i,n,s,r,o,a;return e&&(a=t.dictionary())?e.has(i=a.id().low)?(r=(r=a.indexType())?hl(r):new Es,o=new Ks(e.get(i),r,i,a.isOrdered()),n=new Yo(t.name(),o,t.nullable(),al(t))):(r=(r=a.indexType())?hl(r):new Es,e.set(i,s=ll(t,ol(t,e))),o=new Ks(s,r,i,a.isOrdered()),n=new Yo(t.name(),o,t.nullable(),al(t))):(s=ll(t,ol(t,e)),n=new Yo(t.name(),s,t.nullable(),al(t))),n||null},Yo.fromJSON=function(t,e){let i,n,s,r,o,a;return e&&(r=t.dictionary)?e.has(i=r.id)?(n=(n=r.indexType)?Xh(n):new Es,a=new Ks(e.get(i),n,i,r.isOrdered),s=new Yo(t.name,a,t.nullable,Yh(t.customMetadata))):(n=(n=r.indexType)?Xh(n):new Es,e.set(i,o=Kh(t,Wh(t,e))),a=new Ks(o,n,i,r.isOrdered),s=new Yo(t.name,a,t.nullable,Yh(t.customMetadata))):(o=Kh(t,Wh(t,e)),s=new Yo(t.name,o,t.nullable,Yh(t.customMetadata))),s||null},$o.encode=function(t,e){const i=e.fields.map((e=>Yo.encode(t,e)));ka.startFieldsVector(t,i.length);const n=ka.createFieldsVector(t,i),s=e.metadata&&e.metadata.size>0?ka.createCustomMetadataVector(t,[...e.metadata].map((([e,i])=>{const n=t.createString(`${e}`),s=t.createString(`${i}`);return Oa.startKeyValue(t),Oa.addKey(t,n),Oa.addValue(t,s),Oa.endKeyValue(t)}))):-1;return ka.startSchema(t),ka.addFields(t,n),ka.addEndianness(t,ul?La.Little:La.Big),-1!==s&&ka.addCustomMetadata(t,s),ka.endSchema(t)},$o.decode=function(t,e=new Map){const i=function(t,e){const i=[];for(let n,s=-1,r=-1,o=t.fieldsLength();++s<o;)(n=t.fields(s))&&(i[++r]=Yo.decode(n,e));return i}(t,e);return new $o(i,al(t),e)},$o.fromJSON=function(t,e=new Map){return new $o(function(t,e){return(t.fields||[]).filter(Boolean).map((t=>Yo.fromJSON(t,e)))}(t,e),Yh(t.customMetadata),e)},il.encode=function(t,e){const i=e.nodes||[],n=e.buffers||[];Sh.startNodesVector(t,i.length);for(const e of i.slice().reverse())rl.encode(t,e);const s=t.endVector();Sh.startBuffersVector(t,n.length);for(const e of n.slice().reverse())sl.encode(t,e);const r=t.endVector();return Sh.startRecordBatch(t),Sh.addLength(t,new Jh(e.length,0)),Sh.addNodes(t,s),Sh.addBuffers(t,r),Sh.endRecordBatch(t)},il.decode=function(t,e=sn.V4){if(null!==t.compression())throw new Error("Record batch compression not implemented");return new il(t.length(),function(t){const e=[];for(let i,n=-1,s=-1,r=t.nodesLength();++n<r;)(i=t.nodes(n))&&(e[++s]=rl.decode(i));return e}(t),function(t,e){const i=[];for(let n,s=-1,r=-1,o=t.buffersLength();++s<o;)(n=t.buffers(s))&&(e<sn.V4&&(n.bb_pos+=8*(s+1)),i[++r]=sl.decode(n));return i}(t,e))},il.fromJSON=qh,nl.encode=function(t,e){const i=il.encode(t,e.data);return Ih.startDictionaryBatch(t),Ih.addId(t,new Jh(e.id,0)),Ih.addIsDelta(t,e.isDelta),Ih.addData(t,i),Ih.endDictionaryBatch(t)},nl.decode=function(t,e=sn.V4){return new nl(il.decode(t.data(),e),t.id(),t.isDelta())},nl.fromJSON=function(t){return new nl(qh(t.data),t.id,t.isDelta)},rl.encode=function(t,e){return Mh.createFieldNode(t,new Jh(e.length,0),new Jh(e.nullCount,0))},rl.decode=function(t){return new rl(t.length(),t.nullCount())},sl.encode=function(t,e){return xh.createBuffer(t,new Jh(e.offset,0),new Jh(e.length,0))},sl.decode=function(t){return new sl(t.offset(),t.length())};const ul=(()=>{const t=new ArrayBuffer(2);return new DataView(t).setInt16(0,256,!0),256===new Int16Array(t)[0]})(),cl=t=>`Expected ${un[t]} Message in stream, but was null or length 0.`,dl=t=>`Header pointer of flatbuffer-encoded ${un[t]} Message is null or length 0.`,fl=(t,e)=>`Expected to read ${t} metadata bytes, but only read ${e}.`,pl=(t,e)=>`Expected to read ${t} bytes for message body, but only read ${e}.`;class ml{constructor(t){this.source=t instanceof Qa?t:new Qa(t)}[Symbol.iterator](){return this}next(){let t;return(t=this.readMetadataLength()).done||-1===t.value&&(t=this.readMetadataLength()).done||(t=this.readMetadata(t.value)).done?$a:t}throw(t){return this.source.throw(t)}return(t){return this.source.return(t)}readMessage(t){let e;if((e=this.next()).done)return null;if(null!=t&&e.value.headerType!==t)throw new Error(cl(t));return e.value}readMessageBody(t){if(t<=0)return new Uint8Array(0);const e=Kn(this.source.read(t));if(e.byteLength<t)throw new Error(pl(t,e.byteLength));return e.byteOffset%8==0&&e.byteOffset+e.byteLength<=e.buffer.byteLength?e:e.slice()}readSchema(t=!1){const e=un.Schema,i=this.readMessage(e),n=null==i?void 0:i.header();if(t&&!n)throw new Error(dl(e));return n}readMetadataLength(){const t=this.source.read(gl),e=t&&new Ca(t),i=(null==e?void 0:e.readInt32(0))||0;return{done:0===i,value:i}}readMetadata(t){const e=this.source.read(t);if(!e)return $a;if(e.byteLength<t)throw new Error(fl(t,e.byteLength));return{done:!1,value:el.decode(e)}}}class _l{constructor(t,e){this.source=t instanceof th?t:Un(t)?new sh(t,e):new th(t)}[Symbol.asyncIterator](){return this}next(){return gn(this,void 0,void 0,(function*(){let t;return(t=yield this.readMetadataLength()).done||-1===t.value&&(t=yield this.readMetadataLength()).done||(t=yield this.readMetadata(t.value)).done?$a:t}))}throw(t){return gn(this,void 0,void 0,(function*(){return yield this.source.throw(t)}))}return(t){return gn(this,void 0,void 0,(function*(){return yield this.source.return(t)}))}readMessage(t){return gn(this,void 0,void 0,(function*(){let e;if((e=yield this.next()).done)return null;if(null!=t&&e.value.headerType!==t)throw new Error(cl(t));return e.value}))}readMessageBody(t){return gn(this,void 0,void 0,(function*(){if(t<=0)return new Uint8Array(0);const e=Kn(yield this.source.read(t));if(e.byteLength<t)throw new Error(pl(t,e.byteLength));return e.byteOffset%8==0&&e.byteOffset+e.byteLength<=e.buffer.byteLength?e:e.slice()}))}readSchema(t=!1){return gn(this,void 0,void 0,(function*(){const e=un.Schema,i=yield this.readMessage(e),n=null==i?void 0:i.header();if(t&&!n)throw new Error(dl(e));return n}))}readMetadataLength(){return gn(this,void 0,void 0,(function*(){const t=yield this.source.read(gl),e=t&&new Ca(t),i=(null==e?void 0:e.readInt32(0))||0;return{done:0===i,value:i}}))}readMetadata(t){return gn(this,void 0,void 0,(function*(){const e=yield this.source.read(t);if(!e)return $a;if(e.byteLength<t)throw new Error(fl(t,e.byteLength));return{done:!1,value:el.decode(e)}}))}}class yl extends ml{constructor(t){super(new Uint8Array(0)),this._schema=!1,this._body=[],this._batchIndex=0,this._dictionaryIndex=0,this._json=t instanceof Ya?t:new Ya(t)}next(){const{_json:t}=this;if(!this._schema)return this._schema=!0,{done:!1,value:el.fromJSON(t.schema,un.Schema)};if(this._dictionaryIndex<t.dictionaries.length){const e=t.dictionaries[this._dictionaryIndex++];return this._body=e.data.columns,{done:!1,value:el.fromJSON(e,un.DictionaryBatch)}}if(this._batchIndex<t.batches.length){const e=t.batches[this._batchIndex++];return this._body=e.columns,{done:!1,value:el.fromJSON(e,un.RecordBatch)}}return this._body=[],$a}readMessageBody(t){return function t(e){return(e||[]).reduce(((e,i)=>[...e,...i.VALIDITY&&[i.VALIDITY]||[],...i.TYPE&&[i.TYPE]||[],...i.OFFSET&&[i.OFFSET]||[],...i.DATA&&[i.DATA]||[],...t(i.children)]),[])}(this._body)}readMessage(t){let e;if((e=this.next()).done)return null;if(null!=t&&e.value.headerType!==t)throw new Error(cl(t));return e.value}readSchema(){const t=un.Schema,e=this.readMessage(t),i=null==e?void 0:e.header();if(!e||!i)throw new Error(dl(t));return i}}const gl=4,vl=new Uint8Array(6);for(let t=0;t<6;t+=1)vl[t]="ARROW1".codePointAt(t);function bl(t,e=0){for(let i=-1,n=vl.length;++i<n;)if(vl[i]!==t[e+i])return!1;return!0}const wl=vl.length,xl=wl+gl,Ml=2*wl+gl;class Sl extends Xa{constructor(t){super(),this._impl=t}get closed(){return this._impl.closed}get schema(){return this._impl.schema}get autoDestroy(){return this._impl.autoDestroy}get dictionaries(){return this._impl.dictionaries}get numDictionaries(){return this._impl.numDictionaries}get numRecordBatches(){return this._impl.numRecordBatches}get footer(){return this._impl.isFile()?this._impl.footer:null}isSync(){return this._impl.isSync()}isAsync(){return this._impl.isAsync()}isFile(){return this._impl.isFile()}isStream(){return this._impl.isStream()}next(){return this._impl.next()}throw(t){return this._impl.throw(t)}return(t){return this._impl.return(t)}cancel(){return this._impl.cancel()}reset(t){return this._impl.reset(t),this._DOMStream=void 0,this._nodeStream=void 0,this}open(t){const e=this._impl.open(t);return zn(e)?e.then((()=>this)):this}readRecordBatch(t){return this._impl.isFile()?this._impl.readRecordBatch(t):null}[Symbol.iterator](){return this._impl[Symbol.iterator]()}[Symbol.asyncIterator](){return this._impl[Symbol.asyncIterator]()}toDOMStream(){return Ga.toDOMStream(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this})}toNodeStream(){return Ga.toNodeStream(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this},{objectMode:!0})}static throughNode(t){throw new Error('"throughNode" not available in this environment')}static throughDOM(t,e){throw new Error('"throughDOM" not available in this environment')}static from(t){return t instanceof Sl?t:Fn(t)?function(t){return new Il(new Nl(t))}(t):Un(t)?function(t){return gn(this,void 0,void 0,(function*(){const{size:e}=yield t.stat(),i=new sh(t,e);return e>=Ml&&bl(yield i.readAt(0,wl+7&-8))?new Al(new El(i)):new Tl(new Bl(i))}))}(t):zn(t)?(()=>gn(this,void 0,void 0,(function*(){return yield Sl.from(yield t)})))():Zn(t)||Vn(t)||Gn(t)||Dn(t)?function(t){return gn(this,void 0,void 0,(function*(){const e=yield t.peek(wl+7&-8);return e&&e.byteLength>=4?bl(e)?new Ll(new Ol(yield t.read())):new Tl(new Bl(t)):new Tl(new Bl(function(){return bn(this,arguments,(function*(){}))}()))}))}(new th(t)):function(t){const e=t.peek(wl+7&-8);return e&&e.byteLength>=4?bl(e)?new Ll(new Ol(t.read())):new Il(new Cl(t)):new Il(new Cl(function*(){}()))}(new Qa(t))}static readAll(t){return t instanceof Sl?t.isSync()?kl(t):Dl(t):Fn(t)||ArrayBuffer.isView(t)||kn(t)||Rn(t)?kl(t):Dl(t)}}class Il extends Sl{constructor(t){super(t),this._impl=t}readAll(){return[...this]}[Symbol.iterator](){return this._impl[Symbol.iterator]()}[Symbol.asyncIterator](){return bn(this,arguments,(function*(){yield vn(yield*wn(xn(this[Symbol.iterator]())))}))}}class Tl extends Sl{constructor(t){super(t),this._impl=t}readAll(){var t,e;return gn(this,void 0,void 0,(function*(){const i=new Array;try{for(var n,s=xn(this);!(n=yield s.next()).done;){const t=n.value;i.push(t)}}catch(e){t={error:e}}finally{try{n&&!n.done&&(e=s.return)&&(yield e.call(s))}finally{if(t)throw t.error}}return i}))}[Symbol.iterator](){throw new Error("AsyncRecordBatchStreamReader is not Iterable")}[Symbol.asyncIterator](){return this._impl[Symbol.asyncIterator]()}}class Ll extends Il{constructor(t){super(t),this._impl=t}}class Al extends Tl{constructor(t){super(t),this._impl=t}}class Pl{constructor(t=new Map){this.closed=!1,this.autoDestroy=!0,this._dictionaryIndex=0,this._recordBatchIndex=0,this.dictionaries=t}get numDictionaries(){return this._dictionaryIndex}get numRecordBatches(){return this._recordBatchIndex}isSync(){return!1}isAsync(){return!1}isFile(){return!1}isStream(){return!1}reset(t){return this._dictionaryIndex=0,this._recordBatchIndex=0,this.schema=t,this.dictionaries=new Map,this}_loadRecordBatch(t,e){const i=this._loadVectors(t,e,this.schema.fields),n=Ho({type:new Gs(this.schema.fields),length:t.length,children:i});return new da(this.schema,n)}_loadDictionaryBatch(t,e){const{id:i,isDelta:n}=t,{dictionaries:s,schema:r}=this,o=s.get(i);if(n||!o){const s=r.dictionaries.get(i),a=this._loadVectors(t.data,e,[s]);return(o&&n?o.concat(new Vo(a)):new Vo(a)).memoize()}return o.memoize()}_loadVectors(t,e,i){return new ch(e,t.nodes,t.buffers,this.dictionaries).visitMany(i)}}class Cl extends Pl{constructor(t,e){super(e),this._reader=Fn(t)?new yl(this._handle=t):new ml(this._handle=t)}isSync(){return!0}isStream(){return!0}[Symbol.iterator](){return this}cancel(){!this.closed&&(this.closed=!0)&&(this.reset()._reader.return(),this._reader=null,this.dictionaries=null)}open(t){return this.closed||(this.autoDestroy=zl(this,t),this.schema||(this.schema=this._reader.readSchema())||this.cancel()),this}throw(t){return!this.closed&&this.autoDestroy&&(this.closed=!0)?this.reset()._reader.throw(t):$a}return(t){return!this.closed&&this.autoDestroy&&(this.closed=!0)?this.reset()._reader.return(t):$a}next(){if(this.closed)return $a;let t;const{_reader:e}=this;for(;t=this._readNextMessageAndValidate();)if(t.isSchema())this.reset(t.header());else{if(t.isRecordBatch()){this._recordBatchIndex++;const i=t.header(),n=e.readMessageBody(t.bodyLength);return{done:!1,value:this._loadRecordBatch(i,n)}}if(t.isDictionaryBatch()){this._dictionaryIndex++;const i=t.header(),n=e.readMessageBody(t.bodyLength),s=this._loadDictionaryBatch(i,n);this.dictionaries.set(i.id,s)}}return this.schema&&0===this._recordBatchIndex?(this._recordBatchIndex++,{done:!1,value:new ma(this.schema)}):this.return()}_readNextMessageAndValidate(t){return this._reader.readMessage(t)}}class Bl extends Pl{constructor(t,e){super(e),this._reader=new _l(this._handle=t)}isAsync(){return!0}isStream(){return!0}[Symbol.asyncIterator](){return this}cancel(){return gn(this,void 0,void 0,(function*(){!this.closed&&(this.closed=!0)&&(yield this.reset()._reader.return(),this._reader=null,this.dictionaries=null)}))}open(t){return gn(this,void 0,void 0,(function*(){return this.closed||(this.autoDestroy=zl(this,t),this.schema||(this.schema=yield this._reader.readSchema())||(yield this.cancel())),this}))}throw(t){return gn(this,void 0,void 0,(function*(){return!this.closed&&this.autoDestroy&&(this.closed=!0)?yield this.reset()._reader.throw(t):$a}))}return(t){return gn(this,void 0,void 0,(function*(){return!this.closed&&this.autoDestroy&&(this.closed=!0)?yield this.reset()._reader.return(t):$a}))}next(){return gn(this,void 0,void 0,(function*(){if(this.closed)return $a;let t;const{_reader:e}=this;for(;t=yield this._readNextMessageAndValidate();)if(t.isSchema())yield this.reset(t.header());else{if(t.isRecordBatch()){this._recordBatchIndex++;const i=t.header(),n=yield e.readMessageBody(t.bodyLength);return{done:!1,value:this._loadRecordBatch(i,n)}}if(t.isDictionaryBatch()){this._dictionaryIndex++;const i=t.header(),n=yield e.readMessageBody(t.bodyLength),s=this._loadDictionaryBatch(i,n);this.dictionaries.set(i.id,s)}}return this.schema&&0===this._recordBatchIndex?(this._recordBatchIndex++,{done:!1,value:new ma(this.schema)}):yield this.return()}))}_readNextMessageAndValidate(t){return gn(this,void 0,void 0,(function*(){return yield this._reader.readMessage(t)}))}}class Ol extends Cl{constructor(t,e){super(t instanceof nh?t:new nh(t),e)}get footer(){return this._footer}get numDictionaries(){return this._footer?this._footer.numDictionaries:0}get numRecordBatches(){return this._footer?this._footer.numRecordBatches:0}isSync(){return!0}isFile(){return!0}open(t){if(!this.closed&&!this._footer){this.schema=(this._footer=this._readFooter()).schema;for(const t of this._footer.dictionaryBatches())t&&this._readDictionaryBatch(this._dictionaryIndex++)}return super.open(t)}readRecordBatch(t){var e;if(this.closed)return null;this._footer||this.open();const i=null===(e=this._footer)||void 0===e?void 0:e.getRecordBatch(t);if(i&&this._handle.seek(i.offset)){const t=this._reader.readMessage(un.RecordBatch);if(null==t?void 0:t.isRecordBatch()){const e=t.header(),i=this._reader.readMessageBody(t.bodyLength);return this._loadRecordBatch(e,i)}}return null}_readDictionaryBatch(t){var e;const i=null===(e=this._footer)||void 0===e?void 0:e.getDictionaryBatch(t);if(i&&this._handle.seek(i.offset)){const t=this._reader.readMessage(un.DictionaryBatch);if(null==t?void 0:t.isDictionaryBatch()){const e=t.header(),i=this._reader.readMessageBody(t.bodyLength),n=this._loadDictionaryBatch(e,i);this.dictionaries.set(e.id,n)}}}_readFooter(){const{_handle:t}=this,e=t.size-xl,i=t.readInt32(e),n=t.readAt(e-i,i);return Za.decode(n)}_readNextMessageAndValidate(t){var e;if(this._footer||this.open(),this._footer&&this._recordBatchIndex<this.numRecordBatches){const i=null===(e=this._footer)||void 0===e?void 0:e.getRecordBatch(this._recordBatchIndex);if(i&&this._handle.seek(i.offset))return this._reader.readMessage(t)}return null}}class El extends Bl{constructor(t,...e){const i="number"!=typeof e[0]?e.shift():void 0,n=e[0]instanceof Map?e.shift():void 0;super(t instanceof sh?t:new sh(t,i),n)}get footer(){return this._footer}get numDictionaries(){return this._footer?this._footer.numDictionaries:0}get numRecordBatches(){return this._footer?this._footer.numRecordBatches:0}isFile(){return!0}isAsync(){return!0}open(t){const e=Object.create(null,{open:{get:()=>super.open}});return gn(this,void 0,void 0,(function*(){if(!this.closed&&!this._footer){this.schema=(this._footer=yield this._readFooter()).schema;for(const t of this._footer.dictionaryBatches())t&&(yield this._readDictionaryBatch(this._dictionaryIndex++))}return yield e.open.call(this,t)}))}readRecordBatch(t){var e;return gn(this,void 0,void 0,(function*(){if(this.closed)return null;this._footer||(yield this.open());const i=null===(e=this._footer)||void 0===e?void 0:e.getRecordBatch(t);if(i&&(yield this._handle.seek(i.offset))){const t=yield this._reader.readMessage(un.RecordBatch);if(null==t?void 0:t.isRecordBatch()){const e=t.header(),i=yield this._reader.readMessageBody(t.bodyLength);return this._loadRecordBatch(e,i)}}return null}))}_readDictionaryBatch(t){var e;return gn(this,void 0,void 0,(function*(){const i=null===(e=this._footer)||void 0===e?void 0:e.getDictionaryBatch(t);if(i&&(yield this._handle.seek(i.offset))){const t=yield this._reader.readMessage(un.DictionaryBatch);if(null==t?void 0:t.isDictionaryBatch()){const e=t.header(),i=yield this._reader.readMessageBody(t.bodyLength),n=this._loadDictionaryBatch(e,i);this.dictionaries.set(e.id,n)}}}))}_readFooter(){return gn(this,void 0,void 0,(function*(){const{_handle:t}=this;t._pending&&(yield t._pending);const e=t.size-xl,i=yield t.readInt32(e),n=yield t.readAt(e-i,i);return Za.decode(n)}))}_readNextMessageAndValidate(t){return gn(this,void 0,void 0,(function*(){if(this._footer||(yield this.open()),this._footer&&this._recordBatchIndex<this.numRecordBatches){const e=this._footer.getRecordBatch(this._recordBatchIndex);if(e&&(yield this._handle.seek(e.offset)))return yield this._reader.readMessage(t)}return null}))}}class Nl extends Cl{constructor(t,e){super(t,e)}_loadVectors(t,e,i){return new dh(e,t.nodes,t.buffers,this.dictionaries).visitMany(i)}}function zl(t,e){return e&&"boolean"==typeof e.autoDestroy?e.autoDestroy:t.autoDestroy}function*kl(t){const e=Sl.from(t);try{if(!e.open({autoDestroy:!1}).closed)do{yield e}while(!e.reset().open().closed)}finally{e.cancel()}}function Dl(t){return bn(this,arguments,(function*(){const e=yield vn(Sl.from(t));try{if(!(yield vn(e.open({autoDestroy:!1}))).closed)do{yield yield vn(e)}while(!(yield vn(e.reset().open())).closed)}finally{yield vn(e.cancel())}}))}function Fl(t){const e=Sl.from(t);return zn(e)?e.then((t=>Fl(t))):e.isAsync()?e.readAll().then((t=>new ga(t))):new ga(e.readAll())}class Rl extends Ji{constructor(t,e,i={}){super(t,0,i),this.app=e,this.info=void 0,this.infoLoadingStatus="notLoaded",this.cache={},this.readParquetFun=i.readParquetFun}loadInfo(t){return this.info||"notLoaded"!==this.infoLoadingStatus?!t||"loaded"!==this.infoLoadingStatus&&"failed"!==this.infoLoadingStatus||t():(async()=>{try{const e=await nn(this.url+"info.json");this.info=e,this.resolution=e.resolutionGeo,this.infoLoadingStatus="loaded",t&&t()}catch(t){this.infoLoadingStatus="failed"}})(),this}getTilingEnvelope(t){if(!this.info)return void this.loadInfo((()=>{}));const e=this.info.originPoint,i=this.info.resolutionGeo,n=this.info.tileSizeCell;return{xMin:Math.floor((t.xMin-e.x)/(i*n)),xMax:Math.floor((t.xMax-e.x)/(i*n)),yMin:Math.floor((t.yMin-e.y)/(i*n)),yMax:Math.floor((t.yMax-e.y)/(i*n))}}getData(t,e){if(!this.info)return this;const i=this.getTilingEnvelope(t);if(!i)return this;const n=this.info.tilingBounds,s=this.info.format;for(let t=Math.max(i.xMin,n.xMin);t<=Math.min(i.xMax,n.xMax);t++)for(let r=Math.max(i.yMin,n.yMin);r<=Math.min(i.yMax,n.yMax);r++)this.cache[t]||(this.cache[t]={}),this.cache[t][r]||(this.cache[t][r]="loading",(async()=>{let i;try{if(s&&"CSV"!==s){if("PARQUET"!==s)throw new Error("Tiled format not supported: "+s);{if(!this.readParquetFun)throw new Error("readParquet function needed for parquet dataset");const e=await fetch(this.url+t+"/"+r+".parquet"),n=new Uint8Array(await e.arrayBuffer()),s=Fl(this.readParquetFun(n));i=[];for(const t of s){const e=t.toJSON();if(this.preprocess){if(0==this.preprocess(e))continue;i.push(e)}else i.push(e)}}}else{const e=await Ki(this.url+t+"/"+r+".csv");if(this.preprocess){i=[];for(const t of e)0!=this.preprocess(t)&&i.push(t)}else i=e}}catch(e){return void(this.cache[t][r]="failed")}if(!this.info)return void console.error("Tile info inknown");const n=new tn(i,t,r,this.info);if(this.cache[t][r]=n,!e)return;let o=!1;const a=this.app.getZoomFactor();for(const t of this.app.layers)if(t.visible&&t.getDatasetComponent(a)==this){o=!0;break}if(!o)return;const h=this.app.updateExtentGeo(),l=n.extGeo;h.xMax<=l.xMin||h.xMin>=l.xMax||h.yMax<=l.yMin||h.yMin>=l.yMax||e()})());return this}updateViewCache(t){if(this.cellsViewCache=[],!this.info)return;const e=this.getTilingEnvelope(t);if(!e)return;const i=this.info.tilingBounds;for(let n=Math.max(e.xMin,i.xMin);n<=Math.min(e.xMax,i.xMax);n++)if(this.cache[n])for(let s=Math.max(e.yMin,i.yMin);s<=Math.min(e.yMax,i.yMax);s++){const e=this.cache[n][s];if(e&&"string"!=typeof e)for(const i of e.cells)+i.x+this.resolution<t.xMin||+i.x-this.resolution>t.xMax||+i.y+this.resolution<t.yMin||+i.y-this.resolution>t.yMax||this.cellsViewCache.push(i)}}}class Ul{constructor(t){if(t=t||{},this.visible=0!=t.visible,this.minZoom=t.minZoom||0,this.maxZoom=t.maxZoom||1/0,this.minZoom>=this.maxZoom)throw new Error("Unexpected zoom limits for layer. Zoom min should be smaller than zoom max.");if(this.cache={},this.url=t.url,this.urlFun=t.urlFun||((t,e,i)=>this.url+i+"/"+t+"/"+e+".png"),this.resolutions=t.resolutions,!this.resolutions||0==this.resolutions.length)throw new Error("No resolutions provided for background layer");this.nbPix=t.nbPix||256,this.origin=t.origin||[0,0],this.z0=t.z0||0,this.filterColor=t.filterColor}get(t,e,i){let n=this.cache[t];if(n&&(n=n[e],n))return n[i]}put(t,e,i,n){this.cache[e]||(this.cache[e]={}),this.cache[e][i]||(this.cache[e][i]={}),this.cache[e][i][n]=t}draw(t){if(!this.resolutions||0==this.resolutions.length)return void console.error("No resolutions provided for background layer");const e=t.getZf(),i=this.origin[0],n=this.origin[1];let s=0;for(s=0;s<this.resolutions.length&&!(this.resolutions[s]<e);s++);s-=1,s=Math.max(0,s),s=Math.min(s,this.resolutions.length-1);const r=this.resolutions[s];s+=this.z0;const o=this.nbPix*r,a=o/e,h=t=>Math.ceil((t-i)/o),l=t=>Math.ceil(-(t-n)/o),u=h(t.extGeo.xMin)-1,c=h(t.extGeo.xMax),d=l(t.extGeo.yMin),f=l(t.extGeo.yMax)-1;for(let e=u;e<c;e++)for(let r=f;r<d;r++){let h=this.get(s,e,r);if(!h){const i=new Image;this.put(i,s,e,r),i.onload=()=>{t.redraw()},i.onerror=()=>{this.put("failed",s,e,r)},i.src=this.urlFun(e,r,s);continue}if("failed"===h)continue;if(!(h instanceof HTMLImageElement)){console.log(h);continue}if(0==h.width||0==h.height)continue;const l=i+e*o,u=n-r*o;try{t.ctx.drawImage(h,t.geoToPixX(l),t.geoToPixY(u),a,a)}catch(t){console.error(t)}}if(this.filterColor){const i=this.filterColor(e);i&&"none"!=i&&(t.ctx.fillStyle=i,t.ctx.fillRect(0,0,t.w,t.h))}}}class Zl{constructor(t){if(t=t||{},this.visible=0!=t.visible,this.minZoom=t.minZoom||0,this.maxZoom=t.maxZoom||1/0,this.minZoom>=this.maxZoom)throw new Error("Unexpected zoom limits for layer. Zoom min should be smaller than zoom max.");this.url=t.url,this.filterColor=t.filterColor,this.img=void 0,this.xMin=void 0,this.xMax=void 0,this.yMin=void 0,this.yMax=void 0}hasMoved(t){return t.xMin!=this.xMin||t.xMax!=this.xMax||t.yMin!=this.yMin||t.yMax!=this.yMax}draw(t){if(t.updateExtentGeo(0),!this.hasMoved(t.extGeo)&&this.img)t.ctx.drawImage(this.img,0,0,t.w,t.h);else{this.xMin=t.extGeo.xMin,this.xMax=t.extGeo.xMax,this.yMin=t.extGeo.yMin,this.yMax=t.extGeo.yMax;const e=[];e.push(this.url),e.push("&width="),e.push(t.w),e.push("&height="),e.push(t.h),e.push("&bbox="),e.push(t.extGeo.xMin),e.push(","),e.push(t.extGeo.yMin),e.push(","),e.push(t.extGeo.xMax),e.push(","),e.push(t.extGeo.yMax);const i=e.join("");this.img||(this.img=new Image,this.img.onload=()=>{t.redraw()},this.img.onerror=()=>{console.warn("Could not retrieve WMS background image from",i)}),this.img.src=i}const e=t.getZf();if(this.filterColor){const i=this.filterColor(e);i&&"none"!=i&&(t.ctx.fillStyle=i,t.ctx.fillRect(0,0,t.w,t.h))}}}class jl{constructor(t){t=t||{},this.url=t.url,this.style=t.style||(()=>"bold 1em Arial"),this.color=t.color||(t.dark?()=>"#ddd":()=>"#222"),this.haloColor=t.haloColor||(t.dark?()=>"#000000BB":()=>"#FFFFFFBB"),this.haloWidth=t.haloWidth||(()=>4),this.textAlign=t.textAlign||"start",this.offsetPix=t.offsetPix||[5,5],this.preprocess=t.preprocess,this.labels=void 0,this.loadingStatus="notLoaded"}draw(t){if(!this.labels)return void this.load(t.redraw);const e=t.getZf();t.ctx.textAlign=this.textAlign||"start",t.ctx.lineJoin="bevel",t.ctx.lineCap="butt",t.initCanvasTransform();for(const i of this.labels){const n=this.style(i,e);if(!n)continue;if(t.ctx.font=n,!t.toDraw(i))continue;const s=t.geoToPixX(i.x)+this.offsetPix[0],r=t.geoToPixY(i.y)-this.offsetPix[1];if(this.haloColor&&this.haloWidth){const n=this.haloColor(i,e),o=this.haloWidth(i,e);n&&o&&o>0&&(t.ctx.strokeStyle=n,t.ctx.lineWidth=o,t.ctx.strokeText(i.name,s,r))}if(this.color){const n=this.color(i,e);n&&(t.ctx.fillStyle=n,t.ctx.fillText(i.name,s,r))}}}async load(t){if(!this.url)return console.log("Failed loading labels: No URL specified. "+this.url),this.loadingStatus="failed",void(this.labels=[]);if("notLoaded"==this.loadingStatus){this.loadingStatus="loading";try{const e=await Ki(this.url);if(this.preprocess){this.labels=[];for(const t of e)0!=this.preprocess(t)&&this.labels.push(t)}else this.labels=e;this.loadingStatus="loaded",t&&t()}catch(t){console.log("Failed loading labels from "+this.url),this.labels=[],this.loadingStatus="failed"}}}}class Vl{constructor(t){t=t||{},this.url=t.url,this.preprocess=t.preprocess,this.color=t.color||((t,e)=>"gray"),this.width=t.width||((t,e)=>2),this.lineDash=t.lineDash||((t,e)=>{}),this.fs=void 0,this.loadingStatus="notLoaded"}draw(t){if(!this.fs)return void this.load(t.redraw);const e=t.getZf();t.setCanvasTransform();for(const i of this.fs){const n=i.geometry.coordinates;if(n.length<2)continue;const s=this.color(i,e);if(!s||"none"==s)continue;t.ctx.strokeStyle=s;const r=this.width(i,e);if(!r||r<0)continue;t.ctx.lineWidth=r*e;const o=this.lineDash(i,e);o&&t.ctx.setLineDash(o),t.ctx.beginPath(),t.ctx.moveTo(n[0][0],n[0][1]);for(let e=1;e<n.length;e++)t.ctx.lineTo(n[e][0],n[e][1]);t.ctx.stroke()}t.ctx.setLineDash([])}async load(t){if(!this.url)return console.log("Failed loading boundaries: No URL specified. "+this.url),this.loadingStatus="failed",void(this.labels=[]);if("notLoaded"==this.loadingStatus){this.loadingStatus="loading";try{const e=(await nn(this.url)).features;if(this.preprocess){this.fs=[];for(const t of e)0!=this.preprocess(t)&&this.fs.push(t)}else this.fs=e;this.loadingStatus="loaded",t&&t()}catch(t){console.log("Failed loading boundaries from "+this.url),this.fs=[],this.loadingStatus="failed"}}}}class Gl{constructor(t,e){if(e=e||{},this.layers=[],!(t=t||document.getElementById("gridviz")))return void console.error("Cannot find gridviz container element.");this.w=e.w||t.offsetWidth,this.h=e.h||t.offsetHeight;let i=e.canvas||null;i||(i=document.createElement("canvas"),i.setAttribute("width",""+this.w),i.setAttribute("height",""+this.h),t.appendChild(i)),this.cg=new zi(i,void 0,1,e),this.cg.redraw=(e=!0)=>{this.legend&&e&&this.legend.selectAll("*").remove(),this.cg.initCanvasTransform(),this.cg.clear(this.cg.backgroundColor);const n=this.getZoomFactor();this.updateExtentGeo();for(const t of this.bgLayers)t.visible&&(n>t.maxZoom||n<t.minZoom||t.draw(this.cg));for(const t of this.layers){if(!t.visible)continue;if(n>t.maxZoom)continue;if(n<t.minZoom)continue;const i=t.getDatasetComponent(n);if(i){if(e&&i.getData(this.cg.extGeo,(()=>{this.cg.redraw()})),e&&i.updateViewCache(this.cg.extGeo),e)for(const e of t.styles)n>e.maxZoom||n<e.minZoom||e.draw(i.getViewCache(),i.getResolution(),this.cg);if(this.legend&&e)for(const e of t.styles)if(!(n>e.maxZoom||n<e.minZoom)){for(const t of e.legends)this.legend.node().append(t.div.node());if(e.styles)for(const t of e.styles)if(!(n>t.maxZoom||n<t.minZoom))for(const e of t.legends)this.legend.node().append(e.div.node())}}}return this.showBoundaries&&this.boundaryLayer&&this.boundaryLayer.draw(this.cg),this.showLabels&&this.labelLayer&&this.labelLayer.draw(this.cg),this.canvasSave=null,this.defineResizeObserver(t,i),this},this.bgLayers=[],this.showBgLayers=!0,this.labelLayer=void 0,this.showLabels=!0,this.boundaryLayer=void 0,this.showBoundaries=!0,this.legendDivId=e.legendDivId||"gvizLegend",this.legend=pt("#"+this.legendDivId),this.legend.empty()&&(this.legend=pt("body").append("div").attr("id",this.legendDivId).style("position","absolute").style("width","auto").style("height","auto").style("background","#FFFFFFCC").style("border","0px").style("border-radius","5px").style("box-shadow","3px 3px 3px grey, -3px -3px 3px #ddd").style("font-family","Helvetica, Arial, sans-serif").style("top","20px").style("right","20px")),this.tooltip=new Fi(e.tooltip);const n=t=>{const i={x:this.cg.pixToGeoX(t.offsetX+this.tooltip.xMouseOffset),y:this.cg.pixToGeoY(t.offsetY+this.tooltip.yMouseOffset)},n=this.getCellFocusInfo(i);if(e.transparentBackground)return n?(this.tooltip.setPosition(t),this.tooltip.show(),this.tooltip.html(n.html)):this.tooltip.hide(),this.canvasSave=document.createElement("canvas"),this.canvasSave.setAttribute("width",""+this.w),this.canvasSave.setAttribute("height",""+this.h),this.canvasSave.getContext("2d").drawImage(this.cg.canvas,0,0),void this.cg.initCanvasTransform();if(n){this.tooltip.setPosition(t),this.tooltip.show(),this.tooltip.html(n.html),this.canvasSave?this.cg.ctx.drawImage(this.canvasSave,0,0):(this.canvasSave=document.createElement("canvas"),this.canvasSave.setAttribute("width",""+this.w),this.canvasSave.setAttribute("height",""+this.h),this.canvasSave.getContext("2d").drawImage(this.cg.canvas,0,0));const e=this.selectionRectangleWidthPix?this.selectionRectangleWidthPix(n.resolution,this.getZoomFactor()):4;this.cg.initCanvasTransform(),this.cg.ctx.strokeStyle=this.selectionRectangleColor,this.cg.ctx.lineWidth=e,this.cg.ctx.beginPath(),this.cg.ctx.rect(this.cg.geoToPixX(n.cell.x)-e/2,this.cg.geoToPixY(n.cell.y)+e/2,n.resolution/this.getZoomFactor()+e,-n.resolution/this.getZoomFactor()-e),this.cg.ctx.stroke()}else this.tooltip.hide(),this.canvasSave&&this.cg.ctx.drawImage(this.canvasSave,0,0)};t.addEventListener("mouseover",(t=>{n(t)})),t.addEventListener("mousemove",(t=>{n(t)})),t.addEventListener("mouseout",(()=>{this.tooltip.hide()})),this.cg.onZoomStartFun=()=>{this.tooltip.hide()},this.canvasSave=null,this.selectionRectangleColor=e.selectionRectangleColor||"red",this.selectionRectangleWidthPix=e.selectionRectangleWidthPix||(()=>4)}updateExtentGeo(t=20){return this.cg.updateExtentGeo(t)}getCellFocusInfo(t){const e=this.getZoomFactor();for(let i=this.layers.length-1;i>=0;i--){const n=this.layers[i];if(!n.visible)continue;if(!n.cellInfoHTML)continue;if("none"===n.cellInfoHTML)continue;const s=n.getDatasetComponent(e);if(!s)continue;const r=s.getCellFromPosition(t,s.getViewCache());if(!r)return;const o=n.cellInfoHTML(r,s.getResolution());if(!o)return;return{cell:r,html:o,resolution:s.getResolution()}}}getGeoCenter(){return this.cg.getCenter()}setGeoCenter(t){return this.cg.setCenter(t),this}getZoomFactor(){return this.cg.getZf()}setZoomFactor(t){return this.cg.setZf(t),this}getZoomFactorExtent(){return this.cg.getZfExtent()}setZoomFactorExtent(t){return this.cg.setZfExtent(t),this}getBackgroundColor(){return this.cg.backgroundColor}setBackgroundColor(t){return this.cg.backgroundColor=t,this}getBoundaryLayer(){return this.boundaryLayer}setBoundaryLayer(t){return this.boundaryLayer=new Vl(t),this}getLabelLayer(){return this.labelLayer}setLabelLayer(t){return this.labelLayer=new jl(t),this}redraw(){return this.cg.redraw(),this}addLayerFromDataset(t,e,i){const n=new ki(t,e,i);return this.layers.push(n),this}makeCSVGridDataset(t,e,i){return new Di([new Qi(t,e,i).getData(void 0,(()=>{this.cg.redraw()}))],[],i)}makeTiledGridDataset(t,e){return new Di([new Rl(t,this,e).loadInfo((()=>{this.cg.redraw()}))],[],e)}makeMultiScaleCSVGridDataset(t,e,i){return Di.make(t,(t=>new Qi(e(t),t,i).getData(void 0,(()=>{this.cg.redraw()}))),i)}makeMultiScaleTiledGridDataset(t,e,i){return Di.make(t,(t=>new Rl(e(t),this,i).loadInfo((()=>{this.cg.redraw()}))),i)}addCSVGridLayer(t,e,i,n){const s=this.makeCSVGridDataset(t,e,n);return this.addLayerFromDataset(s,i,n)}addTiledGridLayer(t,e,i){const n=this.makeTiledGridDataset(t,i);return this.addLayerFromDataset(n,e,i)}addMultiScaleCSVGridLayer(t,e,i,n){const s=this.makeMultiScaleCSVGridDataset(t,e,n);return this.addLayerFromDataset(s,i,n)}addMultiScaleTiledGridLayer(t,e,i,n){const s=this.makeMultiScaleTiledGridDataset(t,e,n);return this.addLayerFromDataset(s,i,n)}addBackgroundLayer(t){return this.bgLayers.push(new Ul(t)),this.redraw(),this}addBackgroundLayerWMS(t){return this.bgLayers.push(new Zl(t)),this.redraw(),this}addZoomSlider(t,e){return this.cg.addZoomSlider(t,e),this}setViewFromURL(){return this.cg.setViewFromURL(),this}defineResizeObserver(t,e){new ResizeObserver((i=>{t.clientWidth>0&&t.clientHeight>0&&window.requestAnimationFrame((()=>{Array.isArray(i)&&i.length&&(this.h===t.clientHeight&&this.w===t.clientWidth||(this.h=t.clientHeight,this.w=t.clientWidth,this.cg.h=t.clientHeight,this.cg.w=t.clientWidth,e.setAttribute("width",""+this.w),e.setAttribute("height",""+this.h),this.redraw()))}))})).observe(t)}}function ql(t,e){if((i=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var i,n=t.slice(0,i);return[n.length>1?n[0]+n.slice(2):n,+t.slice(i+1)]}var Wl,Hl=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function $l(t){if(!(e=Hl.exec(t)))throw new Error("invalid format: "+t);var e;return new Yl({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function Yl(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function Xl(t,e){var i=ql(t,e);if(!i)return t+"";var n=i[0],s=i[1];return s<0?"0."+new Array(-s).join("0")+n:n.length>s+1?n.slice(0,s+1)+"."+n.slice(s+1):n+new Array(s-n.length+2).join("0")}$l.prototype=Yl.prototype,Yl.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const Kl={"%":(t,e)=>(100*t).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>Xl(100*t,e),r:Xl,s:function(t,e){var i=ql(t,e);if(!i)return t+"";var n=i[0],s=i[1],r=s-(Wl=3*Math.max(-8,Math.min(8,Math.floor(s/3))))+1,o=n.length;return r===o?n:r>o?n+new Array(r-o+1).join("0"):r>0?n.slice(0,r)+"."+n.slice(r):"0."+new Array(1-r).join("0")+ql(t,Math.max(0,e+r-1))[0]},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function Jl(t){return t}var Ql,tu=Array.prototype.map,eu=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function iu(t){return Ql=function(t){var e,i,n=void 0===t.grouping||void 0===t.thousands?Jl:(e=tu.call(t.grouping,Number),i=t.thousands+"",function(t,n){for(var s=t.length,r=[],o=0,a=e[0],h=0;s>0&&a>0&&(h+a+1>n&&(a=Math.max(1,n-h)),r.push(t.substring(s-=a,s+a)),!((h+=a+1)>n));)a=e[o=(o+1)%e.length];return r.reverse().join(i)}),s=void 0===t.currency?"":t.currency[0]+"",r=void 0===t.currency?"":t.currency[1]+"",o=void 0===t.decimal?".":t.decimal+"",a=void 0===t.numerals?Jl:function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(tu.call(t.numerals,String)),h=void 0===t.percent?"%":t.percent+"",l=void 0===t.minus?"−":t.minus+"",u=void 0===t.nan?"NaN":t.nan+"";function c(t){var e=(t=$l(t)).fill,i=t.align,c=t.sign,d=t.symbol,f=t.zero,p=t.width,m=t.comma,_=t.precision,y=t.trim,g=t.type;"n"===g?(m=!0,g="g"):Kl[g]||(void 0===_&&(_=12),y=!0,g="g"),(f||"0"===e&&"="===i)&&(f=!0,e="0",i="=");var v="$"===d?s:"#"===d&&/[boxX]/.test(g)?"0"+g.toLowerCase():"",b="$"===d?r:/[%p]/.test(g)?h:"",w=Kl[g],x=/[defgprs%]/.test(g);function M(t){var s,r,h,d=v,M=b;if("c"===g)M=w(t)+M,t="";else{var S=(t=+t)<0||1/t<0;if(t=isNaN(t)?u:w(Math.abs(t),_),y&&(t=function(t){t:for(var e,i=t.length,n=1,s=-1;n<i;++n)switch(t[n]){case".":s=e=n;break;case"0":0===s&&(s=n),e=n;break;default:if(!+t[n])break t;s>0&&(s=0)}return s>0?t.slice(0,s)+t.slice(e+1):t}(t)),S&&0==+t&&"+"!==c&&(S=!1),d=(S?"("===c?c:l:"-"===c||"("===c?"":c)+d,M=("s"===g?eu[8+Wl/3]:"")+M+(S&&"("===c?")":""),x)for(s=-1,r=t.length;++s<r;)if(48>(h=t.charCodeAt(s))||h>57){M=(46===h?o+t.slice(s+1):t.slice(s))+M,t=t.slice(0,s);break}}m&&!f&&(t=n(t,1/0));var I=d.length+t.length+M.length,T=I<p?new Array(p-I+1).join(e):"";switch(m&&f&&(t=n(T+t,T.length?p-M.length:1/0),T=""),i){case"<":t=d+t+M+T;break;case"=":t=d+T+t+M;break;case"^":t=T.slice(0,I=T.length>>1)+d+t+M+T.slice(I);break;default:t=T+d+t+M}return a(t)}return _=void 0===_?6:/[gprs]/.test(g)?Math.max(1,Math.min(21,_)):Math.max(0,Math.min(20,_)),M.toString=function(){return t+""},M}return{format:c,formatPrefix:function(t,e){var i,n=c(((t=$l(t)).type="f",t)),s=3*Math.max(-8,Math.min(8,Math.floor((i=e,((i=ql(Math.abs(i)))?i[1]:NaN)/3)))),r=Math.pow(10,-s),o=eu[8+s/3];return function(t){return n(r*t)+o}}}}(t),Ql.format,Ql.formatPrefix,Ql}iu({thousands:",",grouping:[3],currency:["$",""]}),zi.getParameterByName,iu({decimal:".",thousands:" ",grouping:[3],currency:["","€"]});var nu=i(616),su=1,ru=2,ou=3,au=5,hu=6378137,lu=6356752.314,uu=.0066943799901413165,cu=484813681109536e-20,du=Math.PI/2,fu=1e-10,pu=.017453292519943295,mu=57.29577951308232,_u=Math.PI/4,yu=2*Math.PI,gu=3.14159265359,vu={greenwich:0,lisbon:-9.131906111111,paris:2.337229166667,bogota:-74.080916666667,madrid:-3.687938888889,rome:12.452333333333,bern:7.439583333333,jakarta:106.807719444444,ferro:-17.666666666667,brussels:4.367975,stockholm:18.058277777778,athens:23.7163375,oslo:10.722916666667};const bu={ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937}};var wu=/[\s_\-\/\(\)]/g;function xu(t,e){if(t[e])return t[e];for(var i,n=Object.keys(t),s=e.toLowerCase().replace(wu,""),r=-1;++r<n.length;)if((i=n[r]).toLowerCase().replace(wu,"")===s)return t[i]}function Mu(t){var e,i,n,s={},r=t.split("+").map((function(t){return t.trim()})).filter((function(t){return t})).reduce((function(t,e){var i=e.split("=");return i.push(!0),t[i[0].toLowerCase()]=i[1],t}),{}),o={proj:"projName",datum:"datumCode",rf:function(t){s.rf=parseFloat(t)},lat_0:function(t){s.lat0=t*pu},lat_1:function(t){s.lat1=t*pu},lat_2:function(t){s.lat2=t*pu},lat_ts:function(t){s.lat_ts=t*pu},lon_0:function(t){s.long0=t*pu},lon_1:function(t){s.long1=t*pu},lon_2:function(t){s.long2=t*pu},alpha:function(t){s.alpha=parseFloat(t)*pu},gamma:function(t){s.rectified_grid_angle=parseFloat(t)},lonc:function(t){s.longc=t*pu},x_0:function(t){s.x0=parseFloat(t)},y_0:function(t){s.y0=parseFloat(t)},k_0:function(t){s.k0=parseFloat(t)},k:function(t){s.k0=parseFloat(t)},a:function(t){s.a=parseFloat(t)},b:function(t){s.b=parseFloat(t)},r_a:function(){s.R_A=!0},zone:function(t){s.zone=parseInt(t,10)},south:function(){s.utmSouth=!0},towgs84:function(t){s.datum_params=t.split(",").map((function(t){return parseFloat(t)}))},to_meter:function(t){s.to_meter=parseFloat(t)},units:function(t){s.units=t;var e=xu(bu,t);e&&(s.to_meter=e.to_meter)},from_greenwich:function(t){s.from_greenwich=t*pu},pm:function(t){var e=xu(vu,t);s.from_greenwich=(e||parseFloat(t))*pu},nadgrids:function(t){"@null"===t?s.datumCode="none":s.nadgrids=t},axis:function(t){var e="ewnsud";3===t.length&&-1!==e.indexOf(t.substr(0,1))&&-1!==e.indexOf(t.substr(1,1))&&-1!==e.indexOf(t.substr(2,1))&&(s.axis=t)},approx:function(){s.approx=!0}};for(e in r)i=r[e],e in o?"function"==typeof(n=o[e])?n(i):s[n]=i:s[e]=i;return"string"==typeof s.datumCode&&"WGS84"!==s.datumCode&&(s.datumCode=s.datumCode.toLowerCase()),s}const Su=function(t){return new Bu(t).output()};var Iu=1,Tu=/\s/,Lu=/[A-Za-z]/,Au=/[A-Za-z84_]/,Pu=/[,\]]/,Cu=/[\d\.E\-\+]/;function Bu(t){if("string"!=typeof t)throw new Error("not a string");this.text=t.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=Iu}function Ou(t,e,i){Array.isArray(e)&&(i.unshift(e),e=null);var n=e?{}:t,s=i.reduce((function(t,e){return Eu(e,t),t}),n);e&&(t[e]=s)}function Eu(t,e){if(Array.isArray(t)){var i=t.shift();if("PARAMETER"===i&&(i=t.shift()),1===t.length)return Array.isArray(t[0])?(e[i]={},void Eu(t[0],e[i])):void(e[i]=t[0]);if(t.length)if("TOWGS84"!==i){if("AXIS"===i)return i in e||(e[i]=[]),void e[i].push(t);var n;switch(Array.isArray(i)||(e[i]={}),i){case"UNIT":case"PRIMEM":case"VERT_DATUM":return e[i]={name:t[0].toLowerCase(),convert:t[1]},void(3===t.length&&Eu(t[2],e[i]));case"SPHEROID":case"ELLIPSOID":return e[i]={name:t[0],a:t[1],rf:t[2]},void(4===t.length&&Eu(t[3],e[i]));case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"EDATUM":case"ENGINEERINGDATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":case"COMPD_CS":case"COMPOUNDCRS":case"ENGINEERINGCRS":case"ENGCRS":case"FITTED_CS":case"LOCAL_DATUM":case"DATUM":return t[0]=["name",t[0]],void Ou(e,i,t);default:for(n=-1;++n<t.length;)if(!Array.isArray(t[n]))return Eu(t,e[i]);return Ou(e,i,t)}}else e[i]=t;else e[i]=!0}else e[t]=!0}Bu.prototype.readCharicter=function(){var t=this.text[this.place++];if(4!==this.state)for(;Tu.test(t);){if(this.place>=this.text.length)return;t=this.text[this.place++]}switch(this.state){case Iu:return this.neutral(t);case 2:return this.keyword(t);case 4:return this.quoted(t);case 5:return this.afterquote(t);case 3:return this.number(t);case-1:return}},Bu.prototype.afterquote=function(t){if('"'===t)return this.word+='"',void(this.state=4);if(Pu.test(t))return this.word=this.word.trim(),void this.afterItem(t);throw new Error("havn't handled \""+t+'" in afterquote yet, index '+this.place)},Bu.prototype.afterItem=function(t){return","===t?(null!==this.word&&this.currentObject.push(this.word),this.word=null,void(this.state=Iu)):"]"===t?(this.level--,null!==this.word&&(this.currentObject.push(this.word),this.word=null),this.state=Iu,this.currentObject=this.stack.pop(),void(this.currentObject||(this.state=-1))):void 0},Bu.prototype.number=function(t){if(!Cu.test(t)){if(Pu.test(t))return this.word=parseFloat(this.word),void this.afterItem(t);throw new Error("havn't handled \""+t+'" in number yet, index '+this.place)}this.word+=t},Bu.prototype.quoted=function(t){'"'!==t?this.word+=t:this.state=5},Bu.prototype.keyword=function(t){if(Au.test(t))this.word+=t;else{if("["===t){var e=[];return e.push(this.word),this.level++,null===this.root?this.root=e:this.currentObject.push(e),this.stack.push(this.currentObject),this.currentObject=e,void(this.state=Iu)}if(!Pu.test(t))throw new Error("havn't handled \""+t+'" in keyword yet, index '+this.place);this.afterItem(t)}},Bu.prototype.neutral=function(t){if(Lu.test(t))return this.word=t,void(this.state=2);if('"'===t)return this.word="",void(this.state=4);if(Cu.test(t))return this.word=t,void(this.state=3);if(!Pu.test(t))throw new Error("havn't handled \""+t+'" in neutral yet, index '+this.place);this.afterItem(t)},Bu.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(-1===this.state)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};var Nu=.017453292519943295;function zu(t){return t*Nu}function ku(t){var e=Su(t),i=e.shift(),n=e.shift();e.unshift(["name",n]),e.unshift(["type",i]);var s={};return Eu(e,s),function(t){if("GEOGCS"===t.type?t.projName="longlat":"LOCAL_CS"===t.type?(t.projName="identity",t.local=!0):"object"==typeof t.PROJECTION?t.projName=Object.keys(t.PROJECTION)[0]:t.projName=t.PROJECTION,t.AXIS){for(var e="",i=0,n=t.AXIS.length;i<n;++i){var s=[t.AXIS[i][0].toLowerCase(),t.AXIS[i][1].toLowerCase()];-1!==s[0].indexOf("north")||("y"===s[0]||"lat"===s[0])&&"north"===s[1]?e+="n":-1!==s[0].indexOf("south")||("y"===s[0]||"lat"===s[0])&&"south"===s[1]?e+="s":-1!==s[0].indexOf("east")||("x"===s[0]||"lon"===s[0])&&"east"===s[1]?e+="e":-1===s[0].indexOf("west")&&("x"!==s[0]&&"lon"!==s[0]||"west"!==s[1])||(e+="w")}2===e.length&&(e+="u"),3===e.length&&(t.axis=e)}t.UNIT&&(t.units=t.UNIT.name.toLowerCase(),"metre"===t.units&&(t.units="meter"),t.UNIT.convert&&("GEOGCS"===t.type?t.DATUM&&t.DATUM.SPHEROID&&(t.to_meter=t.UNIT.convert*t.DATUM.SPHEROID.a):t.to_meter=t.UNIT.convert));var r=t.GEOGCS;function o(e){return e*(t.to_meter||1)}"GEOGCS"===t.type&&(r=t),r&&(r.DATUM?t.datumCode=r.DATUM.name.toLowerCase():t.datumCode=r.name.toLowerCase(),"d_"===t.datumCode.slice(0,2)&&(t.datumCode=t.datumCode.slice(2)),"new_zealand_geodetic_datum_1949"!==t.datumCode&&"new_zealand_1949"!==t.datumCode||(t.datumCode="nzgd49"),"wgs_1984"!==t.datumCode&&"world_geodetic_system_1984"!==t.datumCode||("Mercator_Auxiliary_Sphere"===t.PROJECTION&&(t.sphere=!0),t.datumCode="wgs84"),"_ferro"===t.datumCode.slice(-6)&&(t.datumCode=t.datumCode.slice(0,-6)),"_jakarta"===t.datumCode.slice(-8)&&(t.datumCode=t.datumCode.slice(0,-8)),~t.datumCode.indexOf("belge")&&(t.datumCode="rnb72"),r.DATUM&&r.DATUM.SPHEROID&&(t.ellps=r.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),"international"===t.ellps.toLowerCase().slice(0,13)&&(t.ellps="intl"),t.a=r.DATUM.SPHEROID.a,t.rf=parseFloat(r.DATUM.SPHEROID.rf,10)),r.DATUM&&r.DATUM.TOWGS84&&(t.datum_params=r.DATUM.TOWGS84),~t.datumCode.indexOf("osgb_1936")&&(t.datumCode="osgb36"),~t.datumCode.indexOf("osni_1952")&&(t.datumCode="osni52"),(~t.datumCode.indexOf("tm65")||~t.datumCode.indexOf("geodetic_datum_of_1965"))&&(t.datumCode="ire65"),"ch1903+"===t.datumCode&&(t.datumCode="ch1903"),~t.datumCode.indexOf("israel")&&(t.datumCode="isr93")),t.b&&!isFinite(t.b)&&(t.b=t.a),[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_1","Latitude of 1st standard parallel"],["standard_parallel_2","Standard_Parallel_2"],["standard_parallel_2","Latitude of 2nd standard parallel"],["false_easting","False_Easting"],["false_easting","False easting"],["false-easting","Easting at false origin"],["false_northing","False_Northing"],["false_northing","False northing"],["false_northing","Northing at false origin"],["central_meridian","Central_Meridian"],["central_meridian","Longitude of natural origin"],["central_meridian","Longitude of false origin"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["latitude_of_origin","Latitude of natural origin"],["latitude_of_origin","Latitude of false origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",zu],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",zu],["x0","false_easting",o],["y0","false_northing",o],["long0","central_meridian",zu],["lat0","latitude_of_origin",zu],["lat0","standard_parallel_1",zu],["lat1","standard_parallel_1",zu],["lat2","standard_parallel_2",zu],["azimuth","Azimuth"],["alpha","azimuth",zu],["srsCode","name"]].forEach((function(e){return function(t,e){var i=e[0],n=e[1];!(i in t)&&n in t&&(t[i]=t[n],3===e.length&&(t[i]=e[2](t[i])))}(t,e)})),t.long0||!t.longc||"Albers_Conic_Equal_Area"!==t.projName&&"Lambert_Azimuthal_Equal_Area"!==t.projName||(t.long0=t.longc),t.lat_ts||!t.lat1||"Stereographic_South_Pole"!==t.projName&&"Polar Stereographic (variant B)"!==t.projName||(t.lat0=zu(t.lat1>0?90:-90),t.lat_ts=t.lat1)}(s),s}function Du(t){var e=this;if(2===arguments.length){var i=arguments[1];"string"==typeof i?"+"===i.charAt(0)?Du[t]=Mu(arguments[1]):Du[t]=ku(arguments[1]):Du[t]=i}else if(1===arguments.length){if(Array.isArray(t))return t.map((function(t){Array.isArray(t)?Du.apply(e,t):Du(t)}));if("string"==typeof t){if(t in Du)return Du[t]}else"EPSG"in t?Du["EPSG:"+t.EPSG]=t:"ESRI"in t?Du["ESRI:"+t.ESRI]=t:"IAU2000"in t?Du["IAU2000:"+t.IAU2000]=t:console.log(t);return}}!function(t){t("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),t("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),t("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"),t.WGS84=t["EPSG:4326"],t["EPSG:3785"]=t["EPSG:3857"],t.GOOGLE=t["EPSG:3857"],t["EPSG:900913"]=t["EPSG:3857"],t["EPSG:102113"]=t["EPSG:3857"]}(Du);const Fu=Du;var Ru=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"],Uu=["3857","900913","3785","102113"];function Zu(t,e){var i,n;if(t=t||{},!e)return t;for(n in e)void 0!==(i=e[n])&&(t[n]=i);return t}function ju(t,e,i){var n=t*e;return i/Math.sqrt(1-n*n)}function Vu(t){return t<0?-1:1}function Gu(t){return Math.abs(t)<=gu?t:t-Vu(t)*yu}function qu(t,e,i){var n=t*i,s=.5*t;return n=Math.pow((1-n)/(1+n),s),Math.tan(.5*(du-e))/n}function Wu(t,e){for(var i,n,s=.5*t,r=du-2*Math.atan(e),o=0;o<=15;o++)if(i=t*Math.sin(r),r+=n=du-2*Math.atan(e*Math.pow((1-i)/(1+i),s))-r,Math.abs(n)<=1e-10)return r;return-9999}function Hu(t){return t}var $u=[{init:function(){var t=this.b/this.a;this.es=1-t*t,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=ju(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)},forward:function(t){var e,i,n=t.x,s=t.y;if(s*mu>90&&s*mu<-90&&n*mu>180&&n*mu<-180)return null;if(Math.abs(Math.abs(s)-du)<=fu)return null;if(this.sphere)e=this.x0+this.a*this.k0*Gu(n-this.long0),i=this.y0+this.a*this.k0*Math.log(Math.tan(_u+.5*s));else{var r=Math.sin(s),o=qu(this.e,s,r);e=this.x0+this.a*this.k0*Gu(n-this.long0),i=this.y0-this.a*this.k0*Math.log(o)}return t.x=e,t.y=i,t},inverse:function(t){var e,i,n=t.x-this.x0,s=t.y-this.y0;if(this.sphere)i=du-2*Math.atan(Math.exp(-s/(this.a*this.k0)));else{var r=Math.exp(-s/(this.a*this.k0));if(-9999===(i=Wu(this.e,r)))return null}return e=Gu(this.long0+n/(this.a*this.k0)),t.x=e,t.y=i,t},names:["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"]},{init:function(){},forward:Hu,inverse:Hu,names:["longlat","identity"]}],Yu={},Xu=[];function Ku(t,e){var i=Xu.length;return t.names?(Xu[i]=t,t.names.forEach((function(t){Yu[t.toLowerCase()]=i})),this):(console.log(e),!0)}const Ju={start:function(){$u.forEach(Ku)},add:Ku,get:function(t){if(!t)return!1;var e=t.toLowerCase();return void 0!==Yu[e]&&Xu[Yu[e]]?Xu[Yu[e]]:void 0}};var Qu={MERIT:{a:6378137,rf:298.257,ellipseName:"MERIT 1983"},SGS85:{a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},GRS80:{a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},IAU76:{a:6378140,rf:298.257,ellipseName:"IAU 1976"},airy:{a:6377563.396,b:6356256.91,ellipseName:"Airy 1830"},APL4:{a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},NWL9D:{a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},mod_airy:{a:6377340.189,b:6356034.446,ellipseName:"Modified Airy"},andrae:{a:6377104.43,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},aust_SA:{a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},GRS67:{a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},bessel:{a:6377397.155,rf:299.1528128,ellipseName:"Bessel 1841"},bess_nam:{a:6377483.865,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},clrk66:{a:6378206.4,b:6356583.8,ellipseName:"Clarke 1866"},clrk80:{a:6378249.145,rf:293.4663,ellipseName:"Clarke 1880 mod."},clrk80ign:{a:6378249.2,b:6356515,rf:293.4660213,ellipseName:"Clarke 1880 (IGN)"},clrk58:{a:6378293.645208759,rf:294.2606763692654,ellipseName:"Clarke 1858"},CPM:{a:6375738.7,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},delmbr:{a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},engelis:{a:6378136.05,rf:298.2566,ellipseName:"Engelis 1985"},evrst30:{a:6377276.345,rf:300.8017,ellipseName:"Everest 1830"},evrst48:{a:6377304.063,rf:300.8017,ellipseName:"Everest 1948"},evrst56:{a:6377301.243,rf:300.8017,ellipseName:"Everest 1956"},evrst69:{a:6377295.664,rf:300.8017,ellipseName:"Everest 1969"},evrstSS:{a:6377298.556,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},fschr60:{a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},fschr60m:{a:6378155,rf:298.3,ellipseName:"Fischer 1960"},fschr68:{a:6378150,rf:298.3,ellipseName:"Fischer 1968"},helmert:{a:6378200,rf:298.3,ellipseName:"Helmert 1906"},hough:{a:6378270,rf:297,ellipseName:"Hough"},intl:{a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},kaula:{a:6378163,rf:298.24,ellipseName:"Kaula 1961"},lerch:{a:6378139,rf:298.257,ellipseName:"Lerch 1979"},mprts:{a:6397300,rf:191,ellipseName:"Maupertius 1738"},new_intl:{a:6378157.5,b:6356772.2,ellipseName:"New International 1967"},plessis:{a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},krass:{a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},SEasia:{a:6378155,b:6356773.3205,ellipseName:"Southeast Asia"},walbeck:{a:6376896,b:6355834.8467,ellipseName:"Walbeck"},WGS60:{a:6378165,rf:298.3,ellipseName:"WGS 60"},WGS66:{a:6378145,rf:298.25,ellipseName:"WGS 66"},WGS7:{a:6378135,rf:298.26,ellipseName:"WGS 72"}},tc=Qu.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"};Qu.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"};var ec={wgs84:{towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},ch1903:{towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},ggrs87:{towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},nad83:{towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},nad27:{nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},potsdam:{towgs84:"598.1,73.7,418.2,0.202,0.045,-2.455,6.7",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},carthage:{towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},hermannskogel:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Hermannskogel"},osni52:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},ire65:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},rassadiran:{towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},nzgd49:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},osgb36:{towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"},s_jtsk:{towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},beduaram:{towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},gunung_segara:{towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},rnb72:{towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"}};var ic={};function nc(t){if(0===t.length)return null;var e="@"===t[0];return e&&(t=t.slice(1)),"null"===t?{name:"null",mandatory:!e,grid:null,isNull:!0}:{name:t,mandatory:!e,grid:ic[t]||null,isNull:!1}}function sc(t){return t/3600*Math.PI/180}function rc(t,e,i){return String.fromCharCode.apply(null,new Uint8Array(t.buffer.slice(e,i)))}function oc(t){return t.map((function(t){return[sc(t.longitudeShift),sc(t.latitudeShift)]}))}function ac(t,e,i){return{name:rc(t,e+8,e+16).trim(),parent:rc(t,e+24,e+24+8).trim(),lowerLatitude:t.getFloat64(e+72,i),upperLatitude:t.getFloat64(e+88,i),lowerLongitude:t.getFloat64(e+104,i),upperLongitude:t.getFloat64(e+120,i),latitudeInterval:t.getFloat64(e+136,i),longitudeInterval:t.getFloat64(e+152,i),gridNodeCount:t.getInt32(e+168,i)}}function hc(t,e,i,n){for(var s=e+176,r=[],o=0;o<i.gridNodeCount;o++){var a={latitudeShift:t.getFloat32(s+16*o,n),longitudeShift:t.getFloat32(s+16*o+4,n),latitudeAccuracy:t.getFloat32(s+16*o+8,n),longitudeAccuracy:t.getFloat32(s+16*o+12,n)};r.push(a)}return r}function lc(t,e){if(!(this instanceof lc))return new lc(t);e=e||function(t){if(t)throw t};var i=function(t){if(!function(t){return"string"==typeof t}(t))return t;if(function(t){return t in Fu}(t))return Fu[t];if(function(t){return Ru.some((function(e){return t.indexOf(e)>-1}))}(t)){var e=ku(t);if(function(t){var e=xu(t,"authority");if(e){var i=xu(e,"epsg");return i&&Uu.indexOf(i)>-1}}(e))return Fu["EPSG:3857"];var i=function(t){var e=xu(t,"extension");if(e)return xu(e,"proj4")}(e);return i?Mu(i):e}return function(t){return"+"===t[0]}(t)?Mu(t):void 0}(t);if("object"==typeof i){var n=lc.projections.get(i.projName);if(n){if(i.datumCode&&"none"!==i.datumCode){var s=xu(ec,i.datumCode);s&&(i.datum_params=i.datum_params||(s.towgs84?s.towgs84.split(","):null),i.ellps=s.ellipse,i.datumName=s.datumName?s.datumName:i.datumCode)}i.k0=i.k0||1,i.axis=i.axis||"enu",i.ellps=i.ellps||"wgs84",i.lat1=i.lat1||i.lat0;var r,o,a,h,l,u,c=function(t,e,i,n,s){if(!t){var r=xu(Qu,n);r||(r=tc),t=r.a,e=r.b,i=r.rf}return i&&!e&&(e=(1-1/i)*t),(0===i||Math.abs(t-e)<fu)&&(s=!0,e=t),{a:t,b:e,rf:i,sphere:s}}(i.a,i.b,i.rf,i.ellps,i.sphere),d=(r=c.a,o=c.b,c.rf,l=((a=r*r)-(h=o*o))/a,u=0,i.R_A?(a=(r*=1-l*(.16666666666666666+l*(.04722222222222222+.022156084656084655*l)))*r,l=0):u=Math.sqrt(l),{es:l,e:u,ep2:(a-h)/h}),f=function(t){return void 0===t?null:t.split(",").map(nc)}(i.nadgrids),p=i.datum||function(t,e,i,n,s,r,o){var a={};return a.datum_type=void 0===t||"none"===t?au:4,e&&(a.datum_params=e.map(parseFloat),0===a.datum_params[0]&&0===a.datum_params[1]&&0===a.datum_params[2]||(a.datum_type=su),a.datum_params.length>3&&(0===a.datum_params[3]&&0===a.datum_params[4]&&0===a.datum_params[5]&&0===a.datum_params[6]||(a.datum_type=ru,a.datum_params[3]*=cu,a.datum_params[4]*=cu,a.datum_params[5]*=cu,a.datum_params[6]=a.datum_params[6]/1e6+1))),o&&(a.datum_type=ou,a.grids=o),a.a=i,a.b=n,a.es=s,a.ep2=r,a}(i.datumCode,i.datum_params,c.a,c.b,d.es,d.ep2,f);Zu(this,i),Zu(this,n),this.a=c.a,this.b=c.b,this.rf=c.rf,this.sphere=c.sphere,this.es=d.es,this.e=d.e,this.ep2=d.ep2,this.datum=p,this.init(),e(null,this)}else e(t)}else e(t)}lc.projections=Ju,lc.projections.start();const uc=lc;function cc(t,e,i){var n,s,r,o,a=t.x,h=t.y,l=t.z?t.z:0;if(h<-du&&h>-1.001*du)h=-du;else if(h>du&&h<1.001*du)h=du;else{if(h<-du)return{x:-1/0,y:-1/0,z:t.z};if(h>du)return{x:1/0,y:1/0,z:t.z}}return a>Math.PI&&(a-=2*Math.PI),s=Math.sin(h),o=Math.cos(h),r=s*s,{x:((n=i/Math.sqrt(1-e*r))+l)*o*Math.cos(a),y:(n+l)*o*Math.sin(a),z:(n*(1-e)+l)*s}}function dc(t,e,i,n){var s,r,o,a,h,l,u,c,d,f,p,m,_,y,g,v=t.x,b=t.y,w=t.z?t.z:0;if(s=Math.sqrt(v*v+b*b),r=Math.sqrt(v*v+b*b+w*w),s/i<1e-12){if(y=0,r/i<1e-12)return g=-n,{x:t.x,y:t.y,z:t.z}}else y=Math.atan2(b,v);o=w/r,c=(a=s/r)*(1-e)*(h=1/Math.sqrt(1-e*(2-e)*a*a)),d=o*h,_=0;do{_++,l=e*(u=i/Math.sqrt(1-e*d*d))/(u+(g=s*c+w*d-u*(1-e*d*d))),m=(p=o*(h=1/Math.sqrt(1-l*(2-l)*a*a)))*c-(f=a*(1-l)*h)*d,c=f,d=p}while(m*m>1e-24&&_<30);return{x:y,y:Math.atan(p/Math.abs(f)),z:g}}function fc(t){return t===su||t===ru}function pc(t,e,i){if(null===t.grids||0===t.grids.length)return console.log("Grid shift grids not found"),-1;for(var n={x:-i.x,y:i.y},s={x:Number.NaN,y:Number.NaN},r=[],o=0;o<t.grids.length;o++){var a=t.grids[o];if(r.push(a.name),a.isNull){s=n;break}if(a.mandatory,null!==a.grid){var h=a.grid.subgrids[0],l=(Math.abs(h.del[1])+Math.abs(h.del[0]))/1e4,u=h.ll[0]-l,c=h.ll[1]-l,d=h.ll[0]+(h.lim[0]-1)*h.del[0]+l,f=h.ll[1]+(h.lim[1]-1)*h.del[1]+l;if(!(c>n.y||u>n.x||f<n.y||d<n.x||(s=mc(n,e,h),isNaN(s.x))))break}else if(a.mandatory)return console.log("Unable to find mandatory grid '"+a.name+"'"),-1}return isNaN(s.x)?(console.log("Failed to find a grid shift table for location '"+-n.x*mu+" "+n.y*mu+" tried: '"+r+"'"),-1):(i.x=-s.x,i.y=s.y,0)}function mc(t,e,i){var n={x:Number.NaN,y:Number.NaN};if(isNaN(t.x))return n;var s={x:t.x,y:t.y};s.x-=i.ll[0],s.y-=i.ll[1],s.x=Gu(s.x-Math.PI)+Math.PI;var r=_c(s,i);if(e){if(isNaN(r.x))return n;r.x=s.x-r.x,r.y=s.y-r.y;var o,a,h=9;do{if(a=_c(r,i),isNaN(a.x)){console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}o={x:s.x-(a.x+r.x),y:s.y-(a.y+r.y)},r.x+=o.x,r.y+=o.y}while(h--&&Math.abs(o.x)>1e-12&&Math.abs(o.y)>1e-12);if(h<0)return console.log("Inverse grid shift iterator failed to converge."),n;n.x=Gu(r.x+i.ll[0]),n.y=r.y+i.ll[1]}else isNaN(r.x)||(n.x=t.x+r.x,n.y=t.y+r.y);return n}function _c(t,e){var i,n={x:t.x/e.del[0],y:t.y/e.del[1]},s=Math.floor(n.x),r=Math.floor(n.y),o=n.x-1*s,a=n.y-1*r,h={x:Number.NaN,y:Number.NaN};if(s<0||s>=e.lim[0])return h;if(r<0||r>=e.lim[1])return h;i=r*e.lim[0]+s;var l=e.cvs[i][0],u=e.cvs[i][1];i++;var c=e.cvs[i][0],d=e.cvs[i][1];i+=e.lim[0];var f=e.cvs[i][0],p=e.cvs[i][1];i--;var m=e.cvs[i][0],_=e.cvs[i][1],y=o*a,g=o*(1-a),v=(1-o)*(1-a),b=(1-o)*a;return h.x=v*l+g*c+b*m+y*f,h.y=v*u+g*d+b*_+y*p,h}function yc(t,e,i){var n,s,r,o=i.x,a=i.y,h=i.z||0,l={};for(r=0;r<3;r++)if(!e||2!==r||void 0!==i.z)switch(0===r?(n=o,s=-1!=="ew".indexOf(t.axis[r])?"x":"y"):1===r?(n=a,s=-1!=="ns".indexOf(t.axis[r])?"y":"x"):(n=h,s="z"),t.axis[r]){case"e":case"n":l[s]=n;break;case"w":case"s":l[s]=-n;break;case"u":void 0!==i[s]&&(l.z=n);break;case"d":void 0!==i[s]&&(l.z=-n);break;default:return null}return l}function gc(t){var e={x:t[0],y:t[1]};return t.length>2&&(e.z=t[2]),t.length>3&&(e.m=t[3]),e}function vc(t){if("function"==typeof Number.isFinite){if(Number.isFinite(t))return;throw new TypeError("coordinates must be finite numbers")}if("number"!=typeof t||t!=t||!isFinite(t))throw new TypeError("coordinates must be finite numbers")}function bc(t,e,i,n){var s,r=void 0!==(i=Array.isArray(i)?gc(i):{x:i.x,y:i.y,z:i.z,m:i.m}).z;if(function(t){vc(t.x),vc(t.y)}(i),t.datum&&e.datum&&function(t,e){return(t.datum.datum_type===su||t.datum.datum_type===ru||t.datum.datum_type===ou)&&"WGS84"!==e.datumCode||(e.datum.datum_type===su||e.datum.datum_type===ru||e.datum.datum_type===ou)&&"WGS84"!==t.datumCode}(t,e)&&(i=bc(t,s=new uc("WGS84"),i,n),t=s),n&&"enu"!==t.axis&&(i=yc(t,!1,i)),"longlat"===t.projName)i={x:i.x*pu,y:i.y*pu,z:i.z||0};else if(t.to_meter&&(i={x:i.x*t.to_meter,y:i.y*t.to_meter,z:i.z||0}),!(i=t.inverse(i)))return;if(t.from_greenwich&&(i.x+=t.from_greenwich),i=function(t,e,i){if(function(t,e){return t.datum_type===e.datum_type&&!(t.a!==e.a||Math.abs(t.es-e.es)>5e-11)&&(t.datum_type===su?t.datum_params[0]===e.datum_params[0]&&t.datum_params[1]===e.datum_params[1]&&t.datum_params[2]===e.datum_params[2]:t.datum_type!==ru||t.datum_params[0]===e.datum_params[0]&&t.datum_params[1]===e.datum_params[1]&&t.datum_params[2]===e.datum_params[2]&&t.datum_params[3]===e.datum_params[3]&&t.datum_params[4]===e.datum_params[4]&&t.datum_params[5]===e.datum_params[5]&&t.datum_params[6]===e.datum_params[6])}(t,e))return i;if(t.datum_type===au||e.datum_type===au)return i;var n=t.a,s=t.es;if(t.datum_type===ou){if(0!==pc(t,!1,i))return;n=hu,s=uu}var r=e.a,o=e.b,a=e.es;return e.datum_type===ou&&(r=hu,o=lu,a=uu),s!==a||n!==r||fc(t.datum_type)||fc(e.datum_type)?(i=cc(i,s,n),fc(t.datum_type)&&(i=function(t,e,i){if(e===su)return{x:t.x+i[0],y:t.y+i[1],z:t.z+i[2]};if(e===ru){var n=i[0],s=i[1],r=i[2],o=i[3],a=i[4],h=i[5],l=i[6];return{x:l*(t.x-h*t.y+a*t.z)+n,y:l*(h*t.x+t.y-o*t.z)+s,z:l*(-a*t.x+o*t.y+t.z)+r}}}(i,t.datum_type,t.datum_params)),fc(e.datum_type)&&(i=function(t,e,i){if(e===su)return{x:t.x-i[0],y:t.y-i[1],z:t.z-i[2]};if(e===ru){var n=i[0],s=i[1],r=i[2],o=i[3],a=i[4],h=i[5],l=i[6],u=(t.x-n)/l,c=(t.y-s)/l,d=(t.z-r)/l;return{x:u+h*c-a*d,y:-h*u+c+o*d,z:a*u-o*c+d}}}(i,e.datum_type,e.datum_params)),i=dc(i,a,r,o),e.datum_type!==ou||0===pc(e,!0,i)?i:void 0):i}(t.datum,e.datum,i))return e.from_greenwich&&(i={x:i.x-e.from_greenwich,y:i.y,z:i.z||0}),"longlat"===e.projName?i={x:i.x*mu,y:i.y*mu,z:i.z||0}:(i=e.forward(i),e.to_meter&&(i={x:i.x/e.to_meter,y:i.y/e.to_meter,z:i.z||0})),n&&"enu"!==e.axis?yc(e,!0,i):(r||delete i.z,i)}var wc=uc("WGS84");function xc(t,e,i,n){var s,r,o;return Array.isArray(i)?(s=bc(t,e,i,n)||{x:NaN,y:NaN},i.length>2?void 0!==t.name&&"geocent"===t.name||void 0!==e.name&&"geocent"===e.name?"number"==typeof s.z?[s.x,s.y,s.z].concat(i.splice(3)):[s.x,s.y,i[2]].concat(i.splice(3)):[s.x,s.y].concat(i.splice(2)):[s.x,s.y]):(r=bc(t,e,i,n),2===(o=Object.keys(i)).length||o.forEach((function(n){if(void 0!==t.name&&"geocent"===t.name||void 0!==e.name&&"geocent"===e.name){if("x"===n||"y"===n||"z"===n)return}else if("x"===n||"y"===n)return;r[n]=i[n]})),r)}function Mc(t){return t instanceof uc?t:t.oProj?t.oProj:uc(t)}const Sc=function(t,e,i){t=Mc(t);var n,s=!1;return void 0===e?(e=t,t=wc,s=!0):(void 0!==e.x||Array.isArray(e))&&(i=e,e=t,t=wc,s=!0),e=Mc(e),i?xc(t,e,i):(n={forward:function(i,n){return xc(t,e,i,n)},inverse:function(i,n){return xc(e,t,i,n)}},s&&(n.oProj=e),n)};var Ic=6,Tc="AJSAJS",Lc="AFAFAF",Ac=65,Pc=73,Cc=79,Bc=86,Oc=90;const Ec={forward:Nc,inverse:function(t){var e=Fc(Uc(t.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat,e.lon,e.lat]:[e.left,e.bottom,e.right,e.top]},toPoint:zc};function Nc(t,e){return e=e||5,function(t,e){var i,n,s,r,o,a,h,l,u,c,d,f="00000"+t.easting,p="00000"+t.northing;return t.zoneNumber+t.zoneLetter+(u=t.easting,c=t.northing,d=Rc(t.zoneNumber),i=Math.floor(u/1e5),n=Math.floor(c/1e5)%20,s=d-1,r=Tc.charCodeAt(s),o=Lc.charCodeAt(s),l=!1,(a=r+i-1)>Oc&&(a=a-Oc+Ac-1,l=!0),(a===Pc||r<Pc&&a>Pc||(a>Pc||r<Pc)&&l)&&a++,(a===Cc||r<Cc&&a>Cc||(a>Cc||r<Cc)&&l)&&++a===Pc&&a++,a>Oc&&(a=a-Oc+Ac-1),(h=o+n)>Bc?(h=h-Bc+Ac-1,l=!0):l=!1,(h===Pc||o<Pc&&h>Pc||(h>Pc||o<Pc)&&l)&&h++,(h===Cc||o<Cc&&h>Cc||(h>Cc||o<Cc)&&l)&&++h===Pc&&h++,h>Bc&&(h=h-Bc+Ac-1),String.fromCharCode(a)+String.fromCharCode(h))+f.substr(f.length-5,e)+p.substr(p.length-5,e)}(function(t){var e,i,n,s,r,o,a,h=t.lat,l=t.lon,u=6378137,c=.00669438,d=.9996,f=kc(h),p=kc(l);a=Math.floor((l+180)/6)+1,180===l&&(a=60),h>=56&&h<64&&l>=3&&l<12&&(a=32),h>=72&&h<84&&(l>=0&&l<9?a=31:l>=9&&l<21?a=33:l>=21&&l<33?a=35:l>=33&&l<42&&(a=37)),o=kc(6*(a-1)-180+3),e=.006739496752268451,i=u/Math.sqrt(1-c*Math.sin(f)*Math.sin(f)),n=Math.tan(f)*Math.tan(f),s=e*Math.cos(f)*Math.cos(f);var m,_,y=d*i*((r=Math.cos(f)*(p-o))+(1-n+s)*r*r*r/6+(5-18*n+n*n+72*s-58*e)*r*r*r*r*r/120)+5e5,g=d*(u*(.9983242984503243*f-.002514607064228144*Math.sin(2*f)+2639046602129982e-21*Math.sin(4*f)-3.418046101696858e-9*Math.sin(6*f))+i*Math.tan(f)*(r*r/2+(5-n+9*s+4*s*s)*r*r*r*r/24+(61-58*n+n*n+600*s-2.2240339282485886)*r*r*r*r*r*r/720));return h<0&&(g+=1e7),{northing:Math.round(g),easting:Math.round(y),zoneNumber:a,zoneLetter:(m=h,_="Z",84>=m&&m>=72?_="X":72>m&&m>=64?_="W":64>m&&m>=56?_="V":56>m&&m>=48?_="U":48>m&&m>=40?_="T":40>m&&m>=32?_="S":32>m&&m>=24?_="R":24>m&&m>=16?_="Q":16>m&&m>=8?_="P":8>m&&m>=0?_="N":0>m&&m>=-8?_="M":-8>m&&m>=-16?_="L":-16>m&&m>=-24?_="K":-24>m&&m>=-32?_="J":-32>m&&m>=-40?_="H":-40>m&&m>=-48?_="G":-48>m&&m>=-56?_="F":-56>m&&m>=-64?_="E":-64>m&&m>=-72?_="D":-72>m&&m>=-80&&(_="C"),_)}}({lat:t[1],lon:t[0]}),e)}function zc(t){var e=Fc(Uc(t.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat]:[(e.left+e.right)/2,(e.top+e.bottom)/2]}function kc(t){return t*(Math.PI/180)}function Dc(t){return t/Math.PI*180}function Fc(t){var e=t.northing,i=t.easting,n=t.zoneLetter,s=t.zoneNumber;if(s<0||s>60)return null;var r,o,a,h,l,u,c,d,f,p=.9996,m=6378137,_=.00669438,y=(1-Math.sqrt(.99330562))/(1+Math.sqrt(.99330562)),g=i-5e5,v=e;n<"N"&&(v-=1e7),c=6*(s-1)-180+3,r=.006739496752268451,f=(d=v/p/6367449.145945056)+(3*y/2-27*y*y*y/32)*Math.sin(2*d)+(21*y*y/16-55*y*y*y*y/32)*Math.sin(4*d)+151*y*y*y/96*Math.sin(6*d),o=m/Math.sqrt(1-_*Math.sin(f)*Math.sin(f)),a=Math.tan(f)*Math.tan(f),h=r*Math.cos(f)*Math.cos(f),l=.99330562*m/Math.pow(1-_*Math.sin(f)*Math.sin(f),1.5),u=g/(o*p);var b=f-o*Math.tan(f)/l*(u*u/2-(5+3*a+10*h-4*h*h-9*r)*u*u*u*u/24+(61+90*a+298*h+45*a*a-1.6983531815716497-3*h*h)*u*u*u*u*u*u/720);b=Dc(b);var w,x=(u-(1+2*a+h)*u*u*u/6+(5-2*h+28*a-3*h*h+8*r+24*a*a)*u*u*u*u*u/120)/Math.cos(f);if(x=c+Dc(x),t.accuracy){var M=Fc({northing:t.northing+t.accuracy,easting:t.easting+t.accuracy,zoneLetter:t.zoneLetter,zoneNumber:t.zoneNumber});w={top:M.lat,right:M.lon,bottom:b,left:x}}else w={lat:b,lon:x};return w}function Rc(t){var e=t%Ic;return 0===e&&(e=Ic),e}function Uc(t){if(t&&0===t.length)throw"MGRSPoint coverting from nothing";for(var e,i=t.length,n=null,s="",r=0;!/[A-Z]/.test(e=t.charAt(r));){if(r>=2)throw"MGRSPoint bad conversion from: "+t;s+=e,r++}var o=parseInt(s,10);if(0===r||r+3>i)throw"MGRSPoint bad conversion from: "+t;var a=t.charAt(r++);if(a<="A"||"B"===a||"Y"===a||a>="Z"||"I"===a||"O"===a)throw"MGRSPoint zone letter "+a+" not handled: "+t;n=t.substring(r,r+=2);for(var h=Rc(o),l=function(t,e){for(var i=Tc.charCodeAt(e-1),n=1e5,s=!1;i!==t.charCodeAt(0);){if(++i===Pc&&i++,i===Cc&&i++,i>Oc){if(s)throw"Bad character: "+t;i=Ac,s=!0}n+=1e5}return n}(n.charAt(0),h),u=function(t,e){if(t>"V")throw"MGRSPoint given invalid Northing "+t;for(var i=Lc.charCodeAt(e-1),n=0,s=!1;i!==t.charCodeAt(0);){if(++i===Pc&&i++,i===Cc&&i++,i>Bc){if(s)throw"Bad character: "+t;i=Ac,s=!0}n+=1e5}return n}(n.charAt(1),h);u<Zc(a);)u+=2e6;var c=i-r;if(c%2!=0)throw"MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters"+t;var d,f,p,m=c/2,_=0,y=0;return m>0&&(d=1e5/Math.pow(10,m),f=t.substring(r,r+m),_=parseFloat(f)*d,p=t.substring(r+m),y=parseFloat(p)*d),{easting:_+l,northing:y+u,zoneLetter:a,zoneNumber:o,accuracy:d}}function Zc(t){var e;switch(t){case"C":e=11e5;break;case"D":e=2e6;break;case"E":e=28e5;break;case"F":e=37e5;break;case"G":e=46e5;break;case"H":e=55e5;break;case"J":e=64e5;break;case"K":e=73e5;break;case"L":e=82e5;break;case"M":e=91e5;break;case"N":e=0;break;case"P":e=8e5;break;case"Q":e=17e5;break;case"R":e=26e5;break;case"S":e=35e5;break;case"T":e=44e5;break;case"U":e=53e5;break;case"V":e=62e5;break;case"W":e=7e6;break;case"X":e=79e5;break;default:e=-1}if(e>=0)return e;throw"Invalid zone letter: "+t}function jc(t,e,i){if(!(this instanceof jc))return new jc(t,e,i);if(Array.isArray(t))this.x=t[0],this.y=t[1],this.z=t[2]||0;else if("object"==typeof t)this.x=t.x,this.y=t.y,this.z=t.z||0;else if("string"==typeof t&&void 0===e){var n=t.split(",");this.x=parseFloat(n[0],10),this.y=parseFloat(n[1],10),this.z=parseFloat(n[2],10)||0}else this.x=t,this.y=e,this.z=i||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}jc.fromMGRS=function(t){return new jc(zc(t))},jc.prototype.toMGRS=function(t){return Nc([this.x,this.y],t)};const Vc=jc;var Gc=.046875,qc=.01953125,Wc=.01068115234375;function Hc(t){var e=[];e[0]=1-t*(.25+t*(Gc+t*(qc+t*Wc))),e[1]=t*(.75-t*(Gc+t*(qc+t*Wc)));var i=t*t;return e[2]=i*(.46875-t*(.013020833333333334+.007120768229166667*t)),i*=t,e[3]=i*(.3645833333333333-.005696614583333333*t),e[4]=i*t*.3076171875,e}function $c(t,e,i,n){return i*=e,e*=e,n[0]*t-i*(n[1]+e*(n[2]+e*(n[3]+e*n[4])))}function Yc(t,e,i){for(var n=1/(1-e),s=t,r=20;r;--r){var o=Math.sin(s),a=1-e*o*o;if(s-=a=($c(s,o,Math.cos(s),i)-t)*(a*Math.sqrt(a))*n,Math.abs(a)<fu)return s}return s}const Xc={init:function(){this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.es&&(this.en=Hc(this.es),this.ml0=$c(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))},forward:function(t){var e,i,n,s=t.x,r=t.y,o=Gu(s-this.long0),a=Math.sin(r),h=Math.cos(r);if(this.es){var l=h*o,u=Math.pow(l,2),c=this.ep2*Math.pow(h,2),d=Math.pow(c,2),f=Math.abs(h)>fu?Math.tan(r):0,p=Math.pow(f,2),m=Math.pow(p,2);e=1-this.es*Math.pow(a,2),l/=Math.sqrt(e);var _=$c(r,a,h,this.en);i=this.a*(this.k0*l*(1+u/6*(1-p+c+u/20*(5-18*p+m+14*c-58*p*c+u/42*(61+179*m-m*p-479*p)))))+this.x0,n=this.a*(this.k0*(_-this.ml0+a*o*l/2*(1+u/12*(5-p+9*c+4*d+u/30*(61+m-58*p+270*c-330*p*c+u/56*(1385+543*m-m*p-3111*p))))))+this.y0}else{var y=h*Math.sin(o);if(Math.abs(Math.abs(y)-1)<fu)return 93;if(i=.5*this.a*this.k0*Math.log((1+y)/(1-y))+this.x0,n=h*Math.cos(o)/Math.sqrt(1-Math.pow(y,2)),(y=Math.abs(n))>=1){if(y-1>fu)return 93;n=0}else n=Math.acos(n);r<0&&(n=-n),n=this.a*this.k0*(n-this.lat0)+this.y0}return t.x=i,t.y=n,t},inverse:function(t){var e,i,n,s,r=(t.x-this.x0)*(1/this.a),o=(t.y-this.y0)*(1/this.a);if(this.es)if(i=Yc(e=this.ml0+o/this.k0,this.es,this.en),Math.abs(i)<du){var a=Math.sin(i),h=Math.cos(i),l=Math.abs(h)>fu?Math.tan(i):0,u=this.ep2*Math.pow(h,2),c=Math.pow(u,2),d=Math.pow(l,2),f=Math.pow(d,2);e=1-this.es*Math.pow(a,2);var p=r*Math.sqrt(e)/this.k0,m=Math.pow(p,2);n=i-(e*=l)*m/(1-this.es)*.5*(1-m/12*(5+3*d-9*u*d+u-4*c-m/30*(61+90*d-252*u*d+45*f+46*u-m/56*(1385+3633*d+4095*f+1574*f*d)))),s=Gu(this.long0+p*(1-m/6*(1+2*d+u-m/20*(5+28*d+24*f+8*u*d+6*u-m/42*(61+662*d+1320*f+720*f*d))))/h)}else n=du*Vu(o),s=0;else{var _=Math.exp(r/this.k0),y=.5*(_-1/_),g=this.lat0+o/this.k0,v=Math.cos(g);e=Math.sqrt((1-Math.pow(v,2))/(1+Math.pow(y,2))),n=Math.asin(e),o<0&&(n=-n),s=0===y&&0===v?0:Gu(Math.atan2(y,v)+this.long0)}return t.x=s,t.y=n,t},names:["Fast_Transverse_Mercator","Fast Transverse Mercator"]};function Kc(t){var e=Math.exp(t);return(e-1/e)/2}function Jc(t,e){t=Math.abs(t),e=Math.abs(e);var i=Math.max(t,e),n=Math.min(t,e)/(i||1);return i*Math.sqrt(1+Math.pow(n,2))}function Qc(t,e){for(var i,n=2*Math.cos(2*e),s=t.length-1,r=t[s],o=0;--s>=0;)i=n*r-o+t[s],o=r,r=i;return e+i*Math.sin(2*e)}function td(t,e,i){for(var n,s,r=Math.sin(e),o=Math.cos(e),a=Kc(i),h=function(t){var e=Math.exp(t);return(e+1/e)/2}(i),l=2*o*h,u=-2*r*a,c=t.length-1,d=t[c],f=0,p=0,m=0;--c>=0;)n=p,s=f,d=l*(p=d)-n-u*(f=m)+t[c],m=u*p-s+l*f;return[(l=r*h)*d-(u=o*a)*m,l*m+u*d]}const ed={init:function(){if(!this.approx&&(isNaN(this.es)||this.es<=0))throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.');this.approx&&(Xc.init.apply(this),this.forward=Xc.forward,this.inverse=Xc.inverse),this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var t=this.es/(1+Math.sqrt(1-this.es)),e=t/(2-t),i=e;this.cgb[0]=e*(2+e*(-2/3+e*(e*(116/45+e*(26/45+e*(-2854/675)))-2))),this.cbg[0]=e*(e*(2/3+e*(4/3+e*(-82/45+e*(32/45+e*(4642/4725)))))-2),i*=e,this.cgb[1]=i*(7/3+e*(e*(-227/45+e*(2704/315+e*(2323/945)))-1.6)),this.cbg[1]=i*(5/3+e*(-16/15+e*(-13/9+e*(904/315+e*(-1522/945))))),i*=e,this.cgb[2]=i*(56/15+e*(-136/35+e*(-1262/105+e*(73814/2835)))),this.cbg[2]=i*(-26/15+e*(34/21+e*(1.6+e*(-12686/2835)))),i*=e,this.cgb[3]=i*(4279/630+e*(-332/35+e*(-399572/14175))),this.cbg[3]=i*(1237/630+e*(e*(-24832/14175)-2.4)),i*=e,this.cgb[4]=i*(4174/315+e*(-144838/6237)),this.cbg[4]=i*(-734/315+e*(109598/31185)),i*=e,this.cgb[5]=i*(601676/22275),this.cbg[5]=i*(444337/155925),i=Math.pow(e,2),this.Qn=this.k0/(1+e)*(1+i*(1/4+i*(1/64+i/256))),this.utg[0]=e*(e*(2/3+e*(-37/96+e*(1/360+e*(81/512+e*(-96199/604800)))))-.5),this.gtu[0]=e*(.5+e*(-2/3+e*(5/16+e*(41/180+e*(-127/288+e*(7891/37800)))))),this.utg[1]=i*(-1/48+e*(-1/15+e*(437/1440+e*(-46/105+e*(1118711/3870720))))),this.gtu[1]=i*(13/48+e*(e*(557/1440+e*(281/630+e*(-1983433/1935360)))-.6)),i*=e,this.utg[2]=i*(-17/480+e*(37/840+e*(209/4480+e*(-5569/90720)))),this.gtu[2]=i*(61/240+e*(-103/140+e*(15061/26880+e*(167603/181440)))),i*=e,this.utg[3]=i*(-4397/161280+e*(11/504+e*(830251/7257600))),this.gtu[3]=i*(49561/161280+e*(-179/168+e*(6601661/7257600))),i*=e,this.utg[4]=i*(-4583/161280+e*(108847/3991680)),this.gtu[4]=i*(34729/80640+e*(-3418889/1995840)),i*=e,this.utg[5]=i*(-20648693/638668800),this.gtu[5]=.6650675310896665*i;var n=Qc(this.cbg,this.lat0);this.Zb=-this.Qn*(n+function(t,e){for(var i,n=2*Math.cos(e),s=t.length-1,r=t[s],o=0;--s>=0;)i=n*r-o+t[s],o=r,r=i;return Math.sin(e)*i}(this.gtu,2*n))},forward:function(t){var e=Gu(t.x-this.long0),i=t.y;i=Qc(this.cbg,i);var n=Math.sin(i),s=Math.cos(i),r=Math.sin(e),o=Math.cos(e);i=Math.atan2(n,o*s),e=Math.atan2(r*s,Jc(n,s*o)),e=function(t){var e=Math.abs(t);return e=function(t){var e=1+t,i=e-1;return 0===i?t:t*Math.log(e)/i}(e*(1+e/(Jc(1,e)+1))),t<0?-e:e}(Math.tan(e));var a,h,l=td(this.gtu,2*i,2*e);return i+=l[0],e+=l[1],Math.abs(e)<=2.623395162778?(a=this.a*(this.Qn*e)+this.x0,h=this.a*(this.Qn*i+this.Zb)+this.y0):(a=1/0,h=1/0),t.x=a,t.y=h,t},inverse:function(t){var e,i,n=(t.x-this.x0)*(1/this.a),s=(t.y-this.y0)*(1/this.a);if(s=(s-this.Zb)/this.Qn,n/=this.Qn,Math.abs(n)<=2.623395162778){var r=td(this.utg,2*s,2*n);s+=r[0],n+=r[1],n=Math.atan(Kc(n));var o=Math.sin(s),a=Math.cos(s),h=Math.sin(n),l=Math.cos(n);s=Math.atan2(o*l,Jc(h,l*a)),e=Gu((n=Math.atan2(h,l*a))+this.long0),i=Qc(this.cgb,s)}else e=1/0,i=1/0;return t.x=e,t.y=i,t},names:["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc","Transverse_Mercator","Transverse Mercator","tmerc"]},id={init:function(){var t=function(t,e){if(void 0===t){if((t=Math.floor(30*(Gu(e)+Math.PI)/Math.PI)+1)<0)return 0;if(t>60)return 60}return t}(this.zone,this.long0);if(void 0===t)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(t)-183)*pu,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,ed.init.apply(this),this.forward=ed.forward,this.inverse=ed.inverse},names:["Universal Transverse Mercator System","utm"],dependsOn:"etmerc"};function nd(t,e){return Math.pow((1-t)/(1+t),e)}const sd={init:function(){var t=Math.sin(this.lat0),e=Math.cos(this.lat0);e*=e,this.rc=Math.sqrt(1-this.es)/(1-this.es*t*t),this.C=Math.sqrt(1+this.es*e*e/(1-this.es)),this.phic0=Math.asin(t/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+_u)/(Math.pow(Math.tan(.5*this.lat0+_u),this.C)*nd(this.e*t,this.ratexp))},forward:function(t){var e=t.x,i=t.y;return t.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*i+_u),this.C)*nd(this.e*Math.sin(i),this.ratexp))-du,t.x=this.C*e,t},inverse:function(t){for(var e=t.x/this.C,i=t.y,n=Math.pow(Math.tan(.5*i+_u)/this.K,1/this.C),s=20;s>0&&(i=2*Math.atan(n*nd(this.e*Math.sin(t.y),-.5*this.e))-du,!(Math.abs(i-t.y)<1e-14));--s)t.y=i;return s?(t.x=e,t.y=i,t):null},names:["gauss"]},rd={init:function(){sd.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))},forward:function(t){var e,i,n,s;return t.x=Gu(t.x-this.long0),sd.forward.apply(this,[t]),e=Math.sin(t.y),i=Math.cos(t.y),n=Math.cos(t.x),s=this.k0*this.R2/(1+this.sinc0*e+this.cosc0*i*n),t.x=s*i*Math.sin(t.x),t.y=s*(this.cosc0*e-this.sinc0*i*n),t.x=this.a*t.x+this.x0,t.y=this.a*t.y+this.y0,t},inverse:function(t){var e,i,n,s,r;if(t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,r=Math.sqrt(t.x*t.x+t.y*t.y)){var o=2*Math.atan2(r,this.R2);e=Math.sin(o),i=Math.cos(o),s=Math.asin(i*this.sinc0+t.y*e*this.cosc0/r),n=Math.atan2(t.x*e,r*this.cosc0*i-t.y*this.sinc0*e)}else s=this.phic0,n=0;return t.x=n,t.y=s,sd.inverse.apply(this,[t]),t.x=Gu(t.x+this.long0),t},names:["Stereographic_North_Pole","Oblique_Stereographic","Polar_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"]},od={init:function(){this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=fu&&(this.k0=.5*(1+Vu(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=fu&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=fu&&(this.k0=.5*this.cons*ju(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/qu(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=ju(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-du,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))},forward:function(t){var e,i,n,s,r,o,a=t.x,h=t.y,l=Math.sin(h),u=Math.cos(h),c=Gu(a-this.long0);return Math.abs(Math.abs(a-this.long0)-Math.PI)<=fu&&Math.abs(h+this.lat0)<=fu?(t.x=NaN,t.y=NaN,t):this.sphere?(e=2*this.k0/(1+this.sinlat0*l+this.coslat0*u*Math.cos(c)),t.x=this.a*e*u*Math.sin(c)+this.x0,t.y=this.a*e*(this.coslat0*l-this.sinlat0*u*Math.cos(c))+this.y0,t):(i=2*Math.atan(this.ssfn_(h,l,this.e))-du,s=Math.cos(i),n=Math.sin(i),Math.abs(this.coslat0)<=fu?(r=qu(this.e,h*this.con,this.con*l),o=2*this.a*this.k0*r/this.cons,t.x=this.x0+o*Math.sin(a-this.long0),t.y=this.y0-this.con*o*Math.cos(a-this.long0),t):(Math.abs(this.sinlat0)<fu?(e=2*this.a*this.k0/(1+s*Math.cos(c)),t.y=e*n):(e=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*n+this.cosX0*s*Math.cos(c))),t.y=e*(this.cosX0*n-this.sinX0*s*Math.cos(c))+this.y0),t.x=e*s*Math.sin(c)+this.x0,t))},inverse:function(t){var e,i,n,s,r;t.x-=this.x0,t.y-=this.y0;var o=Math.sqrt(t.x*t.x+t.y*t.y);if(this.sphere){var a=2*Math.atan(o/(2*this.a*this.k0));return e=this.long0,i=this.lat0,o<=fu?(t.x=e,t.y=i,t):(i=Math.asin(Math.cos(a)*this.sinlat0+t.y*Math.sin(a)*this.coslat0/o),e=Math.abs(this.coslat0)<fu?this.lat0>0?Gu(this.long0+Math.atan2(t.x,-1*t.y)):Gu(this.long0+Math.atan2(t.x,t.y)):Gu(this.long0+Math.atan2(t.x*Math.sin(a),o*this.coslat0*Math.cos(a)-t.y*this.sinlat0*Math.sin(a))),t.x=e,t.y=i,t)}if(Math.abs(this.coslat0)<=fu){if(o<=fu)return i=this.lat0,e=this.long0,t.x=e,t.y=i,t;t.x*=this.con,t.y*=this.con,n=o*this.cons/(2*this.a*this.k0),i=this.con*Wu(this.e,n),e=this.con*Gu(this.con*this.long0+Math.atan2(t.x,-1*t.y))}else s=2*Math.atan(o*this.cosX0/(2*this.a*this.k0*this.ms1)),e=this.long0,o<=fu?r=this.X0:(r=Math.asin(Math.cos(s)*this.sinX0+t.y*Math.sin(s)*this.cosX0/o),e=Gu(this.long0+Math.atan2(t.x*Math.sin(s),o*this.cosX0*Math.cos(s)-t.y*this.sinX0*Math.sin(s)))),i=-1*Wu(this.e,Math.tan(.5*(du+r)));return t.x=e,t.y=i,t},names:["stere","Stereographic_South_Pole","Polar Stereographic (variant B)"],ssfn_:function(t,e,i){return e*=i,Math.tan(.5*(du+t))*Math.pow((1-e)/(1+e),.5*i)}},ad={init:function(){var t=this.lat0;this.lambda0=this.long0;var e=Math.sin(t),i=this.a,n=1/this.rf,s=2*n-Math.pow(n,2),r=this.e=Math.sqrt(s);this.R=this.k0*i*Math.sqrt(1-s)/(1-s*Math.pow(e,2)),this.alpha=Math.sqrt(1+s/(1-s)*Math.pow(Math.cos(t),4)),this.b0=Math.asin(e/this.alpha);var o=Math.log(Math.tan(Math.PI/4+this.b0/2)),a=Math.log(Math.tan(Math.PI/4+t/2)),h=Math.log((1+r*e)/(1-r*e));this.K=o-this.alpha*a+this.alpha*r/2*h},forward:function(t){var e=Math.log(Math.tan(Math.PI/4-t.y/2)),i=this.e/2*Math.log((1+this.e*Math.sin(t.y))/(1-this.e*Math.sin(t.y))),n=-this.alpha*(e+i)+this.K,s=2*(Math.atan(Math.exp(n))-Math.PI/4),r=this.alpha*(t.x-this.lambda0),o=Math.atan(Math.sin(r)/(Math.sin(this.b0)*Math.tan(s)+Math.cos(this.b0)*Math.cos(r))),a=Math.asin(Math.cos(this.b0)*Math.sin(s)-Math.sin(this.b0)*Math.cos(s)*Math.cos(r));return t.y=this.R/2*Math.log((1+Math.sin(a))/(1-Math.sin(a)))+this.y0,t.x=this.R*o+this.x0,t},inverse:function(t){for(var e=t.x-this.x0,i=t.y-this.y0,n=e/this.R,s=2*(Math.atan(Math.exp(i/this.R))-Math.PI/4),r=Math.asin(Math.cos(this.b0)*Math.sin(s)+Math.sin(this.b0)*Math.cos(s)*Math.cos(n)),o=Math.atan(Math.sin(n)/(Math.cos(this.b0)*Math.cos(n)-Math.sin(this.b0)*Math.tan(s))),a=this.lambda0+o/this.alpha,h=0,l=r,u=-1e3,c=0;Math.abs(l-u)>1e-7;){if(++c>20)return;h=1/this.alpha*(Math.log(Math.tan(Math.PI/4+r/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(l))/2)),u=l,l=2*Math.atan(Math.exp(h))-Math.PI/2}return t.x=a,t.y=l,t},names:["somerc"]};var hd=1e-7;const ld={init:function(){var t,e,i,n,s,r,o,a,h,l,u,c,d,f=0,p=0,m=0,_=0,y=0,g=0,v=0;this.no_off=(d="object"==typeof(c=this).PROJECTION?Object.keys(c.PROJECTION)[0]:c.PROJECTION,"no_uoff"in c||"no_off"in c||-1!==["Hotine_Oblique_Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin"].indexOf(d)),this.no_rot="no_rot"in this;var b=!1;"alpha"in this&&(b=!0);var w=!1;if("rectified_grid_angle"in this&&(w=!0),b&&(v=this.alpha),w&&(f=this.rectified_grid_angle*pu),b||w)p=this.longc;else if(m=this.long1,y=this.lat1,_=this.long2,g=this.lat2,Math.abs(y-g)<=hd||(t=Math.abs(y))<=hd||Math.abs(t-du)<=hd||Math.abs(Math.abs(this.lat0)-du)<=hd||Math.abs(Math.abs(g)-du)<=hd)throw new Error;var x=1-this.es;e=Math.sqrt(x),Math.abs(this.lat0)>fu?(a=Math.sin(this.lat0),i=Math.cos(this.lat0),t=1-this.es*a*a,this.B=i*i,this.B=Math.sqrt(1+this.es*this.B*this.B/x),this.A=this.B*this.k0*e/t,(s=(n=this.B*e/(i*Math.sqrt(t)))*n-1)<=0?s=0:(s=Math.sqrt(s),this.lat0<0&&(s=-s)),this.E=s+=n,this.E*=Math.pow(qu(this.e,this.lat0,a),this.B)):(this.B=1/e,this.A=this.k0,this.E=n=s=1),b||w?(b?(u=Math.asin(Math.sin(v)/n),w||(f=v)):(u=f,v=Math.asin(n*Math.sin(u))),this.lam0=p-Math.asin(.5*(s-1/s)*Math.tan(u))/this.B):(r=Math.pow(qu(this.e,y,Math.sin(y)),this.B),o=Math.pow(qu(this.e,g,Math.sin(g)),this.B),s=this.E/r,h=(o-r)/(o+r),l=((l=this.E*this.E)-o*r)/(l+o*r),(t=m-_)<-Math.pi?_-=yu:t>Math.pi&&(_+=yu),this.lam0=Gu(.5*(m+_)-Math.atan(l*Math.tan(.5*this.B*(m-_))/h)/this.B),u=Math.atan(2*Math.sin(this.B*Gu(m-this.lam0))/(s-1/s)),f=v=Math.asin(n*Math.sin(u))),this.singam=Math.sin(u),this.cosgam=Math.cos(u),this.sinrot=Math.sin(f),this.cosrot=Math.cos(f),this.rB=1/this.B,this.ArB=this.A*this.rB,this.BrA=1/this.ArB,this.A,this.B,this.no_off?this.u_0=0:(this.u_0=Math.abs(this.ArB*Math.atan(Math.sqrt(n*n-1)/Math.cos(v))),this.lat0<0&&(this.u_0=-this.u_0)),s=.5*u,this.v_pole_n=this.ArB*Math.log(Math.tan(_u-s)),this.v_pole_s=this.ArB*Math.log(Math.tan(_u+s))},forward:function(t){var e,i,n,s,r,o,a,h,l={};if(t.x=t.x-this.lam0,Math.abs(Math.abs(t.y)-du)>fu){if(e=.5*((r=this.E/Math.pow(qu(this.e,t.y,Math.sin(t.y)),this.B))-(o=1/r)),i=.5*(r+o),s=Math.sin(this.B*t.x),n=(e*this.singam-s*this.cosgam)/i,Math.abs(Math.abs(n)-1)<fu)throw new Error;h=.5*this.ArB*Math.log((1-n)/(1+n)),o=Math.cos(this.B*t.x),a=Math.abs(o)<hd?this.A*t.x:this.ArB*Math.atan2(e*this.cosgam+s*this.singam,o)}else h=t.y>0?this.v_pole_n:this.v_pole_s,a=this.ArB*t.y;return this.no_rot?(l.x=a,l.y=h):(a-=this.u_0,l.x=h*this.cosrot+a*this.sinrot,l.y=a*this.cosrot-h*this.sinrot),l.x=this.a*l.x+this.x0,l.y=this.a*l.y+this.y0,l},inverse:function(t){var e,i,n,s,r,o,a,h={};if(t.x=(t.x-this.x0)*(1/this.a),t.y=(t.y-this.y0)*(1/this.a),this.no_rot?(i=t.y,e=t.x):(i=t.x*this.cosrot-t.y*this.sinrot,e=t.y*this.cosrot+t.x*this.sinrot+this.u_0),s=.5*((n=Math.exp(-this.BrA*i))-1/n),r=.5*(n+1/n),a=((o=Math.sin(this.BrA*e))*this.cosgam+s*this.singam)/r,Math.abs(Math.abs(a)-1)<fu)h.x=0,h.y=a<0?-du:du;else{if(h.y=this.E/Math.sqrt((1+a)/(1-a)),h.y=Wu(this.e,Math.pow(h.y,1/this.B)),h.y===1/0)throw new Error;h.x=-this.rB*Math.atan2(s*this.cosgam-o*this.singam,Math.cos(this.BrA*e))}return h.x+=this.lam0,h},names:["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Two_Point_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","Oblique_Mercator","omerc"]},ud={init:function(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<fu)){var t=this.b/this.a;this.e=Math.sqrt(1-t*t);var e=Math.sin(this.lat1),i=Math.cos(this.lat1),n=ju(this.e,e,i),s=qu(this.e,this.lat1,e),r=Math.sin(this.lat2),o=Math.cos(this.lat2),a=ju(this.e,r,o),h=qu(this.e,this.lat2,r),l=qu(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>fu?this.ns=Math.log(n/a)/Math.log(s/h):this.ns=e,isNaN(this.ns)&&(this.ns=e),this.f0=n/(this.ns*Math.pow(s,this.ns)),this.rh=this.a*this.f0*Math.pow(l,this.ns),this.title||(this.title="Lambert Conformal Conic")}},forward:function(t){var e=t.x,i=t.y;Math.abs(2*Math.abs(i)-Math.PI)<=fu&&(i=Vu(i)*(du-2*fu));var n,s,r=Math.abs(Math.abs(i)-du);if(r>fu)n=qu(this.e,i,Math.sin(i)),s=this.a*this.f0*Math.pow(n,this.ns);else{if((r=i*this.ns)<=0)return null;s=0}var o=this.ns*Gu(e-this.long0);return t.x=this.k0*(s*Math.sin(o))+this.x0,t.y=this.k0*(this.rh-s*Math.cos(o))+this.y0,t},inverse:function(t){var e,i,n,s,r,o=(t.x-this.x0)/this.k0,a=this.rh-(t.y-this.y0)/this.k0;this.ns>0?(e=Math.sqrt(o*o+a*a),i=1):(e=-Math.sqrt(o*o+a*a),i=-1);var h=0;if(0!==e&&(h=Math.atan2(i*o,i*a)),0!==e||this.ns>0){if(i=1/this.ns,n=Math.pow(e/(this.a*this.f0),i),-9999===(s=Wu(this.e,n)))return null}else s=-du;return r=Gu(h/this.ns+this.long0),t.x=r,t.y=s,t},names:["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_1SP","Lambert_Conformal_Conic_2SP","lcc","Lambert Conic Conformal (1SP)","Lambert Conic Conformal (2SP)"]},cd={init:function(){this.a=6377397.155,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.4334234309119251),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq},forward:function(t){var e,i,n,s,r,o,a,h=t.x,l=t.y,u=Gu(h-this.long0);return e=Math.pow((1+this.e*Math.sin(l))/(1-this.e*Math.sin(l)),this.alfa*this.e/2),i=2*(Math.atan(this.k*Math.pow(Math.tan(l/2+this.s45),this.alfa)/e)-this.s45),n=-u*this.alfa,s=Math.asin(Math.cos(this.ad)*Math.sin(i)+Math.sin(this.ad)*Math.cos(i)*Math.cos(n)),r=Math.asin(Math.cos(i)*Math.sin(n)/Math.cos(s)),o=this.n*r,a=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(s/2+this.s45),this.n),t.y=a*Math.cos(o)/1,t.x=a*Math.sin(o)/1,this.czech||(t.y*=-1,t.x*=-1),t},inverse:function(t){var e,i,n,s,r,o,a,h=t.x;t.x=t.y,t.y=h,this.czech||(t.y*=-1,t.x*=-1),r=Math.sqrt(t.x*t.x+t.y*t.y),s=Math.atan2(t.y,t.x)/Math.sin(this.s0),n=2*(Math.atan(Math.pow(this.ro0/r,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),e=Math.asin(Math.cos(this.ad)*Math.sin(n)-Math.sin(this.ad)*Math.cos(n)*Math.cos(s)),i=Math.asin(Math.cos(n)*Math.sin(s)/Math.cos(e)),t.x=this.long0-i/this.alfa,o=e,a=0;var l=0;do{t.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(e/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(o))/(1-this.e*Math.sin(o)),this.e/2))-this.s45),Math.abs(o-t.y)<1e-10&&(a=1),o=t.y,l+=1}while(0===a&&l<15);return l>=15?null:t},names:["Krovak","krovak"]};function dd(t,e,i,n,s){return t*s-e*Math.sin(2*s)+i*Math.sin(4*s)-n*Math.sin(6*s)}function fd(t){return 1-.25*t*(1+t/16*(3+1.25*t))}function pd(t){return.375*t*(1+.25*t*(1+.46875*t))}function md(t){return.05859375*t*t*(1+.75*t)}function _d(t){return t*t*t*(35/3072)}function yd(t,e,i){var n=e*i;return t/Math.sqrt(1-n*n)}function gd(t){return Math.abs(t)<du?t:t-Vu(t)*Math.PI}function vd(t,e,i,n,s){var r,o;r=t/e;for(var a=0;a<15;a++)if(r+=o=(t-(e*r-i*Math.sin(2*r)+n*Math.sin(4*r)-s*Math.sin(6*r)))/(e-2*i*Math.cos(2*r)+4*n*Math.cos(4*r)-6*s*Math.cos(6*r)),Math.abs(o)<=1e-10)return r;return NaN}const bd={init:function(){this.sphere||(this.e0=fd(this.es),this.e1=pd(this.es),this.e2=md(this.es),this.e3=_d(this.es),this.ml0=this.a*dd(this.e0,this.e1,this.e2,this.e3,this.lat0))},forward:function(t){var e,i,n=t.x,s=t.y;if(n=Gu(n-this.long0),this.sphere)e=this.a*Math.asin(Math.cos(s)*Math.sin(n)),i=this.a*(Math.atan2(Math.tan(s),Math.cos(n))-this.lat0);else{var r=Math.sin(s),o=Math.cos(s),a=yd(this.a,this.e,r),h=Math.tan(s)*Math.tan(s),l=n*Math.cos(s),u=l*l,c=this.es*o*o/(1-this.es);e=a*l*(1-u*h*(1/6-(8-h+8*c)*u/120)),i=this.a*dd(this.e0,this.e1,this.e2,this.e3,s)-this.ml0+a*r/o*u*(.5+(5-h+6*c)*u/24)}return t.x=e+this.x0,t.y=i+this.y0,t},inverse:function(t){t.x-=this.x0,t.y-=this.y0;var e,i,n=t.x/this.a,s=t.y/this.a;if(this.sphere){var r=s+this.lat0;e=Math.asin(Math.sin(r)*Math.cos(n)),i=Math.atan2(Math.tan(n),Math.cos(r))}else{var o=vd(this.ml0/this.a+s,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(o)-du)<=fu)return t.x=this.long0,t.y=du,s<0&&(t.y*=-1),t;var a=yd(this.a,this.e,Math.sin(o)),h=a*a*a/this.a/this.a*(1-this.es),l=Math.pow(Math.tan(o),2),u=n*this.a/a,c=u*u;e=o-a*Math.tan(o)/h*u*u*(.5-(1+3*l)*u*u/24),i=u*(1-c*(l/3+(1+3*l)*l*c/15))/Math.cos(o)}return t.x=Gu(i+this.long0),t.y=gd(e),t},names:["Cassini","Cassini_Soldner","cass"]};function wd(t,e){var i;return t>1e-7?(1-t*t)*(e/(1-(i=t*e)*i)-.5/t*Math.log((1-i)/(1+i))):2*e}const xd={init:function(){var t,e=Math.abs(this.lat0);if(Math.abs(e-du)<fu?this.mode=this.lat0<0?this.S_POLE:this.N_POLE:Math.abs(e)<fu?this.mode=this.EQUIT:this.mode=this.OBLIQ,this.es>0)switch(this.qp=wd(this.e,1),this.mmf=.5/(1-this.es),this.apa=function(t){var e,i=[];return i[0]=.3333333333333333*t,e=t*t,i[0]+=.17222222222222222*e,i[1]=.06388888888888888*e,e*=t,i[0]+=.10257936507936508*e,i[1]+=.0664021164021164*e,i[2]=.016415012942191543*e,i}(this.es),this.mode){case this.N_POLE:case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),t=Math.sin(this.lat0),this.sinb1=wd(this.e,t)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*t*t)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))},forward:function(t){var e,i,n,s,r,o,a,h,l,u,c=t.x,d=t.y;if(c=Gu(c-this.long0),this.sphere){if(r=Math.sin(d),u=Math.cos(d),n=Math.cos(c),this.mode===this.OBLIQ||this.mode===this.EQUIT){if((i=this.mode===this.EQUIT?1+u*n:1+this.sinph0*r+this.cosph0*u*n)<=fu)return null;e=(i=Math.sqrt(2/i))*u*Math.sin(c),i*=this.mode===this.EQUIT?r:this.cosph0*r-this.sinph0*u*n}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(n=-n),Math.abs(d+this.lat0)<fu)return null;i=_u-.5*d,e=(i=2*(this.mode===this.S_POLE?Math.cos(i):Math.sin(i)))*Math.sin(c),i*=n}}else{switch(a=0,h=0,l=0,n=Math.cos(c),s=Math.sin(c),r=Math.sin(d),o=wd(this.e,r),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(a=o/this.qp,h=Math.sqrt(1-a*a)),this.mode){case this.OBLIQ:l=1+this.sinb1*a+this.cosb1*h*n;break;case this.EQUIT:l=1+h*n;break;case this.N_POLE:l=du+d,o=this.qp-o;break;case this.S_POLE:l=d-du,o=this.qp+o}if(Math.abs(l)<fu)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:l=Math.sqrt(2/l),i=this.mode===this.OBLIQ?this.ymf*l*(this.cosb1*a-this.sinb1*h*n):(l=Math.sqrt(2/(1+h*n)))*a*this.ymf,e=this.xmf*l*h*s;break;case this.N_POLE:case this.S_POLE:o>=0?(e=(l=Math.sqrt(o))*s,i=n*(this.mode===this.S_POLE?l:-l)):e=i=0}}return t.x=this.a*e+this.x0,t.y=this.a*i+this.y0,t},inverse:function(t){t.x-=this.x0,t.y-=this.y0;var e,i,n,s,r,o,a,h,l,u,c=t.x/this.a,d=t.y/this.a;if(this.sphere){var f,p=0,m=0;if((i=.5*(f=Math.sqrt(c*c+d*d)))>1)return null;switch(i=2*Math.asin(i),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(m=Math.sin(i),p=Math.cos(i)),this.mode){case this.EQUIT:i=Math.abs(f)<=fu?0:Math.asin(d*m/f),c*=m,d=p*f;break;case this.OBLIQ:i=Math.abs(f)<=fu?this.lat0:Math.asin(p*this.sinph0+d*m*this.cosph0/f),c*=m*this.cosph0,d=(p-Math.sin(i)*this.sinph0)*f;break;case this.N_POLE:d=-d,i=du-i;break;case this.S_POLE:i-=du}e=0!==d||this.mode!==this.EQUIT&&this.mode!==this.OBLIQ?Math.atan2(c,d):0}else{if(a=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(c/=this.dd,d*=this.dd,(o=Math.sqrt(c*c+d*d))<fu)return t.x=this.long0,t.y=this.lat0,t;s=2*Math.asin(.5*o/this.rq),n=Math.cos(s),c*=s=Math.sin(s),this.mode===this.OBLIQ?(a=n*this.sinb1+d*s*this.cosb1/o,r=this.qp*a,d=o*this.cosb1*n-d*this.sinb1*s):(a=d*s/o,r=this.qp*a,d=o*n)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(d=-d),!(r=c*c+d*d))return t.x=this.long0,t.y=this.lat0,t;a=1-r/this.qp,this.mode===this.S_POLE&&(a=-a)}e=Math.atan2(c,d),u=(h=Math.asin(a))+h,i=h+(l=this.apa)[0]*Math.sin(u)+l[1]*Math.sin(u+u)+l[2]*Math.sin(u+u+u)}return t.x=Gu(this.long0+e),t.y=i,t},names:["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"],S_POLE:1,N_POLE:2,EQUIT:3,OBLIQ:4};function Md(t){return Math.abs(t)>1&&(t=t>1?1:-1),Math.asin(t)}const Sd={init:function(){Math.abs(this.lat1+this.lat2)<fu||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=ju(this.e3,this.sin_po,this.cos_po),this.qs1=wd(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=ju(this.e3,this.sin_po,this.cos_po),this.qs2=wd(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=wd(this.e3,this.sin_po),Math.abs(this.lat1-this.lat2)>fu?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)},forward:function(t){var e=t.x,i=t.y;this.sin_phi=Math.sin(i),this.cos_phi=Math.cos(i);var n=wd(this.e3,this.sin_phi),s=this.a*Math.sqrt(this.c-this.ns0*n)/this.ns0,r=this.ns0*Gu(e-this.long0),o=s*Math.sin(r)+this.x0,a=this.rh-s*Math.cos(r)+this.y0;return t.x=o,t.y=a,t},inverse:function(t){var e,i,n,s,r,o;return t.x-=this.x0,t.y=this.rh-t.y+this.y0,this.ns0>=0?(e=Math.sqrt(t.x*t.x+t.y*t.y),n=1):(e=-Math.sqrt(t.x*t.x+t.y*t.y),n=-1),s=0,0!==e&&(s=Math.atan2(n*t.x,n*t.y)),n=e*this.ns0/this.a,this.sphere?o=Math.asin((this.c-n*n)/(2*this.ns0)):(i=(this.c-n*n)/this.ns0,o=this.phi1z(this.e3,i)),r=Gu(s/this.ns0+this.long0),t.x=r,t.y=o,t},names:["Albers_Conic_Equal_Area","Albers","aea"],phi1z:function(t,e){var i,n,s,r,o=Md(.5*e);if(t<fu)return o;for(var a=t*t,h=1;h<=25;h++)if(o+=r=.5*(s=1-(n=t*(i=Math.sin(o)))*n)*s/Math.cos(o)*(e/(1-a)-i/s+.5/t*Math.log((1-n)/(1+n))),Math.abs(r)<=1e-7)return o;return null}},Id={init:function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1},forward:function(t){var e,i,n,s,r,o,a,h=t.x,l=t.y;return n=Gu(h-this.long0),e=Math.sin(l),i=Math.cos(l),s=Math.cos(n),(r=this.sin_p14*e+this.cos_p14*i*s)>0||Math.abs(r)<=fu?(o=this.x0+1*this.a*i*Math.sin(n)/r,a=this.y0+1*this.a*(this.cos_p14*e-this.sin_p14*i*s)/r):(o=this.x0+this.infinity_dist*i*Math.sin(n),a=this.y0+this.infinity_dist*(this.cos_p14*e-this.sin_p14*i*s)),t.x=o,t.y=a,t},inverse:function(t){var e,i,n,s,r,o;return t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,(e=Math.sqrt(t.x*t.x+t.y*t.y))?(s=Math.atan2(e,this.rc),i=Math.sin(s),o=Md((n=Math.cos(s))*this.sin_p14+t.y*i*this.cos_p14/e),r=Math.atan2(t.x*i,e*this.cos_p14*n-t.y*this.sin_p14*i),r=Gu(this.long0+r)):(o=this.phic0,r=0),t.x=r,t.y=o,t},names:["gnom"]},Td={init:function(){this.sphere||(this.k0=ju(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))},forward:function(t){var e,i,n=t.x,s=t.y,r=Gu(n-this.long0);if(this.sphere)e=this.x0+this.a*r*Math.cos(this.lat_ts),i=this.y0+this.a*Math.sin(s)/Math.cos(this.lat_ts);else{var o=wd(this.e,Math.sin(s));e=this.x0+this.a*this.k0*r,i=this.y0+this.a*o*.5/this.k0}return t.x=e,t.y=i,t},inverse:function(t){var e,i;return t.x-=this.x0,t.y-=this.y0,this.sphere?(e=Gu(this.long0+t.x/this.a/Math.cos(this.lat_ts)),i=Math.asin(t.y/this.a*Math.cos(this.lat_ts))):(i=function(t,e){var i=1-(1-t*t)/(2*t)*Math.log((1-t)/(1+t));if(Math.abs(Math.abs(e)-i)<1e-6)return e<0?-1*du:du;for(var n,s,r,o,a=Math.asin(.5*e),h=0;h<30;h++)if(s=Math.sin(a),r=Math.cos(a),o=t*s,a+=n=Math.pow(1-o*o,2)/(2*r)*(e/(1-t*t)-s/(1-o*o)+.5/t*Math.log((1-o)/(1+o))),Math.abs(n)<=1e-10)return a;return NaN}(this.e,2*t.y*this.k0/this.a),e=Gu(this.long0+t.x/(this.a*this.k0))),t.x=e,t.y=i,t},names:["cea"]},Ld={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)},forward:function(t){var e=t.x,i=t.y,n=Gu(e-this.long0),s=gd(i-this.lat0);return t.x=this.x0+this.a*n*this.rc,t.y=this.y0+this.a*s,t},inverse:function(t){var e=t.x,i=t.y;return t.x=Gu(this.long0+(e-this.x0)/(this.a*this.rc)),t.y=gd(this.lat0+(i-this.y0)/this.a),t},names:["Equirectangular","Equidistant_Cylindrical","eqc"]},Ad={init:function(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=fd(this.es),this.e1=pd(this.es),this.e2=md(this.es),this.e3=_d(this.es),this.ml0=this.a*dd(this.e0,this.e1,this.e2,this.e3,this.lat0)},forward:function(t){var e,i,n,s=t.x,r=t.y,o=Gu(s-this.long0);if(n=o*Math.sin(r),this.sphere)Math.abs(r)<=fu?(e=this.a*o,i=-1*this.a*this.lat0):(e=this.a*Math.sin(n)/Math.tan(r),i=this.a*(gd(r-this.lat0)+(1-Math.cos(n))/Math.tan(r)));else if(Math.abs(r)<=fu)e=this.a*o,i=-1*this.ml0;else{var a=yd(this.a,this.e,Math.sin(r))/Math.tan(r);e=a*Math.sin(n),i=this.a*dd(this.e0,this.e1,this.e2,this.e3,r)-this.ml0+a*(1-Math.cos(n))}return t.x=e+this.x0,t.y=i+this.y0,t},inverse:function(t){var e,i,n,s,r,o,a,h,l;if(n=t.x-this.x0,s=t.y-this.y0,this.sphere)if(Math.abs(s+this.a*this.lat0)<=fu)e=Gu(n/this.a+this.long0),i=0;else{var u;for(o=this.lat0+s/this.a,a=n*n/this.a/this.a+o*o,h=o,r=20;r;--r)if(h+=l=-1*(o*(h*(u=Math.tan(h))+1)-h-.5*(h*h+a)*u)/((h-o)/u-1),Math.abs(l)<=fu){i=h;break}e=Gu(this.long0+Math.asin(n*Math.tan(h)/this.a)/Math.sin(i))}else if(Math.abs(s+this.ml0)<=fu)i=0,e=Gu(this.long0+n/this.a);else{var c,d,f,p,m;for(o=(this.ml0+s)/this.a,a=n*n/this.a/this.a+o*o,h=o,r=20;r;--r)if(m=this.e*Math.sin(h),c=Math.sqrt(1-m*m)*Math.tan(h),d=this.a*dd(this.e0,this.e1,this.e2,this.e3,h),f=this.e0-2*this.e1*Math.cos(2*h)+4*this.e2*Math.cos(4*h)-6*this.e3*Math.cos(6*h),h-=l=(o*(c*(p=d/this.a)+1)-p-.5*c*(p*p+a))/(this.es*Math.sin(2*h)*(p*p+a-2*o*p)/(4*c)+(o-p)*(c*f-2/Math.sin(2*h))-f),Math.abs(l)<=fu){i=h;break}c=Math.sqrt(1-this.es*Math.pow(Math.sin(i),2))*Math.tan(i),e=Gu(this.long0+Math.asin(n*c/this.a)/Math.sin(i))}return t.x=e,t.y=i,t},names:["Polyconic","poly"]},Pd={init:function(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013},forward:function(t){var e,i=t.x,n=t.y-this.lat0,s=i-this.long0,r=n/cu*1e-5,o=s,a=1,h=0;for(e=1;e<=10;e++)a*=r,h+=this.A[e]*a;var l,u=h,c=o,d=1,f=0,p=0,m=0;for(e=1;e<=6;e++)l=f*u+d*c,d=d*u-f*c,f=l,p=p+this.B_re[e]*d-this.B_im[e]*f,m=m+this.B_im[e]*d+this.B_re[e]*f;return t.x=m*this.a+this.x0,t.y=p*this.a+this.y0,t},inverse:function(t){var e,i,n=t.x,s=t.y,r=n-this.x0,o=(s-this.y0)/this.a,a=r/this.a,h=1,l=0,u=0,c=0;for(e=1;e<=6;e++)i=l*o+h*a,h=h*o-l*a,l=i,u=u+this.C_re[e]*h-this.C_im[e]*l,c=c+this.C_im[e]*h+this.C_re[e]*l;for(var d=0;d<this.iterations;d++){var f,p=u,m=c,_=o,y=a;for(e=2;e<=6;e++)f=m*u+p*c,p=p*u-m*c,m=f,_+=(e-1)*(this.B_re[e]*p-this.B_im[e]*m),y+=(e-1)*(this.B_im[e]*p+this.B_re[e]*m);p=1,m=0;var g=this.B_re[1],v=this.B_im[1];for(e=2;e<=6;e++)f=m*u+p*c,p=p*u-m*c,m=f,g+=e*(this.B_re[e]*p-this.B_im[e]*m),v+=e*(this.B_im[e]*p+this.B_re[e]*m);var b=g*g+v*v;u=(_*g+y*v)/b,c=(y*g-_*v)/b}var w=u,x=c,M=1,S=0;for(e=1;e<=9;e++)M*=w,S+=this.D[e]*M;var I=this.lat0+S*cu*1e5,T=this.long0+x;return t.x=T,t.y=I,t},names:["New_Zealand_Map_Grid","nzmg"]},Cd={init:function(){},forward:function(t){var e=t.x,i=t.y,n=Gu(e-this.long0),s=this.x0+this.a*n,r=this.y0+this.a*Math.log(Math.tan(Math.PI/4+i/2.5))*1.25;return t.x=s,t.y=r,t},inverse:function(t){t.x-=this.x0,t.y-=this.y0;var e=Gu(this.long0+t.x/this.a),i=2.5*(Math.atan(Math.exp(.8*t.y/this.a))-Math.PI/4);return t.x=e,t.y=i,t},names:["Miller_Cylindrical","mill"]},Bd={init:function(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=Hc(this.es)},forward:function(t){var e,i,n=t.x,s=t.y;if(n=Gu(n-this.long0),this.sphere){if(this.m)for(var r=this.n*Math.sin(s),o=20;o;--o){var a=(this.m*s+Math.sin(s)-r)/(this.m+Math.cos(s));if(s-=a,Math.abs(a)<fu)break}else s=1!==this.n?Math.asin(this.n*Math.sin(s)):s;e=this.a*this.C_x*n*(this.m+Math.cos(s)),i=this.a*this.C_y*s}else{var h=Math.sin(s),l=Math.cos(s);i=this.a*$c(s,h,l,this.en),e=this.a*n*l/Math.sqrt(1-this.es*h*h)}return t.x=e,t.y=i,t},inverse:function(t){var e,i,n;return t.x-=this.x0,i=t.x/this.a,t.y-=this.y0,e=t.y/this.a,this.sphere?(e/=this.C_y,i/=this.C_x*(this.m+Math.cos(e)),this.m?e=Md((this.m*e+Math.sin(e))/this.n):1!==this.n&&(e=Md(Math.sin(e)/this.n)),i=Gu(i+this.long0),e=gd(e)):(e=Yc(t.y/this.a,this.es,this.en),(n=Math.abs(e))<du?(n=Math.sin(e),i=Gu(this.long0+t.x*Math.sqrt(1-this.es*n*n)/(this.a*Math.cos(e)))):n-fu<du&&(i=this.long0)),t.x=i,t.y=e,t},names:["Sinusoidal","sinu"]},Od={init:function(){},forward:function(t){for(var e=t.x,i=t.y,n=Gu(e-this.long0),s=i,r=Math.PI*Math.sin(i);;){var o=-(s+Math.sin(s)-r)/(1+Math.cos(s));if(s+=o,Math.abs(o)<fu)break}s/=2,Math.PI/2-Math.abs(i)<fu&&(n=0);var a=.900316316158*this.a*n*Math.cos(s)+this.x0,h=1.4142135623731*this.a*Math.sin(s)+this.y0;return t.x=a,t.y=h,t},inverse:function(t){var e,i;t.x-=this.x0,t.y-=this.y0,i=t.y/(1.4142135623731*this.a),Math.abs(i)>.999999999999&&(i=.999999999999),e=Math.asin(i);var n=Gu(this.long0+t.x/(.900316316158*this.a*Math.cos(e)));n<-Math.PI&&(n=-Math.PI),n>Math.PI&&(n=Math.PI),i=(2*e+Math.sin(2*e))/Math.PI,Math.abs(i)>1&&(i=1);var s=Math.asin(i);return t.x=n,t.y=s,t},names:["Mollweide","moll"]},Ed={init:function(){Math.abs(this.lat1+this.lat2)<fu||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=fd(this.es),this.e1=pd(this.es),this.e2=md(this.es),this.e3=_d(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=ju(this.e,this.sinphi,this.cosphi),this.ml1=dd(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<fu?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=ju(this.e,this.sinphi,this.cosphi),this.ml2=dd(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=dd(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))},forward:function(t){var e,i=t.x,n=t.y;if(this.sphere)e=this.a*(this.g-n);else{var s=dd(this.e0,this.e1,this.e2,this.e3,n);e=this.a*(this.g-s)}var r=this.ns*Gu(i-this.long0),o=this.x0+e*Math.sin(r),a=this.y0+this.rh-e*Math.cos(r);return t.x=o,t.y=a,t},inverse:function(t){var e,i,n,s;t.x-=this.x0,t.y=this.rh-t.y+this.y0,this.ns>=0?(i=Math.sqrt(t.x*t.x+t.y*t.y),e=1):(i=-Math.sqrt(t.x*t.x+t.y*t.y),e=-1);var r=0;return 0!==i&&(r=Math.atan2(e*t.x,e*t.y)),this.sphere?(s=Gu(this.long0+r/this.ns),n=gd(this.g-i/this.a),t.x=s,t.y=n,t):(n=vd(this.g-i/this.a,this.e0,this.e1,this.e2,this.e3),s=Gu(this.long0+r/this.ns),t.x=s,t.y=n,t)},names:["Equidistant_Conic","eqdc"]},Nd={init:function(){this.R=this.a},forward:function(t){var e,i,n=t.x,s=t.y,r=Gu(n-this.long0);Math.abs(s)<=fu&&(e=this.x0+this.R*r,i=this.y0);var o=Md(2*Math.abs(s/Math.PI));(Math.abs(r)<=fu||Math.abs(Math.abs(s)-du)<=fu)&&(e=this.x0,i=s>=0?this.y0+Math.PI*this.R*Math.tan(.5*o):this.y0+Math.PI*this.R*-Math.tan(.5*o));var a=.5*Math.abs(Math.PI/r-r/Math.PI),h=a*a,l=Math.sin(o),u=Math.cos(o),c=u/(l+u-1),d=c*c,f=c*(2/l-1),p=f*f,m=Math.PI*this.R*(a*(c-p)+Math.sqrt(h*(c-p)*(c-p)-(p+h)*(d-p)))/(p+h);r<0&&(m=-m),e=this.x0+m;var _=h+c;return m=Math.PI*this.R*(f*_-a*Math.sqrt((p+h)*(h+1)-_*_))/(p+h),i=s>=0?this.y0+m:this.y0-m,t.x=e,t.y=i,t},inverse:function(t){var e,i,n,s,r,o,a,h,l,u,c,d;return t.x-=this.x0,t.y-=this.y0,c=Math.PI*this.R,r=(n=t.x/c)*n+(s=t.y/c)*s,c=3*(s*s/(h=-2*(o=-Math.abs(s)*(1+r))+1+2*s*s+r*r)+(2*(a=o-2*s*s+n*n)*a*a/h/h/h-9*o*a/h/h)/27)/(l=(o-a*a/3/h)/h)/(u=2*Math.sqrt(-l/3)),Math.abs(c)>1&&(c=c>=0?1:-1),d=Math.acos(c)/3,i=t.y>=0?(-u*Math.cos(d+Math.PI/3)-a/3/h)*Math.PI:-(-u*Math.cos(d+Math.PI/3)-a/3/h)*Math.PI,e=Math.abs(n)<fu?this.long0:Gu(this.long0+Math.PI*(r-1+Math.sqrt(1+2*(n*n-s*s)+r*r))/2/n),t.x=e,t.y=i,t},names:["Van_der_Grinten_I","VanDerGrinten","vandg"]},zd={init:function(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0)},forward:function(t){var e,i,n,s,r,o,a,h,l,u,c,d,f,p,m,_,y,g,v,b,w,x,M=t.x,S=t.y,I=Math.sin(t.y),T=Math.cos(t.y),L=Gu(M-this.long0);return this.sphere?Math.abs(this.sin_p12-1)<=fu?(t.x=this.x0+this.a*(du-S)*Math.sin(L),t.y=this.y0-this.a*(du-S)*Math.cos(L),t):Math.abs(this.sin_p12+1)<=fu?(t.x=this.x0+this.a*(du+S)*Math.sin(L),t.y=this.y0+this.a*(du+S)*Math.cos(L),t):(g=this.sin_p12*I+this.cos_p12*T*Math.cos(L),y=(_=Math.acos(g))?_/Math.sin(_):1,t.x=this.x0+this.a*y*T*Math.sin(L),t.y=this.y0+this.a*y*(this.cos_p12*I-this.sin_p12*T*Math.cos(L)),t):(e=fd(this.es),i=pd(this.es),n=md(this.es),s=_d(this.es),Math.abs(this.sin_p12-1)<=fu?(r=this.a*dd(e,i,n,s,du),o=this.a*dd(e,i,n,s,S),t.x=this.x0+(r-o)*Math.sin(L),t.y=this.y0-(r-o)*Math.cos(L),t):Math.abs(this.sin_p12+1)<=fu?(r=this.a*dd(e,i,n,s,du),o=this.a*dd(e,i,n,s,S),t.x=this.x0+(r+o)*Math.sin(L),t.y=this.y0+(r+o)*Math.cos(L),t):(a=I/T,h=yd(this.a,this.e,this.sin_p12),l=yd(this.a,this.e,I),u=Math.atan((1-this.es)*a+this.es*h*this.sin_p12/(l*T)),v=0===(c=Math.atan2(Math.sin(L),this.cos_p12*Math.tan(u)-this.sin_p12*Math.cos(L)))?Math.asin(this.cos_p12*Math.sin(u)-this.sin_p12*Math.cos(u)):Math.abs(Math.abs(c)-Math.PI)<=fu?-Math.asin(this.cos_p12*Math.sin(u)-this.sin_p12*Math.cos(u)):Math.asin(Math.sin(L)*Math.cos(u)/Math.sin(c)),d=this.e*this.sin_p12/Math.sqrt(1-this.es),_=h*v*(1-(b=v*v)*(m=(f=this.e*this.cos_p12*Math.cos(c)/Math.sqrt(1-this.es))*f)*(1-m)/6+(w=b*v)/8*(p=d*f)*(1-2*m)+(x=w*v)/120*(m*(4-7*m)-3*d*d*(1-7*m))-x*v/48*p),t.x=this.x0+_*Math.sin(c),t.y=this.y0+_*Math.cos(c),t))},inverse:function(t){var e,i,n,s,r,o,a,h,l,u,c,d,f,p,m,_,y,g,v,b,w,x,M;if(t.x-=this.x0,t.y-=this.y0,this.sphere){if((e=Math.sqrt(t.x*t.x+t.y*t.y))>2*du*this.a)return;return i=e/this.a,n=Math.sin(i),s=Math.cos(i),r=this.long0,Math.abs(e)<=fu?o=this.lat0:(o=Md(s*this.sin_p12+t.y*n*this.cos_p12/e),a=Math.abs(this.lat0)-du,r=Math.abs(a)<=fu?this.lat0>=0?Gu(this.long0+Math.atan2(t.x,-t.y)):Gu(this.long0-Math.atan2(-t.x,t.y)):Gu(this.long0+Math.atan2(t.x*n,e*this.cos_p12*s-t.y*this.sin_p12*n))),t.x=r,t.y=o,t}return h=fd(this.es),l=pd(this.es),u=md(this.es),c=_d(this.es),Math.abs(this.sin_p12-1)<=fu?(o=vd(((d=this.a*dd(h,l,u,c,du))-(e=Math.sqrt(t.x*t.x+t.y*t.y)))/this.a,h,l,u,c),r=Gu(this.long0+Math.atan2(t.x,-1*t.y)),t.x=r,t.y=o,t):Math.abs(this.sin_p12+1)<=fu?(d=this.a*dd(h,l,u,c,du),o=vd(((e=Math.sqrt(t.x*t.x+t.y*t.y))-d)/this.a,h,l,u,c),r=Gu(this.long0+Math.atan2(t.x,t.y)),t.x=r,t.y=o,t):(e=Math.sqrt(t.x*t.x+t.y*t.y),m=Math.atan2(t.x,t.y),f=yd(this.a,this.e,this.sin_p12),_=Math.cos(m),g=-(y=this.e*this.cos_p12*_)*y/(1-this.es),v=3*this.es*(1-g)*this.sin_p12*this.cos_p12*_/(1-this.es),x=1-g*(w=(b=e/f)-g*(1+g)*Math.pow(b,3)/6-v*(1+3*g)*Math.pow(b,4)/24)*w/2-b*w*w*w/6,p=Math.asin(this.sin_p12*Math.cos(w)+this.cos_p12*Math.sin(w)*_),r=Gu(this.long0+Math.asin(Math.sin(m)*Math.sin(w)/Math.cos(p))),M=Math.sin(p),o=Math.atan2((M-this.es*x*this.sin_p12)*Math.tan(p),M*(1-this.es)),t.x=r,t.y=o,t)},names:["Azimuthal_Equidistant","aeqd"]},kd={init:function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)},forward:function(t){var e,i,n,s,r,o,a,h=t.x,l=t.y;return n=Gu(h-this.long0),e=Math.sin(l),i=Math.cos(l),s=Math.cos(n),((r=this.sin_p14*e+this.cos_p14*i*s)>0||Math.abs(r)<=fu)&&(o=1*this.a*i*Math.sin(n),a=this.y0+1*this.a*(this.cos_p14*e-this.sin_p14*i*s)),t.x=o,t.y=a,t},inverse:function(t){var e,i,n,s,r,o,a;return t.x-=this.x0,t.y-=this.y0,i=Md((e=Math.sqrt(t.x*t.x+t.y*t.y))/this.a),n=Math.sin(i),s=Math.cos(i),o=this.long0,Math.abs(e)<=fu?(a=this.lat0,t.x=o,t.y=a,t):(a=Md(s*this.sin_p14+t.y*n*this.cos_p14/e),r=Math.abs(this.lat0)-du,Math.abs(r)<=fu?(o=this.lat0>=0?Gu(this.long0+Math.atan2(t.x,-t.y)):Gu(this.long0-Math.atan2(-t.x,t.y)),t.x=o,t.y=a,t):(o=Gu(this.long0+Math.atan2(t.x*n,e*this.cos_p14*s-t.y*this.sin_p14*n)),t.x=o,t.y=a,t))},names:["ortho"]};var Dd={AREA_0:1,AREA_1:2,AREA_2:3,AREA_3:4};function Fd(t,e,i,n){var s;return t<fu?(n.value=Dd.AREA_0,s=0):(s=Math.atan2(e,i),Math.abs(s)<=_u?n.value=Dd.AREA_0:s>_u&&s<=du+_u?(n.value=Dd.AREA_1,s-=du):s>du+_u||s<=-(du+_u)?(n.value=Dd.AREA_2,s=s>=0?s-gu:s+gu):(n.value=Dd.AREA_3,s+=du)),s}function Rd(t,e){var i=t+e;return i<-gu?i+=yu:i>+gu&&(i-=yu),i}const Ud={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=du-_u/2?this.face=5:this.lat0<=-(du-_u/2)?this.face=6:Math.abs(this.long0)<=_u?this.face=1:Math.abs(this.long0)<=du+_u?this.face=this.long0>0?2:4:this.face=3,0!==this.es&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)},forward:function(t){var e,i,n,s,r,o,a={x:0,y:0},h={value:0};if(t.x-=this.long0,e=0!==this.es?Math.atan(this.one_minus_f_squared*Math.tan(t.y)):t.y,i=t.x,5===this.face)s=du-e,i>=_u&&i<=du+_u?(h.value=Dd.AREA_0,n=i-du):i>du+_u||i<=-(du+_u)?(h.value=Dd.AREA_1,n=i>0?i-gu:i+gu):i>-(du+_u)&&i<=-_u?(h.value=Dd.AREA_2,n=i+du):(h.value=Dd.AREA_3,n=i);else if(6===this.face)s=du+e,i>=_u&&i<=du+_u?(h.value=Dd.AREA_0,n=-i+du):i<_u&&i>=-_u?(h.value=Dd.AREA_1,n=-i):i<-_u&&i>=-(du+_u)?(h.value=Dd.AREA_2,n=-i-du):(h.value=Dd.AREA_3,n=i>0?-i+gu:-i-gu);else{var l,u,c,d,f,p;2===this.face?i=Rd(i,+du):3===this.face?i=Rd(i,+gu):4===this.face&&(i=Rd(i,-du)),d=Math.sin(e),f=Math.cos(e),p=Math.sin(i),l=f*Math.cos(i),u=f*p,c=d,1===this.face?n=Fd(s=Math.acos(l),c,u,h):2===this.face?n=Fd(s=Math.acos(u),c,-l,h):3===this.face?n=Fd(s=Math.acos(-l),c,-u,h):4===this.face?n=Fd(s=Math.acos(-u),c,l,h):(s=n=0,h.value=Dd.AREA_0)}return o=Math.atan(12/gu*(n+Math.acos(Math.sin(n)*Math.cos(_u))-du)),r=Math.sqrt((1-Math.cos(s))/(Math.cos(o)*Math.cos(o))/(1-Math.cos(Math.atan(1/Math.cos(n))))),h.value===Dd.AREA_1?o+=du:h.value===Dd.AREA_2?o+=gu:h.value===Dd.AREA_3&&(o+=1.5*gu),a.x=r*Math.cos(o),a.y=r*Math.sin(o),a.x=a.x*this.a+this.x0,a.y=a.y*this.a+this.y0,t.x=a.x,t.y=a.y,t},inverse:function(t){var e,i,n,s,r,o,a,h,l,u,c,d,f={lam:0,phi:0},p={value:0};if(t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,i=Math.atan(Math.sqrt(t.x*t.x+t.y*t.y)),e=Math.atan2(t.y,t.x),t.x>=0&&t.x>=Math.abs(t.y)?p.value=Dd.AREA_0:t.y>=0&&t.y>=Math.abs(t.x)?(p.value=Dd.AREA_1,e-=du):t.x<0&&-t.x>=Math.abs(t.y)?(p.value=Dd.AREA_2,e=e<0?e+gu:e-gu):(p.value=Dd.AREA_3,e+=du),l=gu/12*Math.tan(e),r=Math.sin(l)/(Math.cos(l)-1/Math.sqrt(2)),o=Math.atan(r),(a=1-(n=Math.cos(e))*n*(s=Math.tan(i))*s*(1-Math.cos(Math.atan(1/Math.cos(o)))))<-1?a=-1:a>1&&(a=1),5===this.face)h=Math.acos(a),f.phi=du-h,p.value===Dd.AREA_0?f.lam=o+du:p.value===Dd.AREA_1?f.lam=o<0?o+gu:o-gu:p.value===Dd.AREA_2?f.lam=o-du:f.lam=o;else if(6===this.face)h=Math.acos(a),f.phi=h-du,p.value===Dd.AREA_0?f.lam=-o+du:p.value===Dd.AREA_1?f.lam=-o:p.value===Dd.AREA_2?f.lam=-o-du:f.lam=o<0?-o-gu:-o+gu;else{var m,_,y;l=(m=a)*m,_=(l+=(y=l>=1?0:Math.sqrt(1-l)*Math.sin(o))*y)>=1?0:Math.sqrt(1-l),p.value===Dd.AREA_1?(l=_,_=-y,y=l):p.value===Dd.AREA_2?(_=-_,y=-y):p.value===Dd.AREA_3&&(l=_,_=y,y=-l),2===this.face?(l=m,m=-_,_=l):3===this.face?(m=-m,_=-_):4===this.face&&(l=m,m=_,_=-l),f.phi=Math.acos(-y)-du,f.lam=Math.atan2(_,m),2===this.face?f.lam=Rd(f.lam,-du):3===this.face?f.lam=Rd(f.lam,-gu):4===this.face&&(f.lam=Rd(f.lam,+du))}return 0!==this.es&&(u=f.phi<0?1:0,c=Math.tan(f.phi),d=this.b/Math.sqrt(c*c+this.one_minus_f_squared),f.phi=Math.atan(Math.sqrt(this.a*this.a-d*d)/(this.one_minus_f*d)),u&&(f.phi=-f.phi)),f.lam+=this.long0,t.x=f.lam,t.y=f.phi,t},names:["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"]};var Zd=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-9.86701e-7],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,1.8736e-8],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,9.34959e-7],[.7986,-.00755338,-500009e-10,9.35324e-7],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],jd=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-1.26793e-9,4.22642e-10],[.124,.0124,5.07171e-9,-1.60604e-9],[.186,.0123999,-1.90189e-8,6.00152e-9],[.248,.0124002,7.10039e-8,-2.24e-8],[.31,.0123992,-2.64997e-7,8.35986e-8],[.372,.0124029,9.88983e-7,-3.11994e-7],[.434,.0123893,-369093e-11,-4.35621e-7],[.4958,.0123198,-102252e-10,-3.45523e-7],[.5571,.0121916,-154081e-10,-5.82288e-7],[.6176,.0119938,-241424e-10,-5.25327e-7],[.6769,.011713,-320223e-10,-5.16405e-7],[.7346,.0113541,-397684e-10,-6.09052e-7],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-1.40374e-9],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],Vd=.8487,Gd=1.3523,qd=mu/5,Wd=1/qd,Hd=function(t,e){return t[0]+e*(t[1]+e*(t[2]+e*t[3]))};const $d={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"},forward:function(t){var e=Gu(t.x-this.long0),i=Math.abs(t.y),n=Math.floor(i*qd);n<0?n=0:n>=18&&(n=17);var s={x:Hd(Zd[n],i=mu*(i-Wd*n))*e,y:Hd(jd[n],i)};return t.y<0&&(s.y=-s.y),s.x=s.x*this.a*Vd+this.x0,s.y=s.y*this.a*Gd+this.y0,s},inverse:function(t){var e={x:(t.x-this.x0)/(this.a*Vd),y:Math.abs(t.y-this.y0)/(this.a*Gd)};if(e.y>=1)e.x/=Zd[18][0],e.y=t.y<0?-du:du;else{var i=Math.floor(18*e.y);for(i<0?i=0:i>=18&&(i=17);;)if(jd[i][0]>e.y)--i;else{if(!(jd[i+1][0]<=e.y))break;++i}var n=jd[i],s=5*(e.y-n[0])/(jd[i+1][0]-n[0]);s=function(t,e,i,n){for(var s=e;n;--n){var r=t(s);if(s-=r,Math.abs(r)<i)break}return s}((function(t){return(Hd(n,t)-e.y)/function(t,e){return t[1]+e*(2*t[2]+3*e*t[3])}(n,t)}),s,fu,100),e.x/=Hd(Zd[i],s),e.y=(5*i+s)*pu,t.y<0&&(e.y=-e.y)}return e.x=Gu(e.x+this.long0),e},names:["Robinson","robin"]},Yd={init:function(){this.name="geocent"},forward:function(t){return cc(t,this.es,this.a)},inverse:function(t){return dc(t,this.es,this.a,this.b)},names:["Geocentric","geocentric","geocent","Geocent"]};var Xd={h:{def:1e5,num:!0},azi:{def:0,num:!0,degrees:!0},tilt:{def:0,num:!0,degrees:!0},long0:{def:0,num:!0},lat0:{def:0,num:!0}};const Kd={init:function(){if(Object.keys(Xd).forEach(function(t){if(void 0===this[t])this[t]=Xd[t].def;else{if(Xd[t].num&&isNaN(this[t]))throw new Error("Invalid parameter value, must be numeric "+t+" = "+this[t]);Xd[t].num&&(this[t]=parseFloat(this[t]))}Xd[t].degrees&&(this[t]=this[t]*pu)}.bind(this)),Math.abs(Math.abs(this.lat0)-du)<fu?this.mode=this.lat0<0?1:0:Math.abs(this.lat0)<fu?this.mode=2:(this.mode=3,this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0)),this.pn1=this.h/this.a,this.pn1<=0||this.pn1>1e10)throw new Error("Invalid height");this.p=1+this.pn1,this.rp=1/this.p,this.h1=1/this.pn1,this.pfact=(this.p+1)*this.h1,this.es=0;var t=this.tilt,e=this.azi;this.cg=Math.cos(e),this.sg=Math.sin(e),this.cw=Math.cos(t),this.sw=Math.sin(t)},forward:function(t){t.x-=this.long0;var e,i,n,s,r=Math.sin(t.y),o=Math.cos(t.y),a=Math.cos(t.x);switch(this.mode){case 3:i=this.sinph0*r+this.cosph0*o*a;break;case 2:i=o*a;break;case 1:i=-r;break;case 0:i=r}switch(e=(i=this.pn1/(this.p-i))*o*Math.sin(t.x),this.mode){case 3:i*=this.cosph0*r-this.sinph0*o*a;break;case 2:i*=r;break;case 0:i*=-o*a;break;case 1:i*=o*a}return s=1/((n=i*this.cg+e*this.sg)*this.sw*this.h1+this.cw),e=(e*this.cg-i*this.sg)*this.cw*s,i=n*s,t.x=e*this.a,t.y=i*this.a,t},inverse:function(t){t.x/=this.a,t.y/=this.a;var e,i,n,s={x:t.x,y:t.y};n=1/(this.pn1-t.y*this.sw),e=this.pn1*t.x*n,i=this.pn1*t.y*this.cw*n,t.x=e*this.cg+i*this.sg,t.y=i*this.cg-e*this.sg;var r=Jc(t.x,t.y);if(Math.abs(r)<fu)s.x=0,s.y=t.y;else{var o,a;switch(a=1-r*r*this.pfact,a=(this.p-Math.sqrt(a))/(this.pn1/r+r/this.pn1),o=Math.sqrt(1-a*a),this.mode){case 3:s.y=Math.asin(o*this.sinph0+t.y*a*this.cosph0/r),t.y=(o-this.sinph0*Math.sin(s.y))*r,t.x*=a*this.cosph0;break;case 2:s.y=Math.asin(t.y*a/r),t.y=o*r,t.x*=a;break;case 0:s.y=Math.asin(o),t.y=-t.y;break;case 1:s.y=-Math.asin(o)}s.x=Math.atan2(t.x,t.y)}return t.x=s.x+this.long0,t.y=s.y,t},names:["Tilted_Perspective","tpers"]},Jd={init:function(){if(this.flip_axis="x"===this.sweep?1:0,this.h=Number(this.h),this.radius_g_1=this.h/this.a,this.radius_g_1<=0||this.radius_g_1>1e10)throw new Error;if(this.radius_g=1+this.radius_g_1,this.C=this.radius_g*this.radius_g-1,0!==this.es){var t=1-this.es,e=1/t;this.radius_p=Math.sqrt(t),this.radius_p2=t,this.radius_p_inv2=e,this.shape="ellipse"}else this.radius_p=1,this.radius_p2=1,this.radius_p_inv2=1,this.shape="sphere";this.title||(this.title="Geostationary Satellite View")},forward:function(t){var e,i,n,s,r=t.x,o=t.y;if(r-=this.long0,"ellipse"===this.shape){o=Math.atan(this.radius_p2*Math.tan(o));var a=this.radius_p/Jc(this.radius_p*Math.cos(o),Math.sin(o));if(i=a*Math.cos(r)*Math.cos(o),n=a*Math.sin(r)*Math.cos(o),s=a*Math.sin(o),(this.radius_g-i)*i-n*n-s*s*this.radius_p_inv2<0)return t.x=Number.NaN,t.y=Number.NaN,t;e=this.radius_g-i,this.flip_axis?(t.x=this.radius_g_1*Math.atan(n/Jc(s,e)),t.y=this.radius_g_1*Math.atan(s/e)):(t.x=this.radius_g_1*Math.atan(n/e),t.y=this.radius_g_1*Math.atan(s/Jc(n,e)))}else"sphere"===this.shape&&(e=Math.cos(o),i=Math.cos(r)*e,n=Math.sin(r)*e,s=Math.sin(o),e=this.radius_g-i,this.flip_axis?(t.x=this.radius_g_1*Math.atan(n/Jc(s,e)),t.y=this.radius_g_1*Math.atan(s/e)):(t.x=this.radius_g_1*Math.atan(n/e),t.y=this.radius_g_1*Math.atan(s/Jc(n,e))));return t.x=t.x*this.a,t.y=t.y*this.a,t},inverse:function(t){var e,i,n,s,r=-1,o=0,a=0;if(t.x=t.x/this.a,t.y=t.y/this.a,"ellipse"===this.shape){this.flip_axis?(a=Math.tan(t.y/this.radius_g_1),o=Math.tan(t.x/this.radius_g_1)*Jc(1,a)):(o=Math.tan(t.x/this.radius_g_1),a=Math.tan(t.y/this.radius_g_1)*Jc(1,o));var h=a/this.radius_p;if(e=o*o+h*h+r*r,(n=(i=2*this.radius_g*r)*i-4*e*this.C)<0)return t.x=Number.NaN,t.y=Number.NaN,t;s=(-i-Math.sqrt(n))/(2*e),r=this.radius_g+s*r,o*=s,a*=s,t.x=Math.atan2(o,r),t.y=Math.atan(a*Math.cos(t.x)/r),t.y=Math.atan(this.radius_p_inv2*Math.tan(t.y))}else if("sphere"===this.shape){if(this.flip_axis?(a=Math.tan(t.y/this.radius_g_1),o=Math.tan(t.x/this.radius_g_1)*Math.sqrt(1+a*a)):(o=Math.tan(t.x/this.radius_g_1),a=Math.tan(t.y/this.radius_g_1)*Math.sqrt(1+o*o)),e=o*o+a*a+r*r,(n=(i=2*this.radius_g*r)*i-4*e*this.C)<0)return t.x=Number.NaN,t.y=Number.NaN,t;s=(-i-Math.sqrt(n))/(2*e),r=this.radius_g+s*r,o*=s,a*=s,t.x=Math.atan2(o,r),t.y=Math.atan(a*Math.cos(t.x)/r)}return t.x=t.x+this.long0,t},names:["Geostationary Satellite View","Geostationary_Satellite","geos"]};var Qd;Sc.defaultDatum="WGS84",Sc.Proj=uc,Sc.WGS84=new Sc.Proj("WGS84"),Sc.Point=Vc,Sc.toPoint=gc,Sc.defs=Fu,Sc.nadgrid=function(t,e){var i=new DataView(e),n=function(t){var e=t.getInt32(8,!1);return 11!==e&&(11!==(e=t.getInt32(8,!0))&&console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian"),!0)}(i),s=function(t,e){return{nFields:t.getInt32(8,e),nSubgridFields:t.getInt32(24,e),nSubgrids:t.getInt32(40,e),shiftType:rc(t,56,64).trim(),fromSemiMajorAxis:t.getFloat64(120,e),fromSemiMinorAxis:t.getFloat64(136,e),toSemiMajorAxis:t.getFloat64(152,e),toSemiMinorAxis:t.getFloat64(168,e)}}(i,n);s.nSubgrids>1&&console.log("Only single NTv2 subgrids are currently supported, subsequent sub grids are ignored");var r=function(t,e,i){for(var n=[],s=0;s<e.nSubgrids;s++){var r=ac(t,176,i),o=hc(t,176,r,i),a=Math.round(1+(r.upperLongitude-r.lowerLongitude)/r.longitudeInterval),h=Math.round(1+(r.upperLatitude-r.lowerLatitude)/r.latitudeInterval);n.push({ll:[sc(r.lowerLongitude),sc(r.lowerLatitude)],del:[sc(r.longitudeInterval),sc(r.latitudeInterval)],lim:[a,h],count:r.gridNodeCount,cvs:oc(o)})}return n}(i,s,n),o={header:s,subgrids:r};return ic[t]=o,o},Sc.transform=bc,Sc.mgrs=Ec,Sc.version="__VERSION__",(Qd=Sc).Proj.projections.add(Xc),Qd.Proj.projections.add(ed),Qd.Proj.projections.add(id),Qd.Proj.projections.add(rd),Qd.Proj.projections.add(od),Qd.Proj.projections.add(ad),Qd.Proj.projections.add(ld),Qd.Proj.projections.add(ud),Qd.Proj.projections.add(cd),Qd.Proj.projections.add(bd),Qd.Proj.projections.add(xd),Qd.Proj.projections.add(Sd),Qd.Proj.projections.add(Id),Qd.Proj.projections.add(Td),Qd.Proj.projections.add(Ld),Qd.Proj.projections.add(Ad),Qd.Proj.projections.add(Pd),Qd.Proj.projections.add(Cd),Qd.Proj.projections.add(Bd),Qd.Proj.projections.add(Od),Qd.Proj.projections.add(Ed),Qd.Proj.projections.add(Nd),Qd.Proj.projections.add(zd),Qd.Proj.projections.add(kd),Qd.Proj.projections.add(Ud),Qd.Proj.projections.add($d),Qd.Proj.projections.add(Yd),Qd.Proj.projections.add(Kd),Qd.Proj.projections.add(Jd);const tf=Sc;tf.defs("EPSG:3035","+proj=laea +lat_0=52 +lon_0=10 +x_0=4321000 +y_0=3210000 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs +type=crs"),L.GridvizLayer=function(t){t=t||{},this.proj=t.proj||"EPSG:3035",this.app=null,this.onLayerDidMountCallback=t.onLayerDidMountCallback||null,this.onLayerDidMount=function(){this.buildGridVizApp(),this.onLayerDidMountCallback&&this.onLayerDidMountCallback();let t=this._map._container;new ResizeObserver((e=>{t.clientWidth>0&&t.clientHeight>0&&window.requestAnimationFrame((()=>{Array.isArray(e)&&e.length&&(this.app.h===t.clientHeight&&this.app.w===t.clientWidth||(this.app.h=t.clientHeight,this.app.w=t.clientWidth,this.app.cg.h=t.clientHeight,this.app.cg.w=t.clientWidth,this._canvas.setAttribute("width",""+this.app.w),this._canvas.setAttribute("height",""+this.app.h),this.app.redraw()))}))})).observe(t)},this.onLayerWillUnmount=function(){},this.setData=function(t){this.needRedraw()},this.onDrawLayer=function(t){let e=this.leafletToGeoCenter(this._map.getCenter()),i=this.leafletZoomToGridvizZoom();this.app.setGeoCenter({x:e[0],y:e[1]}),this.app.setZoomFactor(i),this.app.redraw()},this.geoCenterToLeaflet=function(t,e){let i=tf(this.proj,"WGS84",[t,e]);return[i[1],i[0]]},this.leafletToGeoCenter=function(t){return tf(this.proj,[t.lng,t.lat])},this.leafletZoomToGridvizZoom=function(){return this.getMetresPerPixel()},this.getMetresPerPixel=function(){let t=this._map.getCenter(),e=this._map.latLngToContainerPoint(t),i=[e.x+1,e.y],n=this._map.containerPointToLatLng(e),s=this._map.containerPointToLatLng(i),r=this.leafletToGeoCenter(n);return this.leafletToGeoCenter(s)[0]-r[0]},this.buildGridVizApp=function(){let e=this.leafletToGeoCenter(this._map.getCenter());t.container=t.container||this._canvas.parentElement,this.app=new Gl(t.container,{canvas:this._canvas,w:window.innerWidth,h:window.innerHeight,disableZoom:!0,transparentBackground:!0,selectionRectangleColor:t.selectionRectangleColor||"red",selectionRectangleWidthPix:t.selectionRectangleWidthPix||"4",legendDivId:t.legendDivId||"gvizLegend"}).setGeoCenter({x:e[0],y:e[1]})}},L.GridvizLayer.prototype=new nu.CanvasLayer})()})();